(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(t,e,n){"use strict";n.r(e);e.default={NO_ERROR:"NO_ERROR",ACTIVATION_SUCCEED:"ACTIVATION_SUCCEED",EMAIL_SEND_ERROR:"EMAIL_SEND_ERROR",INVALID_ACTIVATION_CODE:"INVALID_ACTIVATION_CODE",INVALID_EMAIL:"INVALID_EMAIL",INVALID_NAME:"INVALID_NAME",INVALID_PASSWORD:"INVALID_PASSWORD",INVALID_USER_DATA:"INVALID_USER_DATA",LOGIN_SUCCEED:"LOGIN_SUCCEED",NO_ACTIVATED:"NO_ACTIVATED",PASSWORDS_NOT_MATCH:"PASSWORDS_NOT_MATCH",REG_SUCCEED:"REG_SUCCEED",SERVER_ERROR:"SERVER_ERROR",USER_NAME_ALLOWED:"USER_NAME_ALLOWED",USER_NAME_EXIST:"USER_NAME_EXIST",USER_EMAIL_ALLOWED:"USER_EMAIL_ALLOWED",USER_EMAIL_EXIST:"USER_EMAIL_EXIST",USER_EMAIL_NOT_EXIST:"USER_EMAIL_NOT_EXIST"}},74:function(t,e,n){t.exports=n(98)},92:function(t,e,n){},93:function(t,e,n){},94:function(t,e,n){},95:function(t,e,n){},96:function(t,e,n){},97:function(t,e,n){},98:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),r=n(54),o=n(65),s=n(15),c=n(7),l=n(47),u=n(58),h=n(1),d=n(11),f=n(5),p=n(6),v=n(9),y=n(3),m=n(2),b=n(8);function g(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var w=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(f.a)(this,t),this.x=e,this.y=n},S=function t(e,n){Object(f.a)(this,t),2===arguments.length&&(this.p1=e,this.p2=n),4===arguments.length&&(this.p1={x:arguments[0],y:arguments[1]},this.p2={x:arguments[2],y:arguments[3]})},P=function t(){var e=this;Object(f.a)(this,t);var n=arguments,a=function(t,n){e.a=t.y-n.y,e.b=n.x-t.x,e.c=t.x*n.y-t.y*n.x};switch(n.length){case 0:a(new w,new w);break;case 1:a(n[0].p1,n[0].p2);break;case 2:a(n[0],n[1]);break;case 3:this.a=n[0],this.b=n[1],this.c=n[2]}this.getYbyX=function(t){return 0!==this.b?-(this.a*t+this.c)/this.b:NaN},this.getXbyY=function(t){return 0!==this.a?-(this.b*t+this.c)/this.a:NaN}},O=function t(e,n,a){Object(f.a)(this,t),this.first=e,this.second=n,this.third=a,this.chord=Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y))},x=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new w,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;Object(f.a)(this,t),this.topLeft={},this.bottomRight={},this.topLeft.x=e.x>n.x?n.x:e.x,this.topLeft.y=e.y<n.y?n.y:e.y,this.width=Math.abs(n.x-e.x),this.height=Math.abs(n.y-e.y),this.bottomRight.x=this.topLeft.x+this.width,this.bottomRight.y=this.topLeft.y-this.height},D=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new w,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new w;Object(f.a)(this,t),this.x=n.x-e.x,this.y=n.y-e.y,this.modulus=Math.sqrt(this.x*this.x+this.y*this.y)},T=function(){function t(){Object(f.a)(this,t)}return Object(p.a)(t,null,[{key:"SLineSLine",value:function(t,e){var n=t.a*e.b-t.b*e.a;if(0===n)return null;var a=-t.c*e.b- -e.c*t.b,i=-e.c*t.a- -t.c*e.a;return new w(a/n,i/n)}},{key:"LineSLine",value:function(e,n){var a=t.SLineSLine(n,new P(e));return null===a?null:k.pointOnLine(a,e.p1,e.p2)?a:null}},{key:"RectangleSLine",value:function(e,n,a){var i=new Array(4),r=[];return i[0]=new S(e.x,e.y,n.x,e.y),i[1]=new S(e.x,n.y,n.x,n.y),i[2]=new S(e.x,e.y,e.x,n.y),i[3]=new S(n.x,e.y,n.x,n.y),i.forEach(function(e){var n=t.LineSLine(e,a);n&&r.length<2&&r.push(n)}),r}},{key:"RectangleRLine",value:function(e,n,a){var i=t.RectangleSLine(e,n,k.SLineFromRLine(a)),r=[];return i.forEach(function(t){k.isPointOnRayLine(a,t)&&r.push(t)}),r}},{key:"RectangleRectangle",value:function(e,n,a,i){var r=[new S(e.x,e.y,n.x,e.y),new S(n.x,e.y,n.x,n.y),new S(e.x,n.y,n.x,n.y),new S(e.x,e.y,e.x,n.y)],o=[new S(a.x,a.y,i.x,a.y),new S(i.x,a.y,i.x,i.y),new S(a.x,i.y,i.x,i.y),new S(a.x,a.y,a.x,i.y)],s=[];return r.forEach(function(e){o.forEach(function(n){var a=t.LineLine(e,n);a&&s.push(a)})}),s}},{key:"LineRectangle",value:function(e,n,a){var i=new Array(4),r=[];return i[0]=new S(n.x,n.y,a.x,n.y),i[1]=new S(n.x,a.y,a.x,a.y),i[2]=new S(n.x,n.y,n.x,a.y),i[3]=new S(a.x,n.y,a.x,a.y),i.forEach(function(n){var a=t.LineLine(e,n);a&&r.length<2&&r.push(a)}),r}},{key:"LineLine",value:function(e,n){var a=t.SLineSLine(new P(e),new P(n));return a&&k.pointOnLine(a,e.p1,e.p2)&&k.pointOnLine(a,n.p1,n.p2)?a:null}},{key:"CircleSLine",value:function(t,e){var n=-t.center.x,a=-t.center.y,i=k.LineShifted(e,n,a),r=i.a,o=i.b,s=i.c,c=t.radius;0===o&&(r=i.b,o=i.a);var l=r*r+o*o,u=2*r*s,h=s*s-c*c*o*o,d=k.QuadEquation(l,u,h);if(null===d)return null;for(var f=new Array(d.length),p=0;p<d.length;p++)f[p]=new w,0===i.b?(f[p].y=d[p],f[p].x=-(r*d[p]+s)/o):(f[p].x=d[p],f[p].y=-(r*d[p]+s)/o),f[p].x=f[p].x-n,f[p].y=f[p].y-a;return f}},{key:"CircleRLine",value:function(e,n){var a=t.CircleSLine(e,new P(n.origin,new w(n.origin.x+n.vector.x,n.origin.y+n.vector.y)));if(null===a)return null;var i,r=0,o=0,s=g(a);try{for(s.s();!(i=s.n()).done;){var c=i.value;k.isPointOnRayLine(n,c)?r++:a[o]=null,o++}}catch(f){s.e(f)}finally{s.f()}if(0===r)return null;var l=new Array(r);r=0;var u,h=g(a);try{for(h.s();!(u=h.n()).done;){var d=u.value;null!=d&&(l[r++]=d)}}catch(f){h.e(f)}finally{h.f()}return l}}]),t}(),k=function(){function t(){Object(f.a)(this,t)}return Object(p.a)(t,null,[{key:"realToScreenLength",value:function(t,e,n){return Math.trunc(t/(e/n))}},{key:"screenToRealLength",value:function(t,e,n){return Math.trunc(t*(e/n))}},{key:"SLineFromRLine",value:function(t){return new P(t.origin,new w(t.origin.x+t.vector.x,t.origin.y+t.vector.y))}},{key:"SLineFromLine",value:function(t){return new P(t.p1,t.p2)}},{key:"SLineByTwoPoints",value:function(t,e){return new P(t,e)}},{key:"SLinePerpOnPoint",value:function(t,e){return new P(-t.b,t.a,-t.a*e.y+t.b*e.x)}},{key:"LineShifted",value:function(t,e,n){for(var a=new Array(2),i=0;i<2;i++){var r=i,o=t.getYbyX(r);isNaN(o)&&(o=i,r=t.getXbyY(o)),r+=e,o+=n,a[i]=new w(r,o)}return new P(a[0],a[1])}},{key:"pointInRect",value:function(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(t.x-n.x)*(t.x-e.x),r=(t.y-n.y)*(t.y-e.y);return(a?i<=0:i<0)&&(a?r<=0:r<0)}},{key:"pointInRectByPoints",value:function(t,e,n,a,i,r){return t>=n&&t<=i&&e<=a&&e>=r}},{key:"linesIntersection",value:function(e,n){var a=T.SLineSLine(new P(e),new P(n));return t.pointOnLine(a,e.p1,e.p2,!1)&&t.pointOnLine(a,n.p1,n.p2,!1)}},{key:"rectIntersection",value:function(e,n){var a=!1;return(a=i(e,n))||(a=i(n,e)),a||(a=t.rectIntersection2(e,n)),a||(a=t.rectIntersection2(n,e)),a;function i(e,n){return!!t.pointInRect(e.topLeft,n.topLeft,n.bottomRight,!1)||(!!t.pointInRect(e.bottomRight,n.topLeft,n.bottomRight,!1)||(!!t.pointInRect({x:e.topLeft.x,y:e.bottomRight.y},n.topLeft,n.bottomRight,!1)||!!t.pointInRect({x:e.bottomRight.x,y:e.topLeft.y},n.topLeft,n.bottomRight,!1)))}}},{key:"rectIntersection2",value:function(e,n){var a={p1:e.topLeft,p2:e.bottomRight},i={p1:n.topLeft,p2:{x:n.topLeft.x,y:n.bottomRight.y}},r={p1:n.topLeft,p2:{x:n.bottomRight.x,y:n.topLeft.y}},o={p1:n.bottomRight,p2:{x:n.topLeft.x,y:n.bottomRight.y}},s={p1:n.bottomRight,p2:{x:n.bottomRight.x,y:n.topLeft.y}};return[t.linesIntersection(a,i),t.linesIntersection(a,r),t.linesIntersection(a,o),t.linesIntersection(a,s)].some(function(t){return t})}},{key:"rectInRect",value:function(e,n){return[t.pointInRect(e.topLeft,n.topLeft,n.bottomRight,!0),t.pointInRect({x:e.topLeft.x,y:e.bottomRight.y},n.topLeft,n.bottomRight,!0),t.pointInRect({x:e.bottomRight.x,y:e.topLeft.y},n.topLeft,n.bottomRight,!0),t.pointInRect(e.bottomRight,n.topLeft,n.bottomRight,!0)].every(function(t){return t})}},{key:"rectToRectDist",value:function(e,n){var a={x:(e.topLeft.x+e.bottomRight.x)/2,y:(e.topLeft.y+e.bottomRight.y)/2},i={x:(n.topLeft.x+n.bottomRight.x)/2,y:(n.topLeft.y+n.bottomRight.y)/2};return t.distance(a,i)}},{key:"minPointToRectDist",value:function(t,e){var n=Math.abs(t.x-e.topLeft.x),a=Math.abs(t.x-e.bottomRight.x),i=Math.abs(t.y-e.topLeft.y),r=Math.abs(t.y-e.bottomRight.y);return{dx:{dist:Math.min(n,a),posX:n<a?e.topLeft.x:e.bottomRight.x},dy:{dist:Math.min(i,r),posY:i<r?e.topLeft.y:e.bottomRight.y}}}},{key:"minRectDist",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];function a(t,e){return Math.max(t.p1,t.p2,e.p1,e.p2)-Math.min(t.p1,t.p2,e.p1,e.p2)<Math.abs(t.p1-t.p2)+Math.abs(e.p1-e.p2)}var i={dist:NaN},r={dist:NaN};if(a({p1:t.topLeft.y,p2:t.bottomRight.y},{p1:e.topLeft.y,p2:e.bottomRight.y})){var o=n?e.bottomRight.x-t.topLeft.x:t.topLeft.x-e.topLeft.x,s=n?e.topLeft.x-t.bottomRight.x:e.bottomRight.x-t.bottomRight.x;i.front=Math.abs(o)<Math.abs(s),i.pos=n?i.front?e.bottomRight.x:e.topLeft.x:i.front?e.topLeft.x:e.bottomRight.x,i.dist=i.front?o:s}if(a({p1:t.topLeft.x,p2:t.bottomRight.x},{p1:e.topLeft.x,p2:e.bottomRight.x})){var c=n?e.bottomRight.y-t.topLeft.y:e.topLeft.y-t.topLeft.y,l=n?e.topLeft.y-t.bottomRight.y:e.bottomRight.y-t.bottomRight.y;r.front=Math.abs(c)<Math.abs(l),r.pos=n?r.front?e.bottomRight.y:e.topLeft.y:r.front?e.topLeft.y:e.bottomRight.y,r.dist=r.front?c:l}return{dx:i,dy:r}}},{key:"pointOnLine",value:function(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!t||!e||!n)return!1;var i=Math.round((t.x-e.x)*(t.x-n.x)*1e5)/1e5,r=Math.round((t.y-e.y)*(t.y-n.y)*1e5)/1e5;return a?i<=0&&r<=0:i<0&&r<=0||i<=0&&r<0}},{key:"pointOnSLineProjection",value:function(e,n){return T.SLineSLine(n,t.SLinePerpOnPoint(n,e))}},{key:"PointToSLineDistance",value:function(e,n){return t.distance(e,t.pointOnSLineProjection(e,n))}},{key:"PointToRLineDistance",value:function(e,n){var a=t.pointOnSLineProjection(e,t.SLineFromRLine(n));return t.isPointOnRayLine(n,a)?t.distance(e,a):t.distance(e,n.origin)}},{key:"PointToLineDistance",value:function(e,n){var a=t.pointOnSLineProjection(e,t.SLineFromLine(n));return t.pointOnLine(a,n.p1,n.p2)?t.distance(e,a):Math.min(t.distance(e,n.p1),t.distance(e,n.p2))}},{key:"midPoint",value:function(t,e){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}},{key:"scalar",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"modulus",value:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}},{key:"angleVectors",value:function(t,e){var n=Math.sign(t.x*e.y-e.x*t.y);return Math.acos(this.scalar(t,e)/(t.modulus*e.modulus))*n}},{key:"arcCenterPoint",value:function(e,n,a){var i=new P(e,n),r=new P(n,a),o=t.midPoint(e,n),s=t.midPoint(n,a),c=t.SLinePerpOnPoint(i,o),l=t.SLinePerpOnPoint(r,s);return T.SLineSLine(c,l)}},{key:"isPointOnRayLine",value:function(t,e){return(e.x-t.origin.x)*t.vector.x>=0&&(e.y-t.origin.y)*t.vector.y>=0}},{key:"arcMiddlePoint",value:function(e){var n=t.midPoint(e.first,e.third),a=Math.sqrt((n.x-e.center.x)*(n.x-e.center.x)+(n.y-e.center.y)*(n.y-e.center.y));return new w(e.radius/a+e.center.x,e.radius/a+e.center.y)}},{key:"arcToPointArray",value:function(e,n){if(e.chord<=n){var a=new Array(2);return a[0]=e.first,a[1]=e.third,a}for(var i=t.arcMiddlePoint(e),r=t.arcToPointArray(t.arcByTwoPointsCenter(e.first,i,e.center),n),o=t.arcToPointArray(t.arcByTwoPointsCenter(i,e.third,e.center),n),s=r.length-1+o.length,c=new Array(s),l=0;l<=s;l++)l<r.length-1?c[l]=r[l]:c[l]=o[l];return c}},{key:"arcByTwoPointsCenter",value:function(e,n,a){var i=t.midPoint(e,n),r=Math.sqrt((i.x-a.x)*(i.x-a.x)+(i.y-a.y)*(i.y-a.y)),o=Math.sqrt((e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y));return new O(e,new w(o/r+a.x,o/r+a.y),n)}},{key:"arcLength",value:function(e){var n=new D(e.center,e.first),a=new D(e.center,e.third);return t.angleVectors(n,a)*e.radius}},{key:"QuadEquation",value:function(t,e,n){if(0===t)return null;var a=e*e-4*t*n;if(a<0)return null;var i=[];return 0===a?((i=[])[0]=-e/(2*t),i):((i=[])[0]=(-e+Math.sqrt(a))/(2*t),i[1]=(-e-Math.sqrt(a))/(2*t),i)}},{key:"distance",value:function(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}},{key:"rotatePoint",value:function(t,e,n){var a=t.x-n.x,i=t.y-n.y,r={};return r.x=a*Math.cos(e)-i*Math.sin(e)+n.x,r.y=a*Math.sin(e)+i*Math.cos(e)+n.y,r}},{key:"screenToReal",value:function(t,e,n,a,i,r){var o=r.x-i.x,s=i.y-r.y;return{x:t/n*o+i.x,y:i.y-e/a*s}}},{key:"realToScreen",value:function(t,e,n){var a=e.width/n.width;return{x:Math.trunc((t.x-e.topLeft.x)/a),y:-Math.trunc((t.y-e.topLeft.y)/a)}}}]),t}();function j(t){var e=t.target.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}function R(t,e,n){var a=n.realWidth,i=n.viewPortWidth,r=n.viewPortHeight,o=n.topLeft,s=a*t,c=n.gridStep,l=s/i,u=r*l,d=e.x-o.x,f=e.y-o.y;if(u<500)return Object(h.a)({},n);d*=t,f*=t;var p={x:e.x-d,y:e.y-f},v={};v.x=p.x+s,v.y=p.y-u,c/l<10?c<1e6&&(c*=10):c/l>100&&c>.001&&(c/=10);var y=Math.round(c/l);return Object(h.a)({},n,{realWidth:s,realHeight:u,topLeft:p,bottomRight:v,pixelRatio:l,gridStepPixels:y,gridStep:c})}function A(t,e,n){return Object(h.a)({},n,{curRealPoint:t,curScreenPoint:e})}function C(t,e){var n={};return n.x=t.x+e.realWidth,n.y=t.y-e.realHeight,Object(h.a)({},e,{topLeft:t,bottomRight:n})}function L(t,e){var n=new x;return n.topLeft=t,n.bottomRight=e,n.width=e.x-t.x,n.height=t.y-e.y,n}function I(t,e){var n=new x;return n.topLeft.x=0,n.topLeft.y=0,n.width=t,n.height=e,n}function _(t,e,n,a){var i=e*n/t;return Object(h.a)({},a,{viewPortWidth:t,viewPortHeight:e,realWidth:n,ratio:t/e,pixelRatio:n/a.viewPortWidth,realHeight:i,bottomRight:{x:a.topLeft.x+n,y:a.topLeft.y-i}})}function N(t,e){var n=t.topLeft,a=t.bottomRight,i=n.y-a.y,r=a.x-n.x,o=r/i<e.ratio?i*e.ratio:r,s=_(e.viewPortWidth,e.viewPortHeight,o,e),c=(n.x+a.x)/2,l=(n.y+a.y)/2,u=s.realWidth-(s.marginLeft+s.marginRight)*s.pixelRatio,d=s.realHeight-(s.marginTop+s.marginBottom)*s.pixelRatio,f={x:c-u/2-s.marginLeft*s.pixelRatio,y:l+d/2+s.marginTop*s.pixelRatio},p={};return p.x=f.x+s.realWidth,p.y=f.y-s.realHeight,Object(h.a)({},s,{topLeft:f,bottomRight:p})}function M(t,e,n){var a=window.innerHeight,i=document.getElementById("canvas-container"),r=getComputedStyle(i),o=Number.parseInt(r.width),s=window.innerHeight<=window.innerWidth?.8*a:o;return e(function(t){return _(o,s,t.realWidth,t)}),n.width=o,n.height=s,n.style.width=o+"px",n.style.height=s+"px",{sw:o,sh:s}}var F=function(){function t(e){Object(f.a)(this,t),this.isMobile=e.isMobile,this.clickCount=0,this.curShape=null,this.coord={x:0,y:0},this.prevCoord=this.coord,this.statusBar=[],this.properties=[],this.captions=e||e.captions?e.captions.toolbars.statusbar:{}}return Object(p.a)(t,[{key:"setCaptions",value:function(t){this.captions=t,this.setStatusBar()}},{key:"keypress",value:function(t){if("Space"===t)return!0}},{key:"click",value:function(t){t.button;var e=t.curPoint,n=t.viewPortData;this.clickCount++,this.coord=k.screenToReal(e.x,e.y,n.viewPortWidth,n.viewPortHeight,n.topLeft,n.bottomRight),this.prevCoord=this.coord}},{key:"doubleClick",value:function(t){t.button;var e=t.curPoint,n=t.viewPortData;this.coord=k.screenToReal(e.x,e.y,n.viewPortWidth,n.viewPortHeight,n.topLeft,n.bottomRight)}},{key:"isOutRect",value:function(t,e){return t.x<e.marginLeft||t.x>e.viewPortWidth-e.marginRight||t.y<e.marginTop||t.y>e.viewPortHeight-e.marginBottom}},{key:"move",value:function(t){var e=t.curPoint,n=t.viewPortData;this.prevPoint=Object(h.a)({},this.curPoint),this.curPoint=Object(h.a)({},e),this.coord=k.screenToReal(this.curPoint.x,this.curPoint.y,n.viewPortWidth,n.viewPortHeight,n.topLeft,n.bottomRight),this.coord.x=Math.trunc(this.coord.x),this.coord.y=Math.trunc(this.coord.y),this.mouseOnScreen=!this.isOutRect(this.curPoint,n),this.mouseOnScreen||(this.curPoint.x=this.prevPoint.x,this.curPoint.y=this.prevPoint.y)}},{key:"mouseOnScreen",value:function(t){return!this.isOutRect(this.curPoint,t)}},{key:"down",value:function(t){var e=t.curPoint,n=t.viewPortData;this.coord=k.screenToReal(e.x,e.y,n.viewPortWidth,n.viewPortHeight,n.topLeft,n.bottomRight)}},{key:"up",value:function(){}},{key:"leave",value:function(){this.mouseOnScreen=!1}},{key:"wheel",value:function(t){var e=t.deltaY,n=t.curPoint,a=t.viewPortData,i=t.setViewPortData,r=(t.appActions,t.keys,k.screenToReal(n.x,n.y,a.viewPortWidth,a.viewPortHeight,a.topLeft,a.bottomRight));e>0&&a.realWidth<=9e3&&i(function(t){return R(1.2,r,t)}),e<0&&a.pixelRatio>=.001&&i(function(t){return R(1/1.2,r,t)})}},{key:"touchDown",value:function(t){var e=t.pointerId,n=t.curPoint;t.viewPortData.touchManager.addTouchEvent({pointerId:e,curPoint:n})}},{key:"touchMove",value:function(t){var e=t.pointerId,n=t.curPoint,a=t.viewPortData;a.touchManager.setPoint(e,n),this.curPoint=Object(h.a)({},n),this.coord=k.screenToReal(this.curPoint.x,this.curPoint.y,a.viewPortWidth,a.viewPortHeight,a.topLeft,a.bottomRight)}},{key:"touchUp",value:function(t){var e=t.pointerId;t.viewPortData.touchManager.removeTouchEvent(e)}}]),t}();F.MBUTTON_LEFT=0,F.MBUTTON_MIDDLE=1,F.MBUTTON_RIGHT=2;var H={BLUE:"#0000FF",BLACK:"#000000",GRAY:"#D0D0D0",LIGHT_GRAY:"#EEEEEE",DARK_GRAY:"#505050",RED:"#FF0000",DARK_ORANGE:"#FFB000",GREEN:"#00FF00",WHITE:"#FFFFFF",SELECTED:"#0000FF",SELECTION_AREA:"#000000",GRID:"#E0E0E0",SELECTED_POINT_MARKER:"#FF0000",POINT_MARKER:"#0000FF"},B=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H.BLACK,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.SOLID,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object(f.a)(this,t),this.color=e,this.originColor=this.color,this.width=a,this.stroke=n}return Object(p.a)(t,[{key:"getDefault",value:function(){return new t(H.BLACK,t.SOLID)}},{key:"getColor",value:function(){return this.color}},{key:"setColor",value:function(t){this.color=t}},{key:"getType",value:function(){return this.type}},{key:"getStroke",value:function(){return this.stroke}},{key:"setStroke",value:function(t){this.stroke=t}},{key:"getWidth",value:function(){return this.width}},{key:"setWidth",value:function(t){this.width=t}}]),t}();B.DASH=[1,3],B.SOLID=[0],B.SELECTION=[1,3],B.ACTIVE_SHAPE=new B(H.BLACK,B.SOLID,2),B.INACTIVE_SHAPE=new B(H.BLACK,B.SOLID,1),B.MockShape=new B(H.DARK_GRAY,B.SOLID),B.GRID_STYLE_DASH=new B(H.GRAY,B.DASH),B.GRID_STYLE_SOLID=new B(H.GRAY,B.SOLID);var V=function(){function t(){Object(f.a)(this,t),this.style=new B(H.BLACK,B.SOLID),this.selectedStyle=new B(H.SELECTED,B.SOLID,3),this.highlightedStyle=new B(H.BLACK,B.SOLID,3),this.errorStyle=new B(H.RED,B.SOLID),this.defaultStyle=new B(H.BLACK,B.SOLID,1),this.state={selected:!1,inSelection:!1,underCursor:!1,highlighted:!1},this.properties=[]}return Object(p.a)(t,[{key:"getProperties",value:function(){var t=this;return this.properties.forEach(function(e){return e.value=t[e.key]}),this.properties}},{key:"setProperty",value:function(t){var e=t.key,n=t.value;this[e]=n}},{key:"refreshStyle",value:function(t){this.setState(this.state),t.strokeStyle=this.getStyle().getColor(),t.fillStyle=this.getStyle().getColor(),t.setLineDash(this.getStyle().getStroke()),t.lineWidth=this.getStyle().getWidth()}},{key:"draw",value:function(t,e,n){this.refresh(e,n),this.refreshStyle(t)}},{key:"hasChildren",value:function(){return!1}},{key:"setColor",value:function(t){this.style.setColor(t),this.fillStyle=t}},{key:"getColor",value:function(){return this.style.getColor()}},{key:"getStyle",value:function(){return this.style}},{key:"setStyle",value:function(t){this.style=t}},{key:"setFillStyle",value:function(t){this.fillStyle=t}},{key:"onAddToSelection",value:function(){this.state.selected=!0}},{key:"onDeleteFromSelection",value:function(){this.state.selected=!1}},{key:"setState",value:function(t){this.state=Object(h.a)({},this.state,t),!0!==this.state.selected?(this.setStyle(this.defaultStyle),this.state.highlighted&&this.setStyle(this.highlightedStyle),this.state.highlighted&&this.setStyle(this.highlightedStyle),this.state.error&&this.setStyle(this.errorStyle)):this.setStyle(this.selectedStyle)}},{key:"getState",value:function(){return this.state}},{key:"getSingleDimensionData",value:function(){return{hasDimension:!1}}}]),t}();V.PANEL="PANEL",V.DOUBLE_PANEL="DOUBLE_PANEL",V.DIMENSION="DIMENSION",V.DRAWER="DRAWER",V.TUBE="TUBE",V.FASADE="FASADE";var W=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this))).p=t,n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"refresh",value:function(t,e){this.p0=k.realToScreen(this.p,t,e)}},{key:"setPosition",value:function(t){this.p=t}},{key:"setAdditional",value:function(t){var e=t.shiftKey,n=t.altKey;this.shiftKey=e,this.altKey=n}}]),e}(V),U=function(t){function e(){return Object(f.a)(this,e),Object(v.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,e,n){this.refresh(e,n),t.strokeStyle=this.getStyle().getColor(),t.setLineDash(this.getStyle().getStroke()),t.lineWidth=2;t.beginPath(),t.moveTo(this.p0.x-10+.5,this.p0.y+.5),t.lineTo(this.p0.x+10+.5,this.p0.y+.5),t.moveTo(this.p0.x+.5,this.p0.y-10+.5),t.lineTo(this.p0.x+.5,this.p0.y+10+.5),t.stroke()}}]),e}(W),K={FREE:"FREE",SELECT:"SELECT",CREATE:"CREATE",DRAWING:"DRAWING",CANCEL:"CANCEL",PAN:"PAN",MEASURE:"MEASURE"},G=function(){return(new Date).toISOString().substr(0,10)};function z(){return navigator.maxTouchPoints>1}var X,Y,J=n(13),q=n(10),$="OUT_OF_AREA",Z="ON_PANEL",Q="NO_JOINTS",tt="DONT_FIT",et=n(16),nt={user:{name:"Guest"},about:{name:"\u0410\u0432\u0442\u043e\u0440: \u0422\u0430\u0445\u043c\u0430\u0437\u043e\u0432 \u0411\u043e\u0440\u0438\u0441",email:"tboris1983@gmail.com"},buttons:{cancel:"\u041e\u0442\u043c\u0435\u043d\u0430",logout:"\u0412\u044b\u0445\u043e\u0434",login:"\u0412\u043e\u0439\u0442\u0438",signup:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442"},serverMessages:(X={},Object(q.a)(X,et.default.NO_ERROR,""),Object(q.a)(X,et.default.ACTIVATION_SUCCEED,"\u0410\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e"),Object(q.a)(X,et.default.EMAIL_SEND_ERROR,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 e-mail"),Object(q.a)(X,et.default.INVALID_ACTIVATION_CODE,"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434 \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438"),Object(q.a)(X,et.default.INVALID_EMAIL,"E-mail \u043d\u0435\u0432\u0435\u0440\u043d\u043e\u0433\u043e \u0444\u043e\u0440\u043c\u0430\u0442\u0430"),Object(q.a)(X,et.default.INVALID_NAME,"\u0418\u043c\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b \u0438\u043b\u0438 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u043e\u0440\u043e\u0442\u043a\u043e\u0435"),Object(q.a)(X,et.default.INVALID_PASSWORD,"\u041f\u0430\u0440\u043e\u043b\u044c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b \u0438\u043b\u0438 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439"),Object(q.a)(X,et.default.INVALID_USER_DATA,"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0438\u043c\u044f, e-mail \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"),Object(q.a)(X,et.default.LOGIN_SUCCEED,"\u0412\u0445\u043e\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d"),Object(q.a)(X,et.default.NO_ACTIVATED,"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d"),Object(q.a)(X,et.default.PASSWORDS_NOT_MATCH,"\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"),Object(q.a)(X,et.default.REG_SUCCEED,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e. \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0438\u0437 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0433\u043e e-mail"),Object(q.a)(X,et.default.SERVER_ERROR,"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430"),Object(q.a)(X,et.default.USER_EMAIL_ALLOWED,"E-mail \u0441\u0432\u043e\u0431\u043e\u0434\u0435\u043d"),Object(q.a)(X,et.default.USER_EMAIL_EXIST,"E-mail \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d"),Object(q.a)(X,et.default.USER_NAME_ALLOWED,"\u0418\u043c\u044f \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e"),Object(q.a)(X,et.default.USER_NAME_EXIST,"\u0418\u043c\u044f \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043e"),Object(q.a)(X,et.default.USER_EMAIL_NOT_EXIST,"E-mail \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"),X),registerForm:{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",name:"\u0418\u043c\u044f (\u043c\u0438\u043d. 4 \u0441\u0438\u043c\u0432\u043e\u043b\u0430)",email:"E-Mail",password:"\u041f\u0430\u0440\u043e\u043b\u044c (\u043c\u0438\u043d. 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)",passwordAgain:"\u041f\u0430\u0440\u043e\u043b\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e",login:"\u0412\u0445\u043e\u0434",cancel:"\u041e\u0442\u043c\u0435\u043d\u0430",showPass:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",checkName:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0438\u043c\u044f",checkEmail:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c e-mail"},loginForm:{title:"\u0412\u0445\u043e\u0434",name:"\u0418\u043c\u044f \u0438\u043b\u0438 E-mail",password:"\u041f\u0430\u0440\u043e\u043b\u044c",showPass:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c",cancel:"\u041e\u0442\u043c\u0435\u043d\u0430",register:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",remember:"\u0417\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c"},activation:{title:"\u0410\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u044f",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438"},toolbars:{hide:"\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c",unhide:"\u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c",project:{title:"\u041f\u0440\u043e\u0435\u043a\u0442",new:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442",open:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442",save:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442",preview:"\u041f\u0435\u0447\u0430\u0442\u044c \u043e\u0442\u0447\u0435\u0442\u0430",savePdf:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043e\u0442\u0447\u0435\u0442",disabled:"","-disabled":" (\u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0434\u043b\u044f \u043d\u0435\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439)",wardrobe:{width:"\u0428\u0438\u0440\u0438\u043d\u0430",depth:"\u0413\u043b\u0443\u0431\u0438\u043d\u0430",height:"\u0412\u044b\u0441\u043e\u0442\u0430",type:{type:"\u0422\u0438\u043f",single:"\u041e\u0434\u0438\u043d\u0430\u0440\u043d\u044b\u0439",double:"\u0414\u0432\u043e\u0439\u043d\u043e\u0439"},fasadeCount:"\u041a\u043e\u043b-\u0432\u043e \u0444\u0430\u0441\u0430\u0434\u043e\u0432"}},info:{title:"\u041e\u0431\u0449\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f",wardrobe:{title:"\u0413\u0430\u0431\u0430\u0440\u0438\u0442\u044b",width:"\u0428\u0438\u0440\u0438\u043d\u0430",depth:"\u0413\u043b\u0443\u0431\u0438\u043d\u0430",height:"\u0412\u044b\u0441\u043e\u0442\u0430"},materials:{title:"\u041c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b",dspMainColor:"\u0426\u0432\u0435\u0442 \u043a\u043e\u0440\u043f\u0443\u0441\u0430 \u0414\u0421\u041f",fasadBase:"\u041e\u0441\u043d\u043e\u0432\u0430 \u0444\u0430\u0441\u0430\u0434\u043e\u0432",fasadBaseColor:"\u0426\u0432\u0435\u0442 \u0444\u0430\u0441\u0430\u0434\u043e\u0432",depth:"\u0413\u043b\u0443\u0431\u0438\u043d\u0430",height:"\u0412\u044b\u0441\u043e\u0442\u0430",combi:"\u041a\u043e\u043c\u0431\u0438",fasadBases:{DSP:"\u0414\u0421\u041f",MIRROR:"\u0417\u0435\u0440\u043a\u0430\u043b\u043e",SAND:"\u041f\u0435\u0441\u043e\u043a",LACOBEL:"\u041b\u0430\u043a\u043e\u0431\u0435\u043b\u044c"}}},instruments:{title:"\u0414\u0435\u0442\u0430\u043b\u0438",dimensions:"\u0420\u0430\u0437\u043c\u0435\u0440\u044b",createVertical:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u0443\u044e \u0434\u0435\u0442\u0430\u043b\u044c",createHorizontal:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u0443\u044e \u0434\u0435\u0442\u0430\u043b\u044c",createDrawer:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u044f\u0449\u0438\u043a",createDrawerBlock:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u044f\u0449\u0438\u0447\u043d\u044b\u0439 \u0431\u043b\u043e\u043a",createTube:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u0440\u0443\u0431\u0443",createSingleDimension:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0439 \u0434\u0435\u0442\u0430\u043b\u0438",createTwoPanelDimensionInside:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043c\u0435\u0436\u0434\u0443 \u0434\u0435\u0442\u0430\u043b\u044f\u043c\u0438 \u0438\u0437\u043d\u0443\u0442\u0440\u0438",createTwoPanelDimensionOutside:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043c\u0435\u0436\u0434\u0443 \u0434\u0435\u0442\u0430\u043b\u044f\u043c\u0438 \u0441\u043d\u0430\u0440\u0443\u0436\u0438",divideFasadHor:"\u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u044c \u0444\u0430\u0441\u0430\u0434 \u043f\u043e \u0432\u044b\u0441\u043e\u0442\u0435",divideFasadVert:"\u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u044c \u0444\u0430\u0441\u0430\u0434 \u043f\u043e \u0448\u0438\u0440\u0438\u043d\u0435",createFasadeLengthDimension:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0441\u0430\u0434\u0430 \u043f\u043e \u0432\u044b\u0441\u043e\u0442\u0435",createFasadeWidthDimension:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0441\u0430\u0434\u0430 \u043f\u043e \u0448\u0438\u0440\u0438\u043d\u0435"},operations:{title:"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0438",moveLeft:"\u0414\u0432\u0438\u0433\u0430\u0442\u044c \u0432\u043b\u0435\u0432\u043e",moveRight:"\u0414\u0432\u0438\u0433\u0430\u0442\u044c \u0432\u043f\u0440\u0430\u0432\u043e",moveUp:"\u0414\u0432\u0438\u0433\u0430\u0442\u044c \u0432\u0432\u0435\u0440\u0445",moveDown:"\u0414\u0432\u0438\u0433\u0430\u0442\u044c \u0432\u043d\u0438\u0437",resetView:"\u0426\u0435\u043d\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0438\u0434",distribute:"\u0420\u0430\u0441\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0432\u043d\u043e\u043c\u0435\u0440\u043d\u043e"},property:{title:"\u0421\u0432\u043e\u0439\u0441\u0442\u0432\u0430",noselected:"\u041d\u0435\u0442 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432",selected:"\u0412\u044b\u0434\u0435\u043b\u0435\u043d\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432: ",name:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",length:"\u0414\u043b\u0438\u043d\u0430",height:"\u0412\u044b\u0441\u043e\u0442\u0430",drawerWidth:"\u0428\u0438\u0440\u0438\u043d\u0430 \u043f\u0440\u043e\u0435\u043c\u0430",depth:"\u0413\u043b\u0443\u0431\u0438\u043d\u0430",width:"\u0428\u0438\u0440\u0438\u043d\u0430",base:"\u041e\u0441\u043d\u043e\u0432\u0430",baseColor:"\u0426\u0432\u0435\u0442",nodrill:"\u041d\u0435 \u0441\u0432\u0435\u0440\u043b\u0438\u0442\u044c",lock_width:"\u0417\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0448\u0438\u0440\u0438\u043d\u0443",unlock_width:"\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0448\u0438\u0440\u0438\u043d\u0443",lock_height:"\u0417\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0441\u043e\u0442\u0443",unlock_height:"\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u0441\u043e\u0442\u0443",lock_move:"\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435",unlock_move:"\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435",lock_minlength:"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c",unlock_minlength:"\u0423\u0431\u0440\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440",lock_maxlength:"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c",unlock_maxlength:"\u0423\u0431\u0440\u0430\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440",delete:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",levelup:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043d\u0430 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0432\u044b\u0448\u0435"},settings:{title:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",showModule:"\u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u043c\u043e\u0434\u0443\u043b\u044c \u043d\u0430 \u0434\u0435\u0442\u0430\u043b\u0438",deleteConfirm:"\u0441\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u0434 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435\u043c"},print:{title:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043f\u0435\u0447\u0430\u0442\u0438",close:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"},statusbar:{move:"\u0434\u0432\u0438\u0433\u0430\u0442\u044c \u0440\u0430\u0431\u043e\u0447\u0435\u0435 \u043f\u043e\u043b\u0435",scale:"\u043c\u0430\u0441\u0448\u0442\u0430\u0431",rotate:"\u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0434\u0435\u0442\u0430\u043b\u044c",snap:"\u043f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u0432\u043a\u043b/\u0432\u044b\u043a\u043b",stopmeasure:"\u0432\u044b\u0445\u043e\u0434 \u0438\u0437 \u0440\u0435\u0436\u0438\u043c\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",pick1:"\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 1-\u044e \u0442\u043e\u0447\u043a\u0443 \u043f\u0440\u044f\u043c\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0438\u043a\u0430 \u0432\u043d\u0443\u0442\u0440\u0438 \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0438",pick2:"\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 2-\u044e \u0442\u043e\u0447\u043a\u0443 \u043f\u0440\u044f\u043c\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0438\u043a\u0430 \u0432\u043d\u0443\u0442\u0440\u0438 \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0438"},viewport:{tableTitle:"\u0420\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0430",module:"\u041c\u043e\u0434\u0443\u043b\u044c",length:"\u0414\u043b\u0438\u043d\u0430",width:"\u0428\u0438\u0440\u0438\u043d\u0430",count:"\u041a\u043e\u043b-\u0432\u043e"},workspace:{corpus:"\u041a\u041e\u0420\u041f\u0423\u0421",fasades:"\u0424\u0410\u0421\u0410\u0414\u042b"}},handlers:{create:(Y={},Object(q.a)(Y,$,"\u0432\u044b\u0445\u043e\u0434\u0438\u0442 \u0437\u0430 \u0433\u0440\u0430\u043d\u0438\u0446\u044b"),Object(q.a)(Y,Z,"\u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u043d\u0430 \u0434\u0435\u0442\u0430\u043b\u044c"),Object(q.a)(Y,Q,"\u043d\u0435\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f"),Object(q.a)(Y,tt,"\u043d\u0435 \u043f\u043e\u043c\u0435\u0449\u0430\u0435\u0442\u0441\u044f \u0432 \u0440\u0430\u0437\u043c\u0435\u0440"),Y)},title:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440 \u0448\u043a\u0430\u0444\u043e\u0432-\u043a\u0443\u043f\u0435",messages:{deleteJointedPanels:"\u0411\u0443\u0434\u0443\u0442 \u0442\u0430\u043a\u0436\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u044b \u0432\u0441\u0435 \u0441\u043e\u043f\u0440\u044f\u0436\u0435\u043d\u043d\u044b\u0435 \u0434\u0435\u0442\u0430\u043b\u0438. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c?",deletePanels:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b?",deleteTable:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u0440\u0430\u0441\u043a\u043b\u0430\u0434\u043a\u0443?",deleteRow:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443?",changeTexture:"\u041d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0434\u0435\u0442\u0430\u043b\u0438 \u043f\u043e\u0432\u0435\u0440\u043d\u0443\u0442\u044b \u043f\u0440\u043e\u0442\u0438\u0432 \u0442\u0435\u043a\u0441\u0442\u0443\u0440\u044b. \u041f\u0435\u0440\u0435\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043e\u0431\u0440\u0430\u0442\u043d\u043e?",newProject:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442?",corruptedProject:"\u0424\u0430\u0439\u043b \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0444\u043e\u0440\u043c\u0430\u0442\u0430",corruptedDetailList:"\u0424\u0430\u0439\u043b \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0444\u043e\u0440\u043c\u0430\u0442\u0430",logout:"\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u0439\u0442\u0438?"},selection:{crossSelect:"Partial selection",fullSelect:"Full selection",selectedVertexes:{of:"of",selected:"Points selected"}},showGrid:"Show grid",propBar:"Properties",noPanelsSelected:"\u041d\u0435\u0442 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0434\u0435\u0442\u0430\u043b\u0435\u0439",NPanelsSelected:" panels selected",deleteButton:"Delete",print:{title:"\u0417\u0430\u043a\u0430\u0437",dataTable:{title:"\u0421\u043f\u0435\u0446\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f",gabarits:"1.\u0413\u0430\u0431\u0430\u0440\u0438\u0442\u044b \u0438\u0437\u0434\u0435\u043b\u0438\u044f (\u043e\u0431\u0449\u0438\u0439)",width:"1.\u0448\u0438\u0440\u0438\u043d\u0430:",depth:"2.\u0433\u043b\u0443\u0431\u0438\u043d\u0430:",height:"3.\u0432\u044b\u0441\u043e\u0442\u0430:",single:"(\u0446\u0435\u043b\u044c\u043d\u044b\u0439)",double:"(\u0441\u0434\u0432\u043e\u0435\u043d\u043d\u043d\u044b\u0439)",DSPcolor:"2.\u0426\u0432\u0435\u0442 \u0414\u0421\u041f",DSPcorpus:"1.\u0414\u0421\u041f (\u043a\u043e\u0440\u043f\u0443\u0441):",DSPext:"2.\u0414\u0421\u041f (\u0434\u043e\u043f\u043e\u043b\u043d):"}},help:{title:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430",hotKeys:[{key:"ESC",desc:"\u041e\u0442\u043c\u0435\u043d\u0430 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"},{key:"Delete",desc:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0434\u0435\u0442\u0430\u043b\u0438"},{key:"\u041a\u043e\u043b\u0435\u0441\u0438\u043a\u043e \u043c\u044b\u0448\u0438",desc:"\u041c\u0430\u0441\u0448\u0442\u0430\u0431 +/-"},{key:"\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u043a\u043d\u043e\u043f\u043a\u0430 \u043c\u044b\u0448\u0438",desc:"\u0414\u0432\u0438\u0433\u0430\u0442\u044c \u0440\u0430\u0431\u043e\u0447\u0435\u0435 \u043f\u043e\u043b\u0435"}]}},at=n(35);function it(t){var e=t.id,n=t.expanded,r=void 0===n||n,o=t.expandable,s=void 0===o||o,c=t.caption,l=t.font,u=t.noTitle,h=t.wide,d=t.children,f=t.extStyle,p=void 0===f?{}:f,v=Object(a.useState)(r),y=Object(J.a)(v,2),m=y[0],b=y[1];e||(e=Object(a.useId)());var g=m?d:i.a.createElement(i.a.Fragment,null);return i.a.createElement("div",{id:e,className:"".concat(h?"toolbar-wide":"toolbar"," noselect"),style:p},u?i.a.createElement(i.a.Fragment,null):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"".concat(s?"toolbar-header-expandable":"toolbar-header"),style:{fontSize:l},onClick:function(){s&&b(!m)}},i.a.createElement("div",{className:"noselect"},c,"\xa0\xa0")),i.a.createElement("hr",null)),g)}var rt=n(66),ot={VERTEX:"vertex",NUMBER:"NUMBER",POSITIVE_NUMBER:"POSITIVE_NUMBER",INTEGER_POSITIVE_NUMBER:"INTEGER_POSITIVE_NUMBER",BOOL:"BOOL",STRING:"STRING",INPUT:"INPUT",LIST:"LIST"},st={NUMBER:/^-?\d+\.?\d*$/,INTEGER_POSITIVE_NUMBER:/^[1-9]{1}\d*$/,POSITIVE_NUMBER:/^\d+\.?\d*$/,STRING:/.*/},ct=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:-3e3,y:0},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{vertical:e.CENTER,horizontal:e.CENTER};return Object(f.a)(this,e),(t=Object(v.a)(this,Object(m.a)(e).call(this))).p=a,t.controlPoints=[t.p],t.text=n,t.anchor=r,t.angle=i,t.fitRect={width:1e3,height:1e3},t}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a,i,r){Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a),t.save();var o=Object(h.a)({},this.p0),s=this.fitRect,c=s.width,l=s.height,u=this.fitRect.width,d=this.fitRect.height;if(i){t.font="".concat(i,"px serif");var f=this.getTextRect(t,t.font);c=f.width,l=f.height}else{for(i=14;i>5;i-=1){t.font="".concat(i,"px serif");var p=this.getTextRect(t,t.font);if(c=p.width,l=p.height,u>=c&&d>=l)break}this.font=t.font}switch(this.anchor.horizontal){case e.CENTER:o.x=0===this.angle?this.p0.x-c/2:this.p0.x+l/2;break;case e.LEFT:o.x=this.p0.x+5;break;case e.RIGHT:o.x=this.p0.x-c}switch(this.anchor.vertical){case e.CENTER:o.y=0===this.angle?this.p0.y+l/2:this.p0.y+c/2;break;case e.TOP:o.y=0===this.angle?this.p0.y+l:this.p0.x+c;break;case e.BOTTOM:o.y=this.p0.y}var v=k.rotatePoint(o,this.angle,{x:0,y:0});t.translate(o.x-v.x,o.y-v.y),t.rotate(this.angle);var b=r?i/2:0;o.y-=b,t.fillText(this.text,o.x,o.y),t.restore()}},{key:"getTextRect",value:function(t,e){t.font=e;var n=t.measureText(this.text);return{width:n.width,height:n.actualBoundingBoxAscent+n.fontBoundingBoxDescent}}},{key:"getRealTextRect",value:function(t,e,n,a){var i=this.getTextRect(t,e),r=i.width,o=i.height;return{width:r=k.screenToRealLength(r,n.bottomRight.x-n.topLeft.x,a.width),height:o=k.screenToRealLength(o,n.bottomRight.x-n.topLeft.x,a.width)}}},{key:"refresh",value:function(t,e){this.p0=k.realToScreen(this.p,t,e)}},{key:"setFitRect",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.fitRect=Object(h.a)({},t),this.fit=e}},{key:"rotate",value:function(t){this.angle=t}},{key:"getMarkers",value:function(){return[]}},{key:"setText",value:function(t){this.text=t}},{key:"setFont",value:function(t){this.font=t}},{key:"setPoint",value:function(t){this.p=t}},{key:"setAnchor",value:function(t){this.anchor=Object(h.a)({},this.anchor,t)}},{key:"setActivePoint",value:function(t){Object(y.a)(Object(m.a)(e.prototype),"setActivePoint",this).call(this),"P1"===t&&this.selectPoint(0)}},{key:"getProperties",value:function(){return new Map}},{key:"getDistance",value:function(t){return null}},{key:"isInSelectionRect",value:function(t,e){return{cross:!1,full:!1}}},{key:"toString",value:function(){return"Line P1(".concat(this.line.p1.x,",").concat(this.line.p1.y,") P2(").concat(this.line.p2.x,",").concat(this.line.p2.y,")")}}]),e}(V);ct.CENTER=0,ct.LEFT=1,ct.RIGHT=2,ct.TOP=3,ct.BOTTOM=4;var lt={NEW_PROJECT:"NEW_PROJECT",NEW_PROJECT_CONFIRM:"NEW_PROJECT_CONFIRM",SAVE_PROJECT:"SAVE_PROJECT",OPEN_PROJECT:"OPEN_PROJECT",OPEN_FAILURE:"OPEN_FAILURE",SET_PROJECT:"SET_PROJECT",SET_INFORMATION:"SET_INFORMATION",SET_MATERIAL:"SET_MATERIAL",SET_LOADED_MATERIALS:"SET_LOADED_MATERIALS",SET_WARDROBE_DIMENSIONS:"SET_WARDROBE_DIMENSIONS",LOAD_MATERIALS:"LOAD_MATERIALS",SET_DELETE_CONFIRM:"SET_DELETE_CONFIRM",SET_WORKSPACE:"SET_WORKSPACE",UPDATE_STATE:"UPDATE_STATE",updateState:function(){return{type:lt.UPDATE_STATE}},newProject:function(t){return{type:lt.NEW_PROJECT,payload:t}},newProjectConfirm:function(t){return{type:lt.NEW_PROJECT_CONFIRM,payload:t}},saveProject:function(){return{type:lt.SAVE_PROJECT}},openProject:function(){return function(t){var e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=function(e){var n=e.target.files[0],a=new FileReader;a.readAsText(n,"UTF-8"),a.onload=function(n){try{var a=JSON.parse(n.target.result)}catch(e){a={}}t({type:lt.SET_PROJECT,payload:a})}},e.click()}},setInformation:function(t){return{type:lt.SET_INFORMATION,payload:t}},setWardrobeDimensions:function(t){return{type:lt.SET_WARDROBE_DIMENSIONS,payload:t}},setMaterial:function(t){return{type:lt.SET_MATERIAL,payload:t}},setLoadedMaterials:function(t){return{type:lt.SET_LOADED_MATERIALS,payload:t}},setDeleteConfirm:function(t){return{type:lt.SET_DELETE_CONFIRM,payload:t}},setWorkspace:function(t){return{type:lt.SET_WORKSPACE,payload:t}},loadMaterials:function(t){return fetch("/materials",{method:"POST",headers:{"Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(e){t(lt.setLoadedMaterials(e))}).catch(function(t){console.error(t)}),{type:lt.LOAD_MATERIALS}}},ut={DSP:"DSP",MIRROR:"MIRROR",SAND:"SAND",LACOBEL:"LACOBEL"},ht=function(){return[ut.DSP,ut.MIRROR,ut.SAND,ut.LACOBEL]};var dt={LOCK:"LOCK",LOCK_BOTH:"LOCK_BOTH",LOCK_WIDTH:"LOCK_WIDTH",LOCK_HEIGHT:"LOCK_HEIGHT"};function ft(t,e){var n;return(n={},Object(q.a)(n,dt.LOCK,"M".concat(t.x-5," ").concat(t.y,"l0.58 0 0 -1.78c0,-0.91 0.37,-1.74 0.97,-2.34 0.6,-0.6 1.43,-0.97 2.34,-0.97 0.92,0 1.74,0.37 2.34,0.97 0.6,0.6 0.97,1.43 0.97,2.34l0 1.78 0.28 0c0.3,0 0.58,0.13 0.78,0.33 0.2,0.2 0.32,0.47 0.32,0.77l0 6.42c0,0.3 -0.12,0.58 -0.32,0.78 -0.2,0.2 -0.48,0.32 -0.78,0.32l-7.48 0c-0.3,0 -0.58,-0.12 -0.78,-0.32 -0.2,-0.2 -0.32,-0.48 -0.32,-0.78l0 -6.42c0,-0.3 0.12,-0.57 0.32,-0.77 0.2,-0.2 0.48,-0.33 0.78,-0.33zm3.85 2.11c0.59,0 1.07,0.48 1.07,1.06 0,0.48 -0.32,0.89 -0.76,1.02l0.76 2.47 -2.13 0 0.75 -2.47c-0.43,-0.13 -0.75,-0.54 -0.75,-1.02 0,-0.58 0.48,-1.06 1.06,-1.06zm-2.05 -2.11l4.19 0 0 -1.78c0,-0.58 -0.24,-1.1 -0.62,-1.48 -0.37,-0.38 -0.9,-0.62 -1.48,-0.62 -0.58,0 -1.1,0.24 -1.48,0.62 -0.38,0.38 -0.61,0.9 -0.61,1.48l0 1.78zm5.68 0.58l-7.48 0c-0.14,0 -0.28,0.06 -0.37,0.15 -0.1,0.1 -0.16,0.23 -0.16,0.37l0 6.42c0,0.15 0.06,0.28 0.16,0.37 0.09,0.1 0.23,0.16 0.37,0.16l7.48 0c0.15,0 0.28,-0.06 0.37,-0.16 0.1,-0.09 0.16,-0.22 0.16,-0.37l0 -6.42c0,-0.14 -0.06,-0.27 -0.16,-0.37 -0.09,-0.09 -0.22,-0.15 -0.37,-0.15z")),Object(q.a)(n,dt.LOCK_BOTH,"M".concat(t.x-5," ").concat(t.y,"l0.98 0 0 -3.57c0,-1.83 0.75,-3.48 1.94,-4.68 1.21,-1.2 2.86,-1.94 4.69,-1.94 1.82,0 3.48,0.74 4.68,1.94 1.2,1.2 1.94,2.85 1.94,4.68l0 3.57 0.74 0c0.6,0 1.15,0.25 1.55,0.65 0.41,0.4 0.65,0.95 0.65,1.55l0 12.84c0,0.61 -0.24,1.16 -0.64,1.56 -0.41,0.4 -0.96,0.65 -1.56,0.65l-14.97 0c-0.6,0 -1.15,-0.25 -1.55,-0.65 -0.4,-0.4 -0.65,-0.95 -0.65,-1.56l0 -12.84c0,-0.6 0.25,-1.15 0.65,-1.55 0.4,-0.4 0.95,-0.65 1.55,-0.65zm4.27 6.57l-5.01 2.14 5.01 2.14 0 -1.52 2.59 0 0 1.34 -1.52 0 2.14 5 2.14 -5 -1.52 0 0 -1.34 2.49 0 0 1.52 5 -2.14 -5 -2.14 0 1.52 -2.49 0 0 -1.34 1.52 0 -2.14 -5 -2.14 5 1.52 0 0 1.34 -2.59 0 0 -1.52zm-0.86 -6.57l8.39 0 0 -3.57c0,-1.16 -0.47,-2.2 -1.23,-2.96 -0.76,-0.76 -1.81,-1.23 -2.96,-1.23 -1.16,0 -2.21,0.47 -2.97,1.22 -0.76,0.77 -1.23,1.81 -1.23,2.97l0 3.57zm11.56 1.15l-14.97 0c-0.29,0 -0.55,0.12 -0.74,0.31 -0.19,0.19 -0.31,0.45 -0.31,0.74l0 12.84c0,0.3 0.12,0.56 0.31,0.75 0.19,0.19 0.45,0.31 0.74,0.31l14.97 0c0.29,0 0.56,-0.12 0.74,-0.31 0.2,-0.19 0.31,-0.45 0.31,-0.75l0 -12.84c0,-0.29 -0.11,-0.55 -0.3,-0.74 -0.19,-0.19 -0.46,-0.31 -0.75,-0.31z")),Object(q.a)(n,dt.LOCK_WIDTH,"M".concat(t.x-5," ").concat(t.y,"l0.98 0 0 -3.57c0,-1.83 0.75,-3.48 1.94,-4.68 1.21,-1.2 2.86,-1.94 4.69,-1.94 1.82,0 3.48,0.74 4.68,1.94 1.2,1.2 1.94,2.85 1.94,4.68l0 3.57 0.74 0c0.6,0 1.16,0.25 1.55,0.65 0.41,0.4 0.65,0.95 0.65,1.56l0 12.83c0,0.61 -0.24,1.16 -0.64,1.56 -0.4,0.4 -0.96,0.65 -1.56,0.65l-14.97 0c-0.6,0 -1.15,-0.25 -1.55,-0.65 -0.4,-0.4 -0.65,-0.95 -0.65,-1.56l0 -12.83c0,-0.61 0.25,-1.16 0.65,-1.56 0.4,-0.4 0.95,-0.65 1.55,-0.65zm3.41 0l8.39 0 0 -3.57c0,-1.16 -0.47,-2.2 -1.23,-2.96 -0.76,-0.76 -1.81,-1.23 -2.96,-1.23 -1.16,0 -2.21,0.47 -2.97,1.22 -0.76,0.77 -1.23,1.81 -1.23,2.97l0 3.57zm11.56 1.15l-14.97 0c-0.29,0 -0.55,0.12 -0.74,0.31 -0.19,0.19 -0.31,0.45 -0.31,0.75l0 12.83c0,0.3 0.12,0.56 0.31,0.75 0.19,0.19 0.45,0.31 0.74,0.31l14.97 0c0.29,0 0.56,-0.12 0.75,-0.31 0.19,-0.19 0.31,-0.45 0.31,-0.75l0 -12.83c0,-0.3 -0.12,-0.56 -0.31,-0.75 -0.19,-0.19 -0.46,-0.31 -0.75,-0.31zm-4.62 9.87l5 -2.14 -5 -2.14 0 1.52 -5.74 0 0 -1.52 -5 2.14 5 2.14 0 -1.52 5.74 0 0 1.52z")),Object(q.a)(n,dt.LOCK_HEIGHT,"M".concat(t.x-5," ").concat(t.y,"l0.98 0 0 -3.57c0,-1.83 0.75,-3.48 1.94,-4.68 1.21,-1.2 2.86,-1.94 4.69,-1.94 1.82,0 3.48,0.74 4.68,1.94 1.2,1.2 1.94,2.85 1.94,4.68l0 3.57 0.74 0c0.6,0 1.16,0.25 1.55,0.65 0.41,0.4 0.65,0.95 0.65,1.56l0 12.83c0,0.61 -0.24,1.16 -0.64,1.56 -0.4,0.4 -0.96,0.65 -1.56,0.65l-14.97 0c-0.6,0 -1.15,-0.25 -1.55,-0.65 -0.4,-0.4 -0.65,-0.95 -0.65,-1.56l0 -12.83c0,-0.61 0.25,-1.16 0.65,-1.56 0.4,-0.4 0.95,-0.65 1.55,-0.65zm3.41 0l8.39 0 0 -3.57c0,-1.16 -0.47,-2.2 -1.23,-2.96 -0.76,-0.76 -1.81,-1.23 -2.96,-1.23 -1.16,0 -2.21,0.47 -2.97,1.22 -0.76,0.77 -1.23,1.81 -1.23,2.97l0 3.57zm11.56 1.15l-14.97 0c-0.29,0 -0.55,0.12 -0.74,0.31 -0.19,0.19 -0.31,0.45 -0.31,0.75l0 12.83c0,0.3 0.12,0.56 0.31,0.75 0.19,0.19 0.45,0.31 0.74,0.31l14.97 0c0.29,0 0.56,-0.12 0.75,-0.31 0.19,-0.19 0.31,-0.45 0.31,-0.75l0 -12.83c0,-0.3 -0.12,-0.56 -0.31,-0.75 -0.19,-0.19 -0.46,-0.31 -0.75,-0.31zm-5.35 5.6l-2.14 -5 -2.14 5 1.52 0 0 3.83 -1.52 0 2.14 5 2.14 -5 -1.52 0 0 -3.83 1.52 0z")),n)[e]}function pt(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return vt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vt(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var yt=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[""],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:-3e3,y:0},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{vertical:ct.CENTER,horizontal:ct.CENTER};Object(f.a)(this,e),(t=Object(v.a)(this,Object(m.a)(e).call(this))).textShapes=[];var o,s=pt(n);try{for(s.s();!(o=s.n()).done;){var c=o.value;t.textShapes.push(new ct(c,a,i,r))}}catch(l){s.e(l)}finally{s.f()}return t.p=a,t.controlPoints=[t.p],t.text=n,t.anchor=r,t.angle=i,t.fitRect={width:1e3,height:1e3},t}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a,i,r){Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a);var o,s=Object(h.a)({},this.p0),c=this.getTextOffsets(t,i),l=c.width,u=c.height,d=c.offsets,f=c.angle,p=0===f?l/2:u/2,v=0===f?u/2:l/2,b=k.rotatePoint(s,f,{x:0,y:0}),g=0,E=0,w=0,S=pt(this.textShapes);try{for(S.s();!(o=S.n()).done;){var P=o.value;t.save(),t.translate(s.x-b.x-p,s.y-b.y+v),t.rotate(f),t.fillText(P.text,s.x+E,s.y+w),t.restore(),E+=d.width[g],w+=d.height[g],g++}}catch(O){S.e(O)}finally{S.f()}}},{key:"getTextOffsets",value:function(t,e){var n=this.fitRect,a=n.width,i=n.height,r=a,o=i,s=[],c=[],l=[],u=[];for(e=14;e>5;e-=1){var h=this.fitRect;a=h.width,i=h.height,s=[],c=[],l=[],u=[],t.font="".concat(e,"px serif");var d,f=0,p=0,v=0,y=0,m=pt(this.textShapes);try{for(m.s();!(d=m.n()).done;){var b=d.value.getTextRect(t,t.font);a=b.width,i=b.height,f+=a,s.push(a),p=Math.max(p,i),c.push(0),v=Math.max(v,a),l.push(0),y+=i,u.push(i)}}catch(g){m.e(g)}finally{m.f()}if(r>=f&&o>=p)return{width:f,height:p,offsets:{width:s,height:c},angle:0};if(o>=f&&r>=p)return{width:f,height:p,offsets:{width:s,height:c},angle:-Math.PI/2};if(r>=v&&o>=y)return{width:v,height:y,offsets:{width:l,height:u},angle:0};if(o>=v&&r>=y)return{width:v,height:y,offsets:{width:l,height:u},angle:-Math.PI/2}}return{width:a,height:i,offsets:{width:s,height:c}}}},{key:"refresh",value:function(t,e){this.p0=k.realToScreen(this.p,t,e)}},{key:"setFitRect",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.fitRect=Object(h.a)({},t),this.fit=e}},{key:"rotate",value:function(t){this.angle=t}},{key:"setText",value:function(t){var e=0;this.textShapes.forEach(function(n){n.setText(t[e]),e++})}},{key:"setFont",value:function(t){this.font=t,this.textShapes.forEach(function(e){return e.setFont(t)})}},{key:"setPoint",value:function(t){this.p=t,this.textShapes.forEach(function(e){return e.setPoint(t)})}},{key:"setAnchor",value:function(t){this.anchor=Object(h.a)({},this.anchor,t),this.textShapes.forEach(function(e){return e.setAnchor(t)})}}]),e}(V);yt.CENTER=0,yt.LEFT=1,yt.RIGHT=2,yt.TOP=3,yt.BOTTOM=4;var mt=function(t){function e(t){var n;Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this))).type=V.FASADE,n.height=t.height,n.width=t.width,n.level=void 0===t.level?0:t.level,n.parent=t.parent,n.base=void 0===t.base?"":t.base,n.baseColor=void 0===t.baseColor?ut.MIRROR:t.baseColor,0===n.level&&(n.caption=new ct("\u0424\u0410\u0421\u0410\u0414",{x:t.position.x+t.width/2,y:t.position.y-50}));var a=n.parent&&n.parent.divided||e.HOR;n.baseCaption=new yt([n.base," "+n.base+n.base],{x:0,y:0},a===e.HOR?0:-Math.PI/2),n.children=[],n.divided=t.divided,n.minHeight=100,n.minWidth=100,n.name=t.name||"\u0424\u0410\u0421\u0410\u0414",n.state.selectable=void 0===t.selectable||t.selectable,n.state.deletable=void 0===t.deletable||t.deletable,n.state.fixable=n.level>0,n.state.fixedWidth=void 0!==t.fixedWidth&&t.fixedWidth,n.state.fixedHeight=void 0!==t.fixedHeight&&t.fixedHeight;var i=t.position||{x:0,y:0},r={x:i.x+n.width,y:i.y+n.height};return n.rect=Object(h.a)({},i,{last:r,width:n.width,height:n.height}),n.setStyle(new B(H.BLACK,B.SOLID)),n.dimensions=new Set,n.properties=[{key:"name",type:ot.STRING,editable:function(){return!1},getValue:function(){return n.name}},{key:"height",type:ot.INTEGER_POSITIVE_NUMBER,editable:function(){return n.isHeightEditable()},extra:function(){return n.getHeightParts()},getValue:function(){return n.height},setValue:function(t){n.setHeight(t)}},{key:"width",type:ot.INTEGER_POSITIVE_NUMBER,editable:function(){return n.isWidthEditable()},extra:function(){return n.getWidthParts()},getValue:function(){return n.width},setValue:function(t){n.setWidth(t)}},{key:"base",type:ot.LIST,items:function(t){return ht().map(function(e){return t.captions.toolbars.info.materials.fasadBases[e]})},editable:function(){return!n.hasChildren()},getValue:function(t){return n.isCombi()?t.captions.toolbars.info.materials.combi:t.captions.toolbars.info.materials.fasadBases[n.getBase()]},setValue:function(t){n.preSetBase(ht()[t])}},{key:"baseColor",type:ot.LIST,items:function(t){return t.materials[n.base].map(function(t){return t.name})},editable:function(){return!n.hasChildren()},getValue:function(){return n.getBaseColor()},setValue:function(t,e){return n.setBaseColor(e)}}],n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;this.captions=r;var o=Object(h.a)({},this.state);i&&(this.state=Object(h.a)({},this.state,{selected:!1,highlighted:!1})),Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a);var s=k.realToScreen(this.rect,n,a),c=k.realToScreen(this.rect.last,n,a),l=c.x-s.x,u=c.y-s.y,d=s.x,f=s.y;if(t.strokeRect(d,f,l,u),this.caption&&this.caption.draw(t,n,a,14),this.baseCaption&&!this.hasChildren()&&this.baseCaption.draw(t,n,a),!i&&(this.state.fixedWidth||this.state.fixedHeight)){t.lineWidth=1;var p=this.state.fixedWidth&&!this.state.fixedHeight?dt.LOCK_WIDTH:0;p=!this.state.fixedWidth&&this.state.fixedHeight?dt.LOCK_HEIGHT:p,p=this.state.fixedWidth&&this.state.fixedHeight?dt.LOCK_BOTH:p;var v=new Path2D(ft({x:d+l/2,y:f+u/2},p));t.fill(v)}i&&(this.state=Object(h.a)({},o))}},{key:"refresh",value:function(t,e){if(this.rect.height=this.height,this.rect.width=this.width,this.rect.last={x:this.rect.x+this.rect.width,y:this.rect.y+this.rect.height},this.baseCaption){var n=k.realToScreenLength(this.width,t.bottomRight.x-t.topLeft.x,e.width),a=k.realToScreenLength(this.height,t.bottomRight.x-t.topLeft.x,e.width),i=this.captions&&this.captions.toolbars.info.materials.fasadBases[this.base]||this.base,r=this.getBaseColor();this.baseCaption.setText([i," "+r]),this.baseCaption.setFitRect({width:n,height:a}),this.baseCaption.setPoint({x:(this.rect.x+this.rect.last.x)/2,y:(this.rect.y+this.rect.last.y)/2})}}},{key:"fixWidth",value:function(t){this.state.fixable&&(this.state.fixedWidth=t),this.hasChildren()&&this.divided===e.HOR&&this.children.forEach(function(e){return e.fixWidth(t)})}},{key:"fixHeight",value:function(t){this.state.fixable&&(this.state.fixedHeight=t),this.hasChildren()&&this.divided===e.VERT&&this.children.forEach(function(e){return e.fixHeight(t)})}},{key:"getHeightParts",value:function(){var t="";if(this.hasChildren()&&this.divided===e.HOR){var n=this.getProfiles();t=this.children.reduce(function(t,e){var a=n.shift();return t+e.height+(a?"+".concat(a,"+"):"")},""),t=" (".concat(t,")")}return t}},{key:"getWidthParts",value:function(){var t="";if(this.hasChildren()&&this.divided===e.VERT){var n=this.getProfiles();t=this.children.reduce(function(t,e){var a=n.shift();return t+e.width+(a?"+".concat(a,"+"):"")},""),t=" (".concat(t,")")}return t}},{key:"isHeightEditable",value:function(){return 0!==this.level&&(!this.state.fixedHeight&&(this.parent.divided!==e.VERT||this.level>1))}},{key:"isWidthEditable",value:function(){return 0!==this.level&&(!this.state.fixedWidth&&(this.parent.divided!==e.HOR||this.level>1))}},{key:"isCombi",value:function(){var t=this;return this.hasChildren()&&0===this.level&&!this.children.every(function(e){return e.base===t.children[0].base})}},{key:"hasChildren",value:function(){return this.children.length>0}},{key:"deleteAllChildren",value:function(t){this.hasChildren()&&(Ot(this.children).forEach(function(e){t.fasades.delete(e),e.dimensions.forEach(function(e){return t.fasadeDimensions.delete(e)})}),this.children=[])}},{key:"resizeChildrenByHeight",value:function(t){var e=t.initiator,n=t.newInitiatorHeight,a=t.newInitiatorBase,i=t.newParentHeight,r=this.getProfiles({initiator:e,newBase:a}),o=r.reduce(function(t,e){return t+e},0),s=this.children.filter(function(t){return t===e&&n||t.state.fixedHeight}),c=this.children.filter(function(t){return(t!==e||!n)&&!t.state.fixedHeight});if(0===c.length)return!1;for(var l,u=i||this.height,h=s.reduce(function(t,a){return t+(a===e&&n||a.height)},0),d=Math.round((u-h-o)/c.length),f=this.rect.x,p=this.rect.y,v=0,y=this.children,m=0,b=0;b<y.length-1;b++){if(l=y[b]===e?n||d:y[b].height,y[b]===e||y[b].state.fixedHeight||(l=d),!y[b].checkHeight(l))return!1;v+=l+r[b],m+=l+r[b],y[b].savePosition(f,p),p+=v}return l=u-m,!!y.at(-1).checkHeight(l)&&(y.at(-1).savePosition(f,p),!0)}},{key:"resizeChildrenByWidth",value:function(t){var e=t.initiator,n=t.newInitiatorWidth,a=t.newInitiatorBase,i=t.newParentWidth,r=this.getProfiles({initiator:e,newBase:a}),o=r.reduce(function(t,e){return t+e},0),s=this.children.filter(function(t){return t===e&&n||t.state.fixedWidth}),c=this.children.filter(function(t){return(t!==e||!n)&&!t.state.fixedWidth});if(0===c.length)return!1;for(var l,u=i||this.width,h=s.reduce(function(t,a){return t+(a===e&&n||a.width)},0),d=Math.round((u-h-o)/c.length),f=this.rect.x,p=this.rect.y,v=0,y=this.children,m=0,b=0;b<y.length-1;b++){if(l=y[b]===e?n||d:y[b].width,y[b]===e||y[b].state.fixedWidth||(l=d),!y[b].checkWidth(l))return!1;v+=l+r[b],m+=l+r[b],y[b].savePosition(f,p),f+=v}return l=u-m,!!y.at(-1).checkWidth(l)&&(y.at(-1).savePosition(f,p),!0)}},{key:"setHeight",value:function(t){this.parent.divided===e.HOR?this.parent.resizeChildrenByHeight({initiator:this,newInitiatorHeight:t})?this.parent.applyChanges():this.discardChanges():this.parent.parent.resizeChildrenByHeight({initiator:this.parent,newInitiatorHeight:t})?this.parent.parent.applyChanges():this.discardChanges()}},{key:"setWidth",value:function(t){this.parent.divided===e.VERT?this.parent.resizeChildrenByWidth({initiator:this,newInitiatorWidth:t})?this.parent.applyChanges():this.discardChanges():this.parent.parent.resizeChildrenByWidth({initiator:this.parent,newInitiatorWidth:t})?this.parent.parent.applyChanges():this.discardChanges()}},{key:"preSetBase",value:function(t){for(var e=this;e.level>1;)e=e.parent;e.setBase(t)}},{key:"setBase",value:function(t){if(this.hasChildren()&&this.children.forEach(function(e){return e.setBase(t)}),this.parent){if(!(this.parent.divided===e.VERT?this.parent.resizeChildrenByWidth({initiator:this,newInitiatorBase:t}):this.parent.resizeChildrenByHeight({initiator:this,newInitiatorBase:t})))return this.discardChanges();this.savedBase=t,this.parent.applyChanges()}else this.base=t}},{key:"getBase",value:function(){return this.hasChildren()?this.children[0].base:this.base}},{key:"getBaseColor",value:function(){return this.hasChildren()?this.children[0].baseColor:this.baseColor}},{key:"setBaseColor",value:function(t){this.baseColor=t,this.hasChildren()&&this.children.forEach(function(e){return e.setBaseColor(t)})}},{key:"checkHeight",value:function(t){if(t<this.minHeight)return!1;if(this.state.fixedHeight&&t!==this.height)return!1;if(this.hasChildren()){if(this.divided===e.HOR){var n=this.resizeChildrenByHeight({newParentHeight:t});return n&&(this.savedHeight=t),n}if(this.children.some(function(e){return!e.checkHeight(t)}))return!1}return this.savedHeight=t,!0}},{key:"checkWidth",value:function(t){if(t<this.minWidth)return!1;if(this.state.fixedWidth&&t!==this.width)return!1;if(this.hasChildren()){if(this.divided===e.VERT){var n=this.resizeChildrenByWidth({newParentWidth:t});return n&&(this.savedWidth=t),n}if(this.children.some(function(e){return!e.checkWidth(t)}))return!1}return this.savedWidth=t,!0}},{key:"applyChanges",value:function(){this.savedBase&&(this.base=this.savedBase),this.savedWidth&&(this.width=this.savedWidth),this.savedHeight&&(this.height=this.savedHeight),this.savedHeight=null,this.savedWidth=null,this.savedBase=null;var t=this.rect.x,n=this.rect.y;if(this.hasChildren()){for(var a,i,r=0;r<this.children.length-1;r++){var o=this.children[r],s=this.children[r+1],c=Pt(o.base,s.base);a=o.savedWidth||o.width,i=o.savedHeight||o.height,o.setPosition(t,n,{width:a,height:i}),this.divided===e.VERT?t+=a+c:n+=i+c,o.applyChanges()}a=this.children.at(-1).savedWidth||this.children.at(-1).width,i=this.children.at(-1).savedHeight||this.children.at(-1).height,this.children.at(-1).setPosition(t,n,{width:a,height:i}),this.children.at(-1).applyChanges()}}},{key:"discardChanges",value:function(){this.savedHeight=null,this.savedWidth=null,this.savedBase=null}},{key:"getProfiles",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.initiator,n=t.newBase,a=void 0===n?e&&e.base:n,i=[],r=0;r<this.children.length-1;r++){var o=this.children[r]===e&&a||this.children[r].base,s=this.children[r+1]===e&&a||this.children[r+1].base;i.push(Pt(o,s))}return i}},{key:"getProperties",value:function(){return Object(y.a)(Object(m.a)(e.prototype),"getProperties",this).call(this)}},{key:"savePosition",value:function(t,e){this.savedPosition={x:t,y:e}}},{key:"setPosition",value:function(t,e,n){var a=n.width,i=void 0===a?0:a,r=n.height,o=void 0===r?0:r;this.rect.x=t,this.rect.y=e,this.rect.last={x:t+i||this.width,y:e+o||this.height}}},{key:"getPosition",value:function(){return this.rect}},{key:"setHidden",value:function(t){this.state.hidden=t}},{key:"getSingleDimensionData",value:function(t){var e=t?{x:this.rect.x+this.width/2,y:this.rect.y}:{x:this.rect.x,y:this.rect.y+this.height/2},n=t?{x:this.rect.x+this.width/2,y:this.rect.last.y}:{x:this.rect.last.x,y:this.rect.last.y-this.height/2};return{firstPoint:e,secondPoint:n,midPoint:{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}}},{key:"isInSelectionRect",value:function(t){var e=t.topLeft,n=t.bottomRight,a=[k.pointInRect(this.rect,e,n),k.pointInRect(this.rect.last,e,n)].every(function(t){return!0===t});return{cross:T.RectangleRectangle(e,n,this.rect,this.rect.last).length>0,full:a}}},{key:"isUnderCursor",value:function(t,e){return t.x>=this.rect.x-1*e&&t.x<=this.rect.x+this.rect.width+1*e&&t.y>=this.rect.y-1*e&&t.y<=this.rect.y+this.rect.height+1*e}}]),e}(V);function bt(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}mt.VERT="vert",mt.HOR="hor";var Et=function(t){function e(){return Object(f.a)(this,e),Object(v.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(p.a)(e,[{key:"add",value:function(t){var n=Object(y.a)(Object(m.a)(e.prototype),"add",this).call(this,t);return t&&t.onAddToSelection&&t.onAddToSelection(n),n}},{key:"delete",value:function(t){var n=Object(y.a)(Object(m.a)(e.prototype),"delete",this).call(this,t);return t&&t.onDeleteFromSelection&&t.onDeleteFromSelection(n),n}},{key:"has",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"has",this).call(this,t)}},{key:"clear",value:function(){var t,n=bt(this);try{for(n.s();!(t=n.n()).done;){var a=t.value;a.onDeleteFromSelection&&a.onDeleteFromSelection()}}catch(i){n.e(i)}finally{n.f()}return Object(y.a)(Object(m.a)(e.prototype),"clear",this).call(this)}}]),e}(Object(rt.a)(Set));function wt(t,e){return(e.vertical?(t.y-e.rect.last.y)*(t.y-e.rect.y):(t.x-e.rect.last.x)*(t.x-e.rect.x))<=0}function St(t,e){return(t.vertical?Math.max(t.rect.last.y,e.rect.last.y)-Math.min(t.rect.y,e.rect.y):Math.max(t.rect.last.x,e.rect.last.x)-Math.min(t.rect.x,e.rect.x))<=t.length+e.length}function Pt(t,e){return t===ut.DSP&&e===ut.DSP?1:3}function Ot(t){function e(t){var n,a=new Set,i=bt(t.children);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.hasChildren()?(e(r).forEach(function(t){return a.add(t)}),r.children=[],r.state.selectable=!0):a.add(r)}}catch(o){i.e(o)}finally{i.f()}return a.add(t),a}var n,a=new Set,i=bt(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.type===V.FASADE){var o,s=bt(r.parent.children);try{for(s.s();!(o=s.n()).done;){var c=o.value;c.hasChildren()?(e(c).forEach(function(t){return a.add(t)}),c.children=[],c.state.selectable=!0):a.add(c)}}catch(l){s.e(l)}finally{s.f()}r.parent.children=[],r.parent.state.selectable=!0}}}catch(l){i.e(l)}finally{i.f()}return a}function xt(t,e){var n=Object(d.a)(t);return n.sort(function(t,n){return e.has(n)?-1:1}),new Set(n)}function Dt(t,e){t.jointFromBackSide.forEach(function(t){e.add(t),Dt(t,e)}),t.jointFromFrontSide.forEach(function(t){e.add(t),Dt(t,e)})}function Tt(t,e,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},r=n.vertical;if(!(0===t&&r||0===e&&!r)){var o=Array.from(a).filter(function(t){return t.vertical===r&&t.type!==V.DIMENSION});r?o.sort(function(e,n){return t<0?e.rect.x-n.rect.x:n.rect.x-e.rect.x}):o.sort(function(t,n){return e<0?t.rect.y-n.rect.y:n.rect.y-t.rect.y});var s,c,l=1e6,u=1e6,h=bt(o);try{for(h.s();!(c=h.n()).done;){var d=c.value,f=d.moveTo(t,e,i,!0,s);r&&Math.abs(f.newDX)<Math.abs(l)&&(l=f.newDX),!r&&Math.abs(f.newDY)<Math.abs(u)&&(u=f.newDY),s=d}}catch(y){h.e(y)}finally{h.f()}var p,v=bt(o);try{for(v.s();!(p=v.n()).done;){p.value.moveTo(l,u,i)}}catch(y){v.e(y)}finally{v.f()}}}function kt(t,e){var n=function(t){var e,n=0,a=0,i=bt(t.panels);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.vertical?n=r.rect.last.x>n?r.rect.last.x:n:a=r.rect.last.y>a?r.rect.last.y:a}}catch(o){i.e(o)}finally{i.f()}return{maxX:n,maxY:a}}(t),a=n.maxX,i=n.maxY;e.setWardrobeDimensions({width:a,height:i})}function jt(t){var e,n=t.wardrobe,a=n.width,i={topLeft:{x:0,y:n.height},bottomRight:{x:a,y:0}},r=bt(t.workspace===Te.CORPUS?t.dimensions:t.fasadeDimensions);try{for(r.s();!(e=r.n()).done;){var o=e.value,s=o.getPosition(),c=s.x,l=s.y;o.vertical?(c<i.topLeft.x&&(i.topLeft.x=c),c>i.bottomRight.x&&(i.bottomRight.x=c)):(l<i.bottomRight.y&&(i.bottomRight.y=l),l>i.topLeft.y&&(i.topLeft.y=l))}}catch(u){r.e(u)}finally{r.f()}return i.topLeft.x-=150,i.topLeft.y+=150,i.bottomRight.x+=150,i.bottomRight.y-=100,i}function Rt(t){var e=t.viewPortData,n=t.setViewPortData,r=(t.appActions,t.appData),o=t.eventHandlers,s=function(t,e){return t?{onPointerMove:function(t){e.onPointerMove(t)},onPointerDown:function(t){e.onPointerDown(t)},onPointerUp:function(t){e.onPointerUp(t)},onPointerLeave:function(t){e.onPointerLeave(t)},onPointerEnter:function(t){e.onPointerEnter(t)},onPointerCancel:function(t){e.onPointerUp(t)}}:{onMouseMove:function(t){e.onPointerMove(t)},onMouseDown:function(t){e.onPointerDown(t)},onMouseUp:function(t){e.onPointerUp(t)},onMouseLeave:function(t){e.onPointerLeave(t)},onMouseEnter:function(t){e.onPointerEnter(t)}}}(r.isMobile,o),c=Object(a.useRef)();Object(a.useEffect)(function(){Ae(c.current.getContext("2d"),e,r)},[r,e]),Object(a.useLayoutEffect)(function(){window.KEYDOWNHANDLE=!0,c.current.addEventListener("wheel",function(t){o.onMouseWheel(t),t.preventDefault()}),function(t,e,n,a){document.getElementById("spinner").style.display="none";var i=M(0,e,a),r=i.sw,o=i.sh;e(function(t){return _(r,o,1e4,t)}),document.body.oncontextmenu=function(){return!0},document.addEventListener("load",function(){}),window.addEventListener("resize",function(){M(0,e,a)}),window.addEventListener("scroll",function(){if(window.scrollY>=10){document.getElementById("goTop").style.display="block";var t=document.getElementById("goTop").addEventListener("click",function(e){window.scrollTo({top:0,behavior:"smooth"}),e.target.removeEventListener("click",t)})}window.scrollY<10&&(document.getElementById("goTop").style.display="none")})}(0,n,0,c.current)},[]),Object(a.useEffect)(function(){var t=jt(r);n(function(e){return N(Object(h.a)({},t),e)})},[r.resetView]);var l=function(t,e){var n=Object(a.useRef)(0),i=Object(a.useRef)();return function(a){0===n.current?(i.current=performance.now(),n.current++):(performance.now()-i.current<200&&e(a),n.current=0),t.onClick(a)}}(o,function(t){return o.onDoubleClick(t)});return i.a.createElement(it,{id:"canvas-container",noTitle:!0,wide:!1},i.a.createElement("canvas",Object.assign({ref:c,id:"canvas",style:{width:"".concat(e.viewPortWidth,"px"),height:"".concat(e.viewPortHeight,"px"),cursor:"none"},width:e.viewPortWidth,height:e.viewPortHeight},s,{onClick:l,onDoubleClick:function(t){o.onDoubleClick(t)},onContextMenu:function(t){t.preventDefault()}})))}var At=function(){function t(){Object(f.a)(this,t)}return Object(p.a)(t,[{key:"keyPress",value:function(t,e){e.handler.keypress(t.code)&&t.target===document.body&&t.preventDefault()}},{key:"keyUp",value:function(t,e){e.appData}},{key:"keyDown",value:function(t,e){e.appData,e.appActions;window.KEYDOWNHANDLE}}]),t}(),Ct=function(t){function e(){return Object(f.a)(this,e),Object(v.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(p.a)(e,[{key:"keyPress",value:function(t,n){var a=n.handler;Object(y.a)(Object(m.a)(e.prototype),"keyPress",this).call(this,t,{handler:a})}},{key:"keyUp",value:function(t,n){n.appData;Object(y.a)(Object(m.a)(e.prototype),"keyUp",this).call(this,t)}},{key:"keyDown",value:function(t,n){var a=n.appData,i=n.appActions;Object(y.a)(Object(m.a)(e.prototype),"keyDown",this).call(this,t,{appData:a,appActions:i})||i.cancel()}}]),e}(At),Lt=[{ctrlKey:!1,shiftKey:!1,altKey:!1,keyCode:46,handler:function(t){function e(){return Object(f.a)(this,e),Object(v.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(p.a)(e,[{key:"keyPress",value:function(t,n){var a=n.handler;Object(y.a)(Object(m.a)(e.prototype),"keyPress",this).call(this,t,{handler:a})}},{key:"keyUp",value:function(t,n){n.appData;Object(y.a)(Object(m.a)(e.prototype),"keyUp",this).call(this,t)}},{key:"keyDown",value:function(t,n){var a=n.appData,i=n.appActions;if(!Object(y.a)(Object(m.a)(e.prototype),"keyDown",this).call(this,t,{appData:a,appActions:i})){var r=function(t){var e,n=[],a=[],i=!1,r=!1,o=bt(t);try{for(o.s();!(e=o.n()).done;){var s=e.value;s.state.deletable||(r=!0),s.state.fixable||(i=!0),s.type!==V.PANEL&&s.type!==V.DRAWER||n.push(s),s.type===V.DIMENSION&&a.push(s)}}catch(l){o.e(l)}finally{o.f()}n.length+a.length===0&&(i=!0,r=!0);var c=n.find(function(t){return t.jointFromBackSide.size>0||t.jointFromFrontSide.size>0});return{canBeDeleted:!r,canBeFixed:!i,panelCount:n.length,firstSelected:n[0],dimensionCount:a.length,isJoints:c}}(a.selectedPanels),o=r.canBeDeleted,s=r.isJoints;o&&(a.workspace===Te.CORPUS?i.deleteSelectedConfirm({isJoints:s}):i.deleteSelectedFasadesConfirm())}}}]),e}(At)},{ctrlKey:!1,shiftKey:!1,altKey:!1,keyCode:27,handler:Ct}];var It=function(){function t(){Object(f.a)(this,t),this.touches=[],this.prevDiff=-1}return Object(p.a)(t,[{key:"addTouchEvent",value:function(t){this.touches.push(t)}},{key:"removeTouchEvent",value:function(t){var e=this.touches.findIndex(function(e){return e.pointerId===t});e>=0&&this.touches.splice(e,1),this.prevDiff=-1}},{key:"setPoint",value:function(t,e){var n=this.touches.findIndex(function(e){return e.pointerId===t});n>=0&&(this.touches[n].curPoint=e)}},{key:"getTouchCount",value:function(){return this.touches.length}}]),t}(),_t={SET_LANGUAGE:"SET_LANGUAGE",REQUEST_LANGUAGE:"REQUEST_LANGUAGE",SHOW_HELP:"SHOW_HELP",SHOW_CONFIRM:"SHOW_CONFIRM",SHOW_ALERT:"SHOW_ALERT",SHOW_DIALOG:"SHOW_DIALOG",setLanguage:function(t){return{type:_t.SET_LANGUAGE,payload:t}},requestLanguage:function(t){return function(e){fetch("/lang",{method:"POST",body:JSON.stringify({lang:t}),headers:{"Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(t){return e(_t.setLanguage(t))}).catch(function(t){console.error(t)})}},showHelp:function(t){return{type:_t.SHOW_HELP,payload:t}},showConfirm:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{type:_t.SHOW_CONFIRM,payload:{show:t,messageKey:e,actions:n}}},showAlert:function(t,e){return{type:_t.SHOW_ALERT,payload:{show:t,message:e}}},showDialog:function(t,e){return{type:_t.SHOW_DIALOG,payload:{show:t,dialog:e}}},blink:function(){var t=document.querySelector(".modal-container > .toolbar-modal"),e=t.style.backgroundColor,n=0,a=setInterval(function(){t.style.backgroundColor===e?t.style.backgroundColor="red":t.style.backgroundColor=e,++n>3&&(clearInterval(a),t.style.backgroundColor=e)},10)}},Nt={TOUCH_DOWN:"TOUCH_DOWN",TOUCH_UP:"TOUCH_UP",TOUCH_MOVE:"TOUCH_MOVE",TOUCH_CANCEL:"TOUCH_CANCEL",LOG:"LOG",touchDown:function(){return{type:"TOUCH_DOWN",payload:{}}},touchUp:function(){return{type:"TOUCH_UP",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0}},touchMove:function(){return{type:"TOUCH_MOVE"}},touchCancel:function(){return{type:"TOUCH_CANCEL"}},log:function(t){return{type:"LOG",payload:t}}},Mt={ADD_PANEL:"ADD_PANEL",CANCEL:"CANCEL",CANCEL_SELECTION:"CANCEL_SELECTION",DELETE_CONFIRM:"DELETE_CONFIRM",FLIP_ORIENTATION:"FLIP_ORIENTATION",PAN_SCREEN:"PAN_SCREEN",PRINT:"PRINT",REPAINT:"REPAINT",RESET_VIEW:"RESET_VIEW",SELECT_ALL:"SELECT_ALL",SELECT_PANEL:"SELECT_PANEL",SET_CURSOR:"SET_CURSOR",SET_CUR_COORD:"SET_CUR_COORD",SET_DIMENSIONS:"SET_DIMENSIONS",SET_PREV_STATUS:"SET_PREV_STATUS",SET_RATIO:"SET_RATIO",SET_REAL_WIDTH:"SET_REAL_WIDTH",SET_SCALE:"SET_SCALE",SET_SNAP:"SET_SNAP",SET_STATUS:"SET_STATUS",SET_TOP_LEFT:"SET_TOP_LEFT",START_SELECTION:"START_SELECTION",STOP_SELECTION:"STOP_SELECTION",addShape:function(t){return{type:Mt.ADD_PANEL,payload:t}},cancel:function(){return{type:Mt.CANCEL}},cancelSelection:function(){return{type:Mt.CANCEL_SELECTION}},deleteConfirm:function(){return{type:Mt.DELETE_CONFIRM}},print:function(t){var e=t.save;return{type:Mt.PRINT,payload:e}},repaint:function(){return{type:Mt.REPAINT}},resetView:function(){return{type:Mt.RESET_VIEW}},selectPanels:function(t){return{type:Mt.SELECT_PANEL,payload:t}},setCursor:function(t){return{type:Mt.SET_CURSOR,payload:t}},setCurCoord:function(t,e){return{type:Mt.SET_CUR_COORD,payload:{point:t,screenPoint:e}}},setDimensions:function(t,e,n,a){return{type:Mt.SET_DIMENSIONS,payload:{width:t,height:e,realWidth:n,topLeft:a}}},setPrevStatus:function(){return{type:Mt.SET_PREV_STATUS}},setRatio:function(t){return{type:Mt.SET_RATIO,payload:t}},setRealWidth:function(t){return{type:Mt.SET_REAL_WIDTH,payload:t}},setScale:function(t,e){return{type:Mt.SET_SCALE,payload:{scale:t,anchor:e}}},setScreenStatus:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K.FREE,e=arguments.length>1?arguments[1]:void 0,n=null,a=null;switch(t){case K.SELECT:a=Mt.START_SELECTION;break;case K.CREATE:a=Mt.CREATE_PANEL,n={creator:e.creator};break;case K.CANCEL:a=Mt.CANCEL;break;case K.PAN:a=Mt.PAN_SCREEN,n=e}return{type:a,payload:n}},setTopLeft:function(t){return{type:Mt.SET_TOP_LEFT,payload:t}},startSelection:function(t,e){return{type:Mt.START_SELECTION,payload:{point:t,handler:e}}},stopSelection:function(t,e){return{type:Mt.STOP_SELECTION,payload:{isSelectedPanels:t,handler:e}}}},Ft={ADD_DIMENSION:"ADD_DIMENSION",ADD_FASADE_DIMENSION:"ADD_FASADE_DIMENSION",CREATE_DRAWER:"CREATE_DRAWER",CREATE_DRAWERBLOCK:"CREATE_DRAWERBLOCK",CREATE_PANEL:"CREATE_PANEL",CREATE_FASADE_DIMENSION:"CREATE_FASADE_DIMENSION",CREATE_SINGLE_DIMENSION:"CREATE_SINGLE_DIMENSION",CREATE_TWO_PANEL_DIMENSION:"CREATE_TWO_PANEL_DIMENSION",CREATE_TUBE:"CREATE_TUBE",DELETE_SELECTED:"DELETE_SELECTED",DELETE_SELECTED_CONFIRM:"DELETE_SELECTED_CONFIRM",DELETE_SELECTED_FASADES:"DELETE_SELECTED_FASADES",DELETE_SELECTED_FASADES_CONFIRM:"DELETE_SELECTED_FASADES_CONFIRM",DISTRIBUTE:"DISTRIBUTE",DIVIDE_FASAD_HOR:"DIVIDE_FASAD_HOR",DIVIDE_FASAD_VERT:"DIVIDE_FASAD_VERT",FIX_MIN_LENGTH:"FIX_MIN_LENGTH",FIX_MAX_LENGTH:"FIX_MAX_LENGTH",FIX_WIDTH:"FIX_WIDTH",FIX_HEIGHT:"FIX_HEIGHT",MOVE_PANEL:"MOVE_PANEL",SELECT_PANEL:"SELECT_PANEL",SELECT_PARENT:"SELECT_PARENT",SET_PANEL_STATE:"SET_PANEL_STATE",SET_PROPERTY:"SET_PROPERTY",addDimension:function(t){return{type:Ft.ADD_DIMENSION,payload:t}},addFasadeDimension:function(t){return{type:Ft.ADD_FASADE_DIMENSION,payload:t}},createDrawer:function(){return{type:Ft.CREATE_DRAWER}},createDrawerBlock:function(){return{type:Ft.CREATE_DRAWERBLOCK}},createPanel:function(t){return{type:Ft.CREATE_PANEL,payload:t}},createFasadeDimension:function(t){return{type:Ft.CREATE_FASADE_DIMENSION,payload:t}},createSingleDimension:function(){return{type:Ft.CREATE_SINGLE_DIMENSION}},createTwoPanelDimension:function(t){var e=t.inside;return{type:Ft.CREATE_TWO_PANEL_DIMENSION,payload:{inside:e}}},createTube:function(){return{type:Ft.CREATE_TUBE}},deleteSelected:function(){return{type:Ft.DELETE_SELECTED}},deleteSelectedConfirm:function(t){var e=t.isJoints;return{type:Ft.DELETE_SELECTED_CONFIRM,payload:{isJoints:e}}},deleteSelectedFasades:function(){return{type:Ft.DELETE_SELECTED_FASADES}},deleteSelectedFasadesConfirm:function(){return{type:Ft.DELETE_SELECTED_FASADES_CONFIRM}},distribute:function(){return{type:Ft.DISTRIBUTE}},divideFasadHor:function(t){return{type:Ft.DIVIDE_FASAD_HOR,payload:t}},divideFasadVert:function(t){return{type:Ft.DIVIDE_FASAD_VERT,payload:t}},fixMinLength:function(t){return{type:Ft.FIX_MIN_LENGTH,payload:t}},fixMaxLength:function(t){return{type:Ft.FIX_MAX_LENGTH,payload:t}},fixWidth:function(t){return{type:Ft.FIX_WIDTH,payload:t}},fixHeight:function(t){return{type:Ft.FIX_HEIGHT,payload:t}},movePanel:function(t,e){return{type:Ft.MOVE_PANEL,payload:{panel:t,movePoint:e}}},selectParent:function(t){return{type:Ft.SELECT_PARENT,payload:t}},setPanelState:function(t){return{type:Ft.SET_PANEL_STATE,payload:t}},setProperty:function(t,e){return{type:Ft.SET_PROPERTY,payload:{key:t,value:e}}}},Ht={SET_TOKEN:"SET_TOKEN",LOGOUT:"LOGOUT",ACTIVATE:"ACTIVATE",setToken:function(t,e){return{type:"SET_TOKEN",payload:{token:t,remember:e}}},logout:function(){return{type:"LOGOUT"}},activate:function(){return{type:"ACTIVATE"}}};function Bt(){return t=Object(c.b)(),{log:function(e){return t(Nt.log(e))},touchDown:function(){return t(Nt.touchDown())},touchUp:function(e){return t(Nt.touchUp(e))},touchMove:function(){return t(Nt.touchMove())},touchCancel:function(){return t(Nt.touchCancel())},activate:function(){return t(Ht.activate())},addDimension:function(e){return t(Ft.addDimension(e))},addFasadeDimension:function(e){return t(Ft.addFasadeDimension(e))},addShape:function(e){return t(Mt.addShape(e))},cancel:function(){return t(Mt.cancel())},createDrawer:function(){return t(Ft.createDrawer())},createDrawerBlock:function(){return t(Ft.createDrawerBlock())},createPanel:function(e){return t(Ft.createPanel(e))},createFasadeDimension:function(e){return t(Ft.createFasadeDimension(e))},createSingleDimension:function(){return t(Ft.createSingleDimension())},createTwoPanelDimension:function(e){var n=e.inside;return t(Ft.createTwoPanelDimension({inside:n}))},createTube:function(){return t(Ft.createTube())},deleteSelected:function(){return t(Ft.deleteSelected())},deleteSelectedConfirm:function(e){var n=e.isJoints;return t(Ft.deleteSelectedConfirm({isJoints:n}))},deleteSelectedFasades:function(){return t(Ft.deleteSelectedFasades())},deleteSelectedFasadesConfirm:function(){return t(Ft.deleteSelectedFasadesConfirm())},divideFasadHor:function(e){return t(Ft.divideFasadHor(e))},divideFasadVert:function(e){return t(Ft.divideFasadVert(e))},distribute:function(){return t(Ft.distribute())},fixMinLength:function(e){return t(Ft.fixMinLength(e))},fixMaxLength:function(e){return t(Ft.fixMaxLength(e))},fixWidth:function(e){return t(Ft.fixWidth(e))},fixHeight:function(e){return t(Ft.fixHeight(e))},loadMaterials:function(){return t(lt.loadMaterials(t))},logout:function(){return t(Ht.logout())},movePanel:function(e,n){return t(Ft.movePanel(e,n))},open:function(){return t(lt.openProject())},newProjectConfirm:function(e){return t(lt.newProjectConfirm(e))},newProject:function(e){return t(lt.newProject(e))},print:function(e){var n=e.save;return t(Mt.print({save:n}))},resetView:function(){return t(Mt.resetView())},requestLanguage:function(e){return t(_t.requestLanguage(e))},save:function(){return t(lt.saveProject())},selectParent:function(e){return t(Ft.selectParent(e))},setCursor:function(e){return t(Mt.setCursor(e))},setDeleteConfirm:function(e){return t(lt.setDeleteConfirm(e))},setInformation:function(e){return t(lt.setInformation(e))},setLanguage:function(e){return t(_t.setLanguage(e))},setMaterial:function(e){return t(lt.setMaterial(e))},setLoadedMaterials:function(e){return t(lt.setLoadedMaterials(e))},setPanelState:function(e){return t(Ft.setPanelState(e))},setPrevStatus:function(){return t(Mt.setPrevStatus())},setProperty:function(e,n){return t(Ft.setProperty(e,n))},setRealWidth:function(e){return t(Mt.setRealWidth(e))},setScale:function(e,n){return t(Mt.setScale(e,n))},setScreenStatus:function(e,n){return t(Mt.setScreenStatus(e,n))},setToken:function(e,n){return t(Ht.setToken(e,n))},setWardrobeDimensions:function(e){return t(lt.setWardrobeDimensions(e))},setWorkspace:function(e){return t(lt.setWorkspace(e))},showAlert:function(e,n){return t(_t.showAlert(e,n))},showConfirm:function(e,n,a){return t(_t.showConfirm(e,n,a))},showDialog:function(e,n){return t(_t.showDialog(e,n))},showHelp:function(e){return t(_t.showHelp(e))},startSelection:function(e,n){return t(Mt.startSelection(e,n))},stopSelection:function(e,n){return t(Mt.stopSelection(e,n))},updateState:function(){return t(lt.updateState())}};var t}function Vt(){return{curRealPoint:{x:0,y:0},curCanvasPoint:{x:225,y:225},gridStep:10,gridStepPixels:1,marginTop:0,marginLeft:0,marginBottom:0,marginRight:0,ratio:1,pixelRatio:1,realWidth:3e3,realHeight:2600,viewPortHeight:400,viewPortWidth:550,selectDist:2,snapDist:20,snapMinDist:10,topLeft:{x:-5e3,y:2500},bottomRight:{x:2500,y:-100},touchManager:new It}}var Wt=Vt();function Ut(){var t=Object(a.useState)(Wt),e=Object(J.a)(t,2),n=e[0],r=e[1],o=Object(a.useRef)(),s=Object(a.useRef)(),l=Object(c.c)(function(t){return t});s.current=l;var u=Bt(),h=l.mouseHandler;o.current={mouseHandler:h,viewPortData:n,setViewPortData:r,appActions:u,appData:l},Object(a.useEffect)(function(){window.addEventListener("keypress",function(t){!function(t,e){e.mouseHandler.keypress(t.code)&&t.target===document.body&&t.preventDefault()}(t,{mouseHandler:h})}),window.addEventListener("keydown",function(t){!function(t,e){var n=e.appData,a=e.appActions;!1!==window.KEYDOWNHANDLE&&(n.cursor.setAdditional({shiftKey:t.shiftKey,altKey:t.altKey}),Lt.forEach(function(e){t.ctrlKey===e.ctrlKey&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.keyCode===e.keyCode&&((new e.handler).keyDown(t,{appData:n,appActions:a}),t.preventDefault())}))}(t,{appData:s.current,appActions:u})}),window.addEventListener("keyup",function(t){}),u.loadMaterials(),u.newProjectConfirm(!0)},[]);var d={onPointerMove:function(t){!function(t,e){var n=e.mouseHandler,a=e.viewPortData,i=e.setViewPortData,r=e.appActions,o=e.appData,s=j(t);"touch"===t.pointerType?n.touchMove({pointerId:t.pointerId,curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o}):n.move({curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o,keys:{shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey}})}(t,o.current)},onPointerDown:function(t){!function(t,e){var n=e.mouseHandler,a=e.viewPortData,i=e.setViewPortData,r=e.appActions,o=e.appData,s=j(t);t.preventDefault(),"touch"===t.pointerType?n.touchDown({pointerId:t.pointerId,curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o}):n.down({button:t.button,curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o,keys:{shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey}})}(t,o.current)},onPointerUp:function(t){!function(t,e){var n=e.mouseHandler,a=e.viewPortData,i=e.setViewPortData,r=e.appActions,o=e.appData,s=j(t);"touch"===t.pointerType?n.touchUp({pointerId:t.pointerId,curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o}):n.up({button:t.button,curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o})}(t,o.current)},onMouseWheel:function(t){!function(t,e){var n=e.mouseHandler,a=e.viewPortData,i=e.setViewPortData,r=e.appActions,o=j(t);n.wheel({deltaY:t.deltaY,curPoint:o,viewPortData:a,setViewPortData:i,appActions:r,keys:{shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey}}),t.preventDefault()}(t,o.current)},onPointerLeave:function(t){!function(t,e){var n=e.mouseHandler,a=e.viewPortData,i=e.setViewPortData,r=e.appActions,o=e.appData;"touch"===t.pointerType?n.touchUp({pointerId:t.pointerId,viewPortData:a,setViewPortData:i,appActions:r,appData:o}):n.leave({viewPortData:a,appActions:r})}(t,o.current)},onPointerEnter:function(t){var e;(e=o.current).mouseHandler,e.viewPortData,e.setViewPortData,e.appActions,e.appData},onClick:function(t){!function(t,e){var n=e.mouseHandler,a=e.viewPortData,i=e.setViewPortData,r=e.appActions,o=e.appData,s=j(t);t.preventDefault(),n.click({button:t.button,curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o,keys:{shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey}})}(t,o.current)},onDoubleClick:function(t){!function(t,e){var n=e.mouseHandler,a=e.viewPortData,i=e.setViewPortData,r=e.appActions,o=e.appData,s=j(t);"touch"===t.pointerType?n.doubleClick({button:0,curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o,keys:{shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey}}):n.doubleClick({button:t.button,curPoint:s,viewPortData:a,setViewPortData:i,appActions:r,appData:o,keys:{shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,altKey:t.altKey}})}(t,o.current)}};return i.a.createElement(Rt,{appData:l,appActions:u,viewPortData:n,setViewPortData:r,eventHandlers:d})}function Kt(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gt(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var zt=function(t){function e(t){var n;Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this))).type=V.PANEL,n.gabarit=t.gabarit,n.length=t.length,n.width=t.gabarit?t.wardrobe.depth:t.wardrobe.depth-100,n.panelMargin=t.panelMargin||0,t.active||(n.active=!1),n.vertical=t.vertical,n.name=t.name||(n.vertical?"\u0421\u0442\u043e\u0439\u043a\u0430 \u0432\u043d\u0443\u0442\u0440":"\u041f\u043e\u043b\u043a\u0430"),n.defaultMinLength=t.minLength||282,n.defaultMaxLength=t.maxLength||1e7,n.minLength=n.defaultMinLength,n.maxLength=n.defaultMaxLength,n.state.selectable=void 0===t.selectable||t.selectable,n.state.deletable=void 0===t.deletable||t.deletable,n.state.fixable=void 0===t.fixable||t.fixable,n.state.fixed_move=void 0!==t.fixed_move&&t.fixed_move,n.state.fixedLength=void 0===t.fixedLength?{min:!1,max:!1}:t.fixedLength,n.state.resizable=void 0===t.resizable||t.resizable,n.state.measurable=void 0===t.measurable||t.measurable,n.state.drillable=void 0===t.drillable||t.drillable,n.nodrill=void 0!==t.nodrill&&t.nodrill,n.state.blocked=void 0!==t.blocked&&t.fixed,n.state.hidden=t.hidden,n.thickness=t.thickness||16;var a=t.position||{x:0,y:0},i=t.vertical?n.thickness:t.length,r=t.vertical?t.length:n.thickness,o={x:a.x+i,y:a.y+r};return n.rect=Object(h.a)({},a,{last:o,w:i,h:r}),n.setStyle(new B(H.BLACK,B.SOLID)),n.jointFromBackSide=t.jointFromBackSide||new Set,n.jointFromFrontSide=t.jointFromFrontSide||new Set,n.parallelFromBack=t.parallelFromBack||new Set,n.parallelFromFront=t.parallelFromFront||new Set,n.dimensions=new Set,n.properties=[{key:"name",type:ot.STRING,editable:!0,setValue:function(t){n.name=t}},{key:"length",type:ot.INTEGER_POSITIVE_NUMBER,editable:n.state.resizable,setValue:function(t){n.resize(t)}},{key:"width",type:ot.INTEGER_POSITIVE_NUMBER},{key:"nodrill",type:ot.BOOL,editable:!0,hidden:!n.state.drillable,setValue:function(t){n.nodrill=t}}],n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.state.hidden){var r=Object(h.a)({},this.state);i&&(this.state=Object(h.a)({},this.state,{selected:!1,highlighted:!1})),Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a);var o=k.realToScreen(this.rect,n,a),s=k.realToScreen(this.rect.last,n,a),c=s.x-o.x,l=s.y-o.y,u=o.x,d=o.y;if(t.strokeRect(u,d,c,l),!i&&(this.state.fixedLength.max||this.state.fixedLength.min||this.state.fixed_move)){t.lineWidth=1;var f=new Path2D(ft({x:u+c/2,y:d+l/2},dt.LOCK));t.fill(f)}i&&(this.state=Object(h.a)({},r))}}},{key:"refresh",value:function(t,e){this.vertical?(this.rect.height=this.length,this.rect.width=this.thickness):(this.rect.width=this.length,this.rect.height=this.thickness),this.rect.last={x:this.rect.x+this.rect.width,y:this.rect.y+this.rect.height}}},{key:"getProperties",value:function(){return Object(y.a)(Object(m.a)(e.prototype),"getProperties",this).call(this)}},{key:"setPosition",value:function(t,e){this.rect.x=t,this.rect.y=e,this.rect.last={x:t+this.rect.width,y:e+this.rect.height}}},{key:"getPosition",value:function(){return this.rect}},{key:"setHidden",value:function(t){this.state.hidden=t}},{key:"resize",value:function(t){var e,n,a=t-this.length,i=this.jointToBack;i&&(this.vertical?(e=0,n=a):(e=a,n=0),i.moveTo(e,n)),(i=this.jointToFront)&&(this.vertical?(e=0,n=-a):(e=-a,n=0),i.moveTo(e,n))}},{key:"setLength",value:function(t){this.length=t,this.refresh()}},{key:"getLength",value:function(){return this.length}},{key:"fixMinLength",value:function(t){this.minLength=t?this.length:this.defaultMinLength,this.state.fixedLength.min=t}},{key:"fixMaxLength",value:function(t){this.maxLength=t?this.length:this.defaultMaxLength,this.state.fixedLength.max=t}},{key:"moveTo",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,r=this.getPosition(),o=r.x,s=r.y;this.vertical?e=0:t=0;var c,l=t,u=e,h=o+t,d=s+e,f=this.isMoveAvailable({newX:h,newY:d,dx:t,dy:e,prevPanel:i});if(c=f.result,h=f.newX,d=f.newY,t=f.dx,e=f.dy,a)return{result:c,newX:h,newY:d,newDX:t,newDY:e};if(c){this.setPosition(h,d);var p,v=Kt(this.jointFromBackSide);try{for(v.s();!(p=v.n()).done;){var y=p.value;y.setLength(y.getLength()+(t+e))}}catch(w){v.e(w)}finally{v.f()}var m,b=Kt(this.jointFromFrontSide);try{for(b.s();!(m=b.n()).done;){var g=m.value;g.setLength(g.getLength()-(t+e));var E=g.getPosition();g.setPosition(E.x+t,E.y+e)}}catch(w){b.e(w)}finally{b.f()}return this.gabarit&&n(),{result:!0,newDX:l-t,newDY:u-e}}return{result:!1}}},{key:"isMoveAvailable",value:function(t){var e=t.newX,n=t.newY,a=t.dx,i=t.dy,r=t.prevPanel;if(this.state.fixed_move)return{result:!1};var o=this.snapToNearest({newX:e,newY:n,dx:a,dy:i,prevPanel:r}),s=this.snapToMinJointLength({newX:e,newY:n,dx:a,dy:i});return!0===o.result?!1===s.result?Object(h.a)({},o):this.vertical?a<0?o.newX>s.newX?Object(h.a)({},o):Object(h.a)({},s):o.newX<s.newX?Object(h.a)({},o):Object(h.a)({},s):i<0?o.newY>s.newY?Object(h.a)({},o):Object(h.a)({},s):o.newY<s.newY?Object(h.a)({},o):Object(h.a)({},s):!0===s.result?Object(h.a)({},s):{result:!0,newX:e,newY:n,dx:a,dy:i}}},{key:"snapToMinJointLength",value:function(t){var e,n=t.newX,a=t.newY,i=t.dx,r=t.dy,o=function(t){var e=Array.from(t.jointFromBackSide),n=Array.from(t.jointFromFrontSide);return{jointsFromBackMinToMax:e.sort(function(t,e){return t.getLength()-e.getLength()}),jointsFromFrontMinToMax:n.sort(function(t,e){return t.getLength()-e.getLength()})}}(this),s=o.jointsFromBackMinToMax,c=o.jointsFromFrontMinToMax,l=0,u=0,h=Kt(s);try{for(h.s();!(e=h.n()).done;){var d=e.value,f=d.getLength()+i+r-d.minLength;f<l&&(l=f),(f=d.maxLength-(d.getLength()+i+r))<u&&(u=f)}}catch(v){h.e(v)}finally{h.f()}var p=[];return p.push({delta:l,result:this.vertical?{result:!0,newX:n-l,newY:a,dx:i-l,dy:r}:{result:!0,newX:n,newY:a-l,dx:i,dy:r-l}}),p.push({delta:u,result:this.vertical?{result:!0,newX:n+u,newY:a,dx:i+u,dy:r}:{result:!0,newX:n,newY:a+u,dx:i,dy:r+u}}),l=0,u=0,c.forEach(function(t){var e=t.getLength()-i-r-t.minLength;e<l&&(l=e),(e=t.maxLength-t.getLength()+i+r)<u&&(u=e)}),p.push({delta:l,result:this.vertical?{result:!0,newX:n+l,newY:a,dx:i+l,dy:r}:{result:!0,newX:n,newY:a+l,dx:i,dy:r+l}}),p.push({delta:u,result:this.vertical?{result:!0,newX:n-u,newY:a,dx:i-u,dy:r}:{result:!0,newX:n,newY:a-u,dx:i,dy:r-u}}),p.sort(function(t,e){return t.delta-e.delta}),p[0].delta<0?p[0].result:{result:!1,newX:n,newY:a,dx:i,dy:r}}},{key:"snapToNearest",value:function(t){var e=t.newX,n=t.newY,a=t.dx,i=t.dy,r=t.prevPanel,o=this.getNearest(r),s=o.nearestFromBack,c=o.nearestFromFront,l=s;if(l){var u=Math.max(this.panelMargin,l.panelMargin);if(this.vertical){var h=l.rect.x+l.thickness+u;if(e<h)return{result:!0,newX:h,newY:n,dx:a+(h-e),dy:i}}else{var d=l.rect.y+l.thickness+u;if(n<d)return{result:!0,newX:e,newY:d,dx:a,dy:i+(d-n)}}}if(l=c){var f=Math.max(this.panelMargin,l.panelMargin);if(this.vertical){var p=l.rect.x-this.thickness-f;if(p<e)return{result:!0,newX:p,newY:n,dx:a-(e-p),dy:i}}else{var v=l.rect.y-this.thickness-f;if(v<n)return{result:!0,newX:e,newY:v,dx:a,dy:i-(n-v)}}}return{result:!1,newX:e,newY:n,dx:a,dy:i}}},{key:"getNearest",value:function(t){var e,n=Array.from(this.parallelFromBack)[0],a=Array.from(this.parallelFromFront)[0],i=0,r=0,o=Kt(this.parallelFromBack);try{for(o.s();!(e=o.n()).done;){var s=e.value;t!==s&&(s.rect.x+s.thickness>i&&this.vertical&&(n=s,i=s.rect.x),s.rect.y+s.thickness>r&&!this.vertical&&(n=s,r=s.rect.y))}}catch(h){o.e(h)}finally{o.f()}i=1e6,r=1e6;var c,l=Kt(this.parallelFromFront);try{for(l.s();!(c=l.n()).done;){var u=c.value;t!==u&&(u.rect.x<i&&this.vertical&&(a=u,i=u.rect.x),u.rect.y<r&&!this.vertical&&(a=u,r=u.rect.y))}}catch(h){l.e(h)}finally{l.f()}return{nearestFromBack:n,nearestFromFront:a}}},{key:"canBePlaced",value:function(t,e,n,a){if(t<16||t>a.width-16||e<46||e>a.height-16)return{result:!1,reason:$};this.parallelFromBack=new Set,this.parallelFromFront=new Set;var i,r=Kt(n);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(o.vertical===this.vertical&&wt({x:t,y:e},o)){var s=Math.max(this.panelMargin,o.panelMargin);if(this.vertical){if(t>=o.rect.x){if(t-(o.rect.x+o.thickness)<s)return{result:!1,reason:Z};o.rect.x+this.thickness<=t&&this.parallelFromBack.add(o)}if(t<o.rect.x){if(o.rect.x-(t+this.thickness)<s)return{result:!1,reason:Z};o.rect.x>=t&&this.parallelFromFront.add(o)}}else{if(e>=o.rect.y){if(e-(o.rect.y+o.thickness)<s)return{result:!1,reason:Z};o.rect.y+this.thickness<=e&&this.parallelFromBack.add(o)}if(e<o.rect.y){if(o.rect.y-(e+this.thickness)<s)return{result:!1,reason:Z};o.rect.y>=e&&this.parallelFromFront.add(o)}}}}}catch(c){r.e(c)}finally{r.f()}return{result:!0}}},{key:"findConstraints",value:function(t,e,n,a){var i,r=0,o=a.width,s=46,c=a.height,l=Kt(n);try{for(l.s();!(i=l.n()).done;){var u=i.value;if(u!==this&&this.vertical!==u.vertical)if(this.vertical){if((t-u.rect.x)*(t-u.rect.last.x)>0)continue;u.rect.y<=e&&u.rect.y+u.thickness>=s&&(s=u.rect.y+u.thickness,this.jointToFront=u),u.rect.y>e&&u.rect.y<=c&&(c=u.rect.y,this.jointToBack=u)}else{if((e-u.rect.y)*(e-u.rect.last.y)>0)continue;u.rect.x<=t&&u.rect.x+u.thickness>=r&&(r=u.rect.x+u.thickness,this.jointToFront=u),u.rect.x>t&&u.rect.x<=o&&(o=u.rect.x,this.jointToBack=u)}}}catch(d){l.e(d)}finally{l.f()}this.length=this.vertical?c-s:o-r,this.rect=this.vertical?{x:t,y:s}:{x:r,y:e},this.refresh();var h=this.jointToBack.type===V.PANEL&&this.jointToFront.type===V.PANEL;return h?{result:h}:{result:h,reason:Q}}},{key:"getSingleDimensionData",value:function(){var t=this.vertical?{x:this.rect.x+this.thickness/2,y:this.rect.y}:{x:this.rect.x,y:this.rect.y+this.thickness/2},e=this.vertical?{x:this.rect.x+this.thickness/2,y:this.rect.last.y}:{x:this.rect.last.x,y:this.rect.last.y-this.thickness/2},n={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return{vertical:this.vertical,firstPoint:t,secondPoint:e,midPoint:n}}},{key:"isInSelectionRect",value:function(t){var e=t.topLeft,n=t.bottomRight,a=[k.pointInRect(this.rect,e,n),k.pointInRect(this.rect.last,e,n)].every(function(t){return!0===t});return{cross:T.RectangleRectangle(e,n,this.rect,this.rect.last).length>0,full:a}}},{key:"isUnderCursor",value:function(t,e){return t.x>=this.rect.x-2*e&&t.x<=this.rect.x+this.rect.width+2*e&&t.y>=this.rect.y-2*e&&t.y<=this.rect.y+this.rect.height+2*e}}]),e}(V),Xt=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,Object(h.a)({},t,{vertical:!0,thickness:32})))).type=V.PANEL,n.name="\u0421\u0442\u043e\u0439\u043a\u0430 \u0432\u043d\u0443\u0442\u0440",n.double=!0,n.dimensions=new Set,n.properties=[{key:"name",type:ot.STRING,editable:!0},{key:"length",type:ot.INTEGER_POSITIVE_NUMBER},{key:"width",type:ot.INTEGER_POSITIVE_NUMBER}],n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,e,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.state.hidden){this.refresh(e,n),this.refreshStyle(t);var a=k.realToScreen(this.rect,e,n),i=k.realToScreen(this.rect.last,e,n),r=i.x-a.x,o=i.y-a.y,s=a.x,c=a.y;t.strokeRect(s,c,r/2,o),t.strokeRect(s,c,r,o)}}}]),e}(zt);function Yt(t){for(var e=t.wardrobe,n=function(t,e){var n=[88,98,108][e-2];return Math.round((t-n)/e)}(e.width,e.fasadeCount),a=e.height-157,i=[],r=0;r<e.fasadeCount;r++)i.push(new mt({height:a,width:n,base:e.fasadeBase,baseColor:e.fasadeBaseColor,position:{x:r*(n+30),y:0},deletable:!1}));return i}var Jt=function(t){function e(){var t,n;Object(f.a)(this,e);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(v.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(i)))).type=e.ORD,n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,e,n){this.refresh(e,n),t.strokeStyle=this.getStyle().getColor(),t.setLineDash(this.getStyle().getStroke()),t.lineWidth=2;var a=this.getCursor(this.p0),i=new Path2D(a);t.fill(i),t.stroke(i)}},{key:"setType",value:function(t){this.type=t}},{key:"getCursor",value:function(t){var n;return(n={},Object(q.a)(n,e.ORD,"M".concat(t.x+10," ").concat(t.y,"l-8.506 8.506 0 -8.506 8.506 0zm-6.69 24.41l22.66 -22.66 -22.66 22.66zm-2.557 -3.145l5.703 5.702 -5.703 -5.702zm21.996 -21.996l5.702 5.703 -5.702 -5.703z")),Object(q.a)(n,e.VERT,"M".concat(t.x+10," ").concat(t.y,"l-7.211 7.211 0 -7.211 7.211 0zm8.712 24.514l0 -27.168 0 27.168zm-3.419 -0.352l6.837 0 -6.837 0zm0 -26.372l6.837 0 -6.837 0z")),Object(q.a)(n,e.HOR,"M".concat(t.x+10," ").concat(t.y,"l-8.359 8.359 0 -8.359 8.359 0zm-11.436 17.434l31.496 0 -31.496 0zm0.409 -3.964l0 7.927 0 -7.927zm30.573 0l0 7.927 0 -7.927z")),n)[this.type]}}]),e}(W);Jt.ORD="ord",Jt.VERT="vert",Jt.HOR="hor";var qt=function(t){function e(){var t,n;Object(f.a)(this,e);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(v.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(i)))).type=e.DRAG,n.hint="",n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,e,n){this.refresh(e,n),t.strokeStyle=this.getStyle().getColor(),t.setLineDash(this.getStyle().getStroke()),t.lineWidth=2;var a=this.getCursor(this.p0),i=new Path2D(a);t.fill(i),t.stroke(i),this.hint&&(t.fillStyle="black",t.font="14px sans-serif",t.fillText(this.hint,this.p0.x,this.p0.y+30))}},{key:"setType",value:function(t,e){this.type=t,this.hint=e}},{key:"getCursor",value:function(t){var n;return(n={},Object(q.a)(n,e.DRAG,"M".concat(t.x," ").concat(t.y,"l0 9.94m-5.05 0c0,-5.382 -0.086,-5.266 0,-7.791 0.029,-4.141 4.358,-4.141 5.05,-2.15 0.202,-4.271 5.079,-4.386 5.497,-0.115 0.476,-2.222 4.675,-2.107 4.949,0.678 0.346,-1.054 3.967,-2.078 4.328,1.976 0.13,1.429 -0.014,6.291 -0.029,9.392 -1.053,17.069 -22.465,16.539 -25.264,-0.644 -0.911,-3.53 3.518,-5.453 5.469,-1.346zm10.547 -10.056l0 10.056m4.949 -9.378l0 9.378 0 -9.378z")),Object(q.a)(n,e.NODRAG,"M".concat(t.x+15," ").concat(t.y+15,"l-27.479 -27.479m0 27.479l27.479 -27.479m-16.856 1.525l0 10.403m-5.285 0c0,-5.632 -0.09,-5.511 0,-8.154 0.031,-4.333 4.56,-4.333 5.285,-2.25 0.212,-4.469 5.315,-4.589 5.753,-0.12 0.498,-2.325 4.892,-2.205 5.179,0.709 0.362,-1.102 4.151,-2.174 4.529,2.069 0.136,1.495 -0.014,6.583 -0.03,9.829 -1.102,17.862 -23.511,17.308 -26.439,-0.675 -0.953,-3.694 3.681,-5.706 5.723,-1.408zm11.038 -10.524l0 10.524m5.179 -9.814l0 9.814 0 -9.814z")),n)[this.type]}}]),e}(W);qt.DRAG="DRAG",qt.NODRAG="NODRAG";var $t=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,Object(h.a)({},t,{vertical:!1,thickness:391,name:"\u042f\u0449\u0438\u0447\u043d\u044b\u0439 \u0431\u043b\u043e\u043a"})))).type=V.DRAWER,n.state.measurable=!1,n.properties=[{key:"name",type:ot.STRING},{key:"drawerWidth",type:ot.INTEGER_POSITIVE_NUMBER},{key:"depth",type:ot.INTEGER_POSITIVE_NUMBER}],n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,e,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.state.hidden){this.refresh(e,n),this.refreshStyle(t),this.state.selected||this.state.highlighted?this.getStyle().setWidth(2):this.getStyle().setWidth(1);for(var a={x:this.rect.x+8,y:this.rect.y+37,last:{x:this.rect.last.x-8,y:this.rect.y+37+140}},i=0,r=[a,{x:this.rect.x+8,y:a.last.y+37,last:{x:this.rect.last.x-8,y:this.rect.last.y-37}}];i<r.length;i++){var o=r[i],s=k.realToScreen(o,e,n),c=k.realToScreen(o.last,e,n),l=c.x-s.x,u=c.y-s.y,h=s.x,d=s.y;t.strokeRect(h,d,l,u)}}}},{key:"getProperties",value:function(){var t=Object(y.a)(Object(m.a)(e.prototype),"getProperties",this).call(this);return t.find(function(t){return"drawerWidth"===t.key}).value=this.length,t.find(function(t){return"depth"===t.key}).value=this.width-50,t}},{key:"getSingleDimensionData",value:function(){return{hasDimension:!1}}}]),e}(zt),Zt=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,Object(h.a)({},t,{vertical:!1,thickness:140,panelMargin:10,name:"\u042f\u0449\u0438\u043a"})))).type=V.DRAWER,n.state.measurable=!1,n.properties=[{key:"name",type:ot.STRING},{key:"drawerWidth",type:ot.INTEGER_POSITIVE_NUMBER},{key:"depth",type:ot.INTEGER_POSITIVE_NUMBER}],n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,e,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.state.hidden){this.refresh(e,n),this.refreshStyle(t),this.state.selected||this.state.highlighted?this.getStyle().setWidth(2):this.getStyle().setWidth(1);var a={x:this.rect.x+4,y:this.rect.y,last:{x:this.rect.last.x-4,y:this.rect.last.y}},i=k.realToScreen(a,e,n),r=k.realToScreen(a.last,e,n),o=r.x-i.x,s=r.y-i.y,c=i.x,l=i.y;t.strokeRect(c,l,o,s)}}},{key:"getProperties",value:function(){var t=Object(y.a)(Object(m.a)(e.prototype),"getProperties",this).call(this);return t.find(function(t){return"drawerWidth"===t.key}).value=this.length,t.find(function(t){return"depth"===t.key}).value=this.width-50,t}},{key:"getSingleDimensionData",value:function(){return{hasDimension:!1}}}]),e}(zt),Qt=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,Object(h.a)({},t,{vertical:!1,thickness:50,panelMargin:0,name:"\u0422\u0440\u0443\u0431\u0430"})))).type=V.TUBE,n.state.measurable=!1,n.properties=[{key:"name",type:ot.STRING},{key:"length",type:ot.INTEGER_POSITIVE_NUMBER}],n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,e,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.state.hidden){this.refresh(e,n),this.refreshStyle(t),this.state.selected||this.state.highlighted?this.getStyle().setWidth(2):this.getStyle().setWidth(1);for(var a={x:this.rect.x,y:this.rect.y,last:{x:this.rect.last.x,y:this.rect.last.y}},i={topLeft:{x:a.x,y:a.y+this.thickness},bottomRight:{x:a.x+20,y:a.y}},r={topLeft:{x:a.last.x-20,y:a.last.y},bottomRight:{x:a.last.x,y:a.y}},o=0,s=[i,r,{topLeft:{x:i.bottomRight.x,y:i.topLeft.y-10},bottomRight:{x:r.topLeft.x,y:r.bottomRight.y+10}}];o<s.length;o++){var c=s[o],l=k.realToScreen(c.topLeft,e,n),u=k.realToScreen(c.bottomRight,e,n),h=u.x-l.x,d=u.y-l.y,f=l.x,p=l.y;t.strokeRect(f,p,h,d)}}}},{key:"getProperties",value:function(){return Object(y.a)(Object(m.a)(e.prototype),"getProperties",this).call(this)}},{key:"getSingleDimensionData",value:function(){return{hasDimension:!0}}}]),e}(zt),te=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,t))).movePoint={dx:0,dy:0},n.properties=[{type:ot.BOOL,value:!1,labelKey:"make_copy",setValue:function(t){n.makeCopy=t}}],n.panels=t.panels,n.activeShape=t.curShape,n.first=!0,n.setStatusBar(),n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.isMobile?this.statusBar=[{text:" - ".concat(this.captions.scale,"  "),icons:["gest_zoom"]}]:this.statusBar=[{text:" - ".concat(this.captions.rotate,";  "),icons:["rmb"]},{text:" - ".concat(this.captions.move,";  "),icons:["mmb"]},{text:" - ".concat(this.captions.scale,";  "),icons:["mmb_wheel"]},{text:" - ".concat(this.captions.snap),icons:["button_ctrl"]}]}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"down",value:function(t){var e=t.button,n=t.appActions;t.appData;if(1!==e)return 2===e&&this.countSelected<2||void 0;n.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}},{key:"move",value:function(t){var n=this,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=(t.appActions,t.appData),s=t.keys;s||(s={}),Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:a,viewPortData:i}),r(function(t){return A(n.coord,n.curPoint,t)});var c=k.screenToReal(a.x,a.y,i.viewPortWidth,i.viewPortHeight,i.topLeft,i.bottomRight);c.x=c.x-this.movePoint.dx,c.y=c.y+this.movePoint.dy,c.x=Math.trunc(c.x),c.y=this.activeShape.vertical?Math.trunc(c.y):Math.trunc(c.y-this.activeShape.thickness/2);var l=this.activeShape.canBePlaced(c.x,c.y,o.panels,o.wardrobe);this.canBePlaced=l.result,this.canBePlaced&&(l=this.activeShape.findConstraints(c.x,c.y,o.panels,o.wardrobe),this.canBePlaced=l.result,this.canBePlaced&&(this.canBePlaced=this.activeShape.length>=this.activeShape.minLength,this.canBePlaced||(l.reason=tt))),this.activeShape.setHidden(!this.canBePlaced);var u=this.canBePlaced?"":o.captions.handlers.create[l.reason];o.cursor.setType(this.canBePlaced?qt.DRAG:qt.NODRAG,u),this.lastPoint=Object(h.a)({},this.coord)}},{key:"up",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=t.appActions,o=t.appData;if(Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{button:n,curPoint:a,viewPortData:i}),2===n)return r.cancel();0===n&&(o.curShape.state.selected=!1,this.canBePlaced&&(o.curShape.jointToBack&&o.curShape.jointToBack.jointFromBackSide.add(o.curShape),o.curShape.jointToFront&&o.curShape.jointToFront.jointFromFrontSide.add(o.curShape),r.addShape(o.curShape)),this.drag=!1,r.cancel())}},{key:"touchMove",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchMove",this).call(this,{pointerId:n,curPoint:a,viewPortData:i});var c=i.touchManager;if(c.getTouchCount()>1){var l=k.distance(c.touches[0].curPoint,c.touches[1].curPoint),u=k.midPoint(c.touches[0].curPoint,c.touches[1].curPoint),h=c.prevDiff-l;if(Math.abs(h)>10){var d=Math.sign(h);this.wheel({deltaY:d,curPoint:u,viewPortData:i,setViewPortData:r}),c.prevDiff=l}}1===c.getTouchCount()&&this.move({curPoint:a,viewPortData:i,setViewPortData:r,appActions:o,appData:s})}},{key:"touchUp",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.appActions,o=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchUp",this).call(this,{pointerId:n,viewPortData:i}),0===i.touchManager.getTouchCount()&&this.up({button:0,curPoint:a,viewPortData:i,appActions:r,appData:o})}},{key:"click",value:function(t){t.button,t.appActions}}]),e}(F);function ee(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return ne(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var ae=function(t){function e(t,n,a){var i,r;switch(Object(f.a)(this,e),(i=Object(v.a)(this,Object(m.a)(e).call(this,t))).movePoint=a,i.properties=[{type:ot.BOOL,value:!1,labelKey:"make_copy",setValue:function(t){i.makeCopy=t}}],i.movePoint||(i.movePoint={},i.movePoint.dx=(t.curShape.length+2*t.curShape.margin)/2,i.movePoint.dy=(t.curShape.width+2*t.curShape.margin)/2),i.panels=t.panels,i.activeShape=t.curShape,i.activeShape.type){case V.DIMENSION:r=function(t){return t.type===V.DIMENSION&&t===i.activeShape};break;default:r=function(t){return t.type!==V.DIMENSION}}return t.selectedPanels=new Et(Array.from(t.selectedPanels).filter(r)),i.newPanel=n,i.newPanel&&(i.panels=[].concat(Object(d.a)(t.panels),[t.curShape])),i.curShape=t.curShape,i.first=!0,i.setStatusBar(),i}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.isMobile?this.statusBar=[{text:" - ".concat(this.captions.scale,"  "),icons:["gest_zoom"]}]:this.statusBar=[{text:" - ".concat(this.captions.rotate,";  "),icons:["rmb"]},{text:" - ".concat(this.captions.move,";  "),icons:["mmb"]},{text:" - ".concat(this.captions.scale,";  "),icons:["mmb_wheel"]},{text:" - ".concat(this.captions.snap),icons:["button_ctrl"]}]}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"down",value:function(t){var e=t.button,n=t.appActions;t.appData;if(1!==e)return 2===e||void 0;n.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}},{key:"move",value:function(t){var n=this,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData,c=t.keys;c||(c={}),Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:a,viewPortData:i}),r(function(t){return A(n.coord,n.curPoint,t)});var l=k.screenToReal(a.x,a.y,i.viewPortWidth,i.viewPortHeight,i.topLeft,i.bottomRight);l.x=l.x-this.movePoint.dx,l.y=l.y+this.movePoint.dy,l.x=Math.trunc(l.x),l.y=Math.trunc(l.y);var u=this.activeShape.getPosition(),d=u.x,f=u.y,p=l.x-d,v=l.y-f;s.workspace===Te.CORPUS&&Tt(p,v,this.activeShape,s.selectedPanels,function(){kt(s,o)});var b,g=ee(s.workspace===Te.CORPUS?s.dimensions:s.fasadeDimensions);try{for(g.s();!(b=g.n()).done;){var E=b.value;s.selectedPanels.has(E)&&E.moveTo(p,v,s.wardrobe)}}catch(w){g.e(w)}finally{g.f()}this.lastPoint=Object(h.a)({},this.coord)}},{key:"up",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=t.appActions,o=t.appData;Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{button:n,curPoint:a,viewPortData:i}),0===n&&(this.newPanel&&(o.curShape.state.selected=!1,r.addShape(o.curShape)),this.drag=!1,r.cancel())}},{key:"touchMove",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchMove",this).call(this,{pointerId:n,curPoint:a,viewPortData:i});var c=i.touchManager;if(c.getTouchCount()>1){var l=k.distance(c.touches[0].curPoint,c.touches[1].curPoint),u=k.midPoint(c.touches[0].curPoint,c.touches[1].curPoint),h=c.prevDiff-l;if(Math.abs(h)>10){var d=Math.sign(h);this.wheel({deltaY:d,curPoint:u,viewPortData:i,setViewPortData:r}),c.prevDiff=l}}1===c.getTouchCount()&&this.move({curPoint:a,viewPortData:i,setViewPortData:r,appActions:o,appData:s})}},{key:"touchUp",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.appActions,o=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchUp",this).call(this,{pointerId:n,viewPortData:i}),0===i.touchManager.getTouchCount()&&this.up({button:0,curPoint:a,viewPortData:i,appActions:r,appData:o})}},{key:"leave",value:function(t){t.appActions.cancel()}},{key:"click",value:function(){}}]),e}(F),ie=function(t){function e(t){var n,a=t.vertical,i=t.firstPoint,r=t.secondPoint;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this))).type=V.DIMENSION,n.vertical=a,n.firstPoint=i,n.secondPoint=r,n.offsetPoint={},n.length=0,n.state.selectable=!0,n.state.deletable=!0,n.state.fixable=!1,n.state.fixed=!1,n.captionShape=new ct(n.length,{},a?-Math.PI/2:0,{vertical:a?ct.CENTER:ct.BOTTOM,horizontal:ct.CENTER}),n.captionShape.setFillStyle(H.BLACK),n.style=new B(H.DARK_GRAY,B.DASH,1),n.defaultStyle=new B(H.DARK_GRAY,B.DASH,1),n.selectedStyle=new B(H.SELECTED,B.DASH,2),n.highlightedStyle=new B(H.BLACK,B.DASH,1),n.properties=[],n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.hidden){var r=Object(h.a)({},this.state);i&&(this.state=Object(h.a)({},this.state,{selected:!1,highlighted:!1})),Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a);var o,s,c,l=k.realToScreen(this.firstPoint,n,a),u=k.realToScreen(this.secondPoint,n,a),d=k.realToScreen(this.offsetPoint,n,a);t.beginPath(),this.vertical?(o=d.x-l.x,s=d.x-u.x,c=l.y-u.y,t.moveTo(l.x,l.y),t.lineTo(l.x+o,l.y),t.moveTo(u.x,u.y),t.lineTo(u.x+s,u.y)):(o=d.y-l.y,s=d.y-u.y,c=u.x-l.x,t.moveTo(l.x,l.y),t.lineTo(l.x,l.y+o),t.moveTo(u.x,u.y),t.lineTo(u.x,u.y+s)),t.stroke();var f=this.getStyle().getStroke();this.getStyle().setStroke(B.SOLID),this.refreshStyle(t),t.beginPath(),Ce(t,this.vertical,d,c,5),t.stroke(),this.captionShape.setFitRect({width:500,height:500,fit:!0}),this.captionShape.getStyle().setWidth(this.style.width),this.captionShape.getStyle().setColor(this.style.color),this.captionShape.refreshStyle(t);var p=this.vertical?{x:0,y:-10}:void 0;this.captionShape.draw(t,n,a,null,p),this.getStyle().setStroke(f),this.refreshStyle(t),i&&(this.state=Object(h.a)({},r))}}},{key:"refresh",value:function(){this.vertical?(this.offsetPoint.y=this.midPoint.y,this.length=this.secondPoint.y-this.firstPoint.y):(this.offsetPoint.x=this.midPoint.x,this.length=this.secondPoint.x-this.firstPoint.x),this.captionShape.setPoint(this.offsetPoint),this.setCaption()}},{key:"getPosition",value:function(){return this.offsetPoint}},{key:"moveTo",value:function(t,e,n){var a={x:this.vertical?this.offsetPoint.x+t:this.offsetPoint.x,y:this.vertical?this.offsetPoint.y:this.offsetPoint.y+e};this.setOffsetPoint(a,n),this.refresh()}},{key:"setCaption",value:function(){this.captionShape.setText(this.length)}},{key:"setHidden",value:function(t){this.hidden=t}},{key:"setOffsetPoint",value:function(t,e){this.offsetPoint=t,this.offsetPoint.x<-200&&(this.offsetPoint.x=-200),this.offsetPoint.x>e.width+200&&(this.offsetPoint.x=e.width+200),this.offsetPoint.y<-200&&(this.offsetPoint.y=-200),this.offsetPoint.y>e.height+200&&(this.offsetPoint.y=e.height+200),this.refresh()}},{key:"isUnderCursor",value:function(t,e){return this.vertical?t.x>=this.offsetPoint.x-2*e&&t.x<=this.offsetPoint.x+2*e&&t.y<=this.secondPoint.y&&t.y>=this.firstPoint.y:t.y>=this.offsetPoint.y-2*e&&t.y<=this.offsetPoint.y+2*e&&t.x<=this.secondPoint.x&&t.x>=this.firstPoint.x}},{key:"isInSelectionRect",value:function(t){var e=t.topLeft,n=t.bottomRight,a={},i={};this.vertical?(a.x=this.offsetPoint.x,i.x=this.offsetPoint.x,a.y=this.offsetPoint.y-this.length/2,i.y=this.offsetPoint.y+this.length/2):(a.x=this.offsetPoint.x-this.length/2,i.x=this.offsetPoint.x+this.length/2,a.y=this.offsetPoint.y,i.y=this.offsetPoint.y);var r=[k.pointInRect(a,e,n),k.pointInRect(i,e,n)].every(function(t){return!0===t}),o={p1:a,p2:i};return{cross:T.LineRectangle(o,e,n).length>0,full:r}}}]),e}(V),re=function(t){function e(t){var n;Object(f.a)(this,e);var a=t.getSingleDimensionData(),i=a.vertical,r=a.firstPoint,o=a.secondPoint;return(n=Object(v.a)(this,Object(m.a)(e).call(this,{vertical:i,firstPoint:r,secondPoint:o}))).panel=t,n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a,i)}},{key:"refresh",value:function(){var t=this.panel.getSingleDimensionData(),n=t.firstPoint,a=t.secondPoint;this.firstPoint=n,this.secondPoint=a,this.midPoint={x:(this.firstPoint.x+this.secondPoint.x)/2,y:(this.firstPoint.y+this.secondPoint.y)/2},Object(y.a)(Object(m.a)(e.prototype),"refresh",this).call(this)}},{key:"delete",value:function(){this.panel.dimensions.delete(this),this.panel.singleDimension=null}}]),e}(ie);function oe(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return se(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function se(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var ce=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,t))).setStatusBar(),n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.isMobile?this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["gest_move"]},{text:" - ".concat(this.captions.rotate,";  "),icons:["gest_dbltap"]},{text:" - ".concat(this.captions.scale,"  "),icons:["gest_zoom"]}]:this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["rmb","mmb"]},{text:" - ".concat(this.captions.scale,"  "),icons:["mmb_wheel"]}]}},{key:"move",value:function(t){var n=this,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=(t.appActions,t.appData);t.keys;switch(Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:a,viewPortData:i}),o.cursor.setType(Jt.ORD),this.clickCount){case 0:var s,c=oe(o.panels);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.state.selectable&&(l.state.measurable&&(l.isUnderCursor(this.coord,i.pixelRatio)&&!l.singleDimension?(l.setState({highlighted:!0}),o.cursor.setType(l.vertical?Jt.VERT:Jt.HOR)):l.setState({highlighted:!1})))}}catch(d){c.e(d)}finally{c.f()}break;case 1:var u=this.activePanel.vertical?this.coord.x-this.firstPoint.x:this.coord.y-this.firstPoint.y,h=this.vertical?{x:this.midPoint.x+u,y:this.midPoint.y}:{x:this.midPoint.x,y:this.midPoint.y+u};this.curShape.setOffsetPoint(h,o.wardrobe),o.cursor.setType(this.curShape.vertical?Jt.VERT:Jt.HOR)}r(function(t){return A(n.coord,n.curPoint,t)})}},{key:"down",value:function(t){var n=this,a=t.button,i=t.curPoint,r=t.viewPortData,o=t.setViewPortData,s=t.appActions;t.appData,t.keys;Object(y.a)(Object(m.a)(e.prototype),"down",this).call(this,{curPoint:i,viewPortData:r}),o(function(t){return A(n.coord,i,t)}),1!==a||s.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}},{key:"click",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData;t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{curPoint:a,viewPortData:i}),0===n)switch(this.clickCount){case 1:this.activePanel=null;var s,c=oe(o.panels);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(l.state.selectable&&(l.state.measurable&&l.isUnderCursor(this.coord,i.pixelRatio)&&!l.singleDimension)){this.activePanel=l;var u=l.getSingleDimensionData(),h=u.vertical,d=u.firstPoint,f=u.secondPoint,p=u.midPoint;this.firstPoint=d,this.secondPoint=f,this.midPoint=p,this.vertical=h,this.curShape=new re(l)}}}catch(v){c.e(v)}finally{c.f()}this.activePanel||(this.clickCount=0);break;case 2:this.activePanel.singleDimension=this.curShape,r.addDimension(this.curShape),r.cancel()}}},{key:"doubleClick",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData;t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"doubleClick",this).call(this,{curPoint:a,viewPortData:i}),0===n&&this.activePanel){if(o.material.texture)return;var s,c=oe(o.panels);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.state.selected=l===this.activePanel}}catch(u){c.e(u)}finally{c.f()}return r.repaint(),!0}}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"up",value:function(t){var e=t.button,n=t.appActions;if(2===e)return n.cancel();this.drag=!1,n.updateState()}},{key:"getSelectedShapeProperties",value:function(t){this.properties=[];var e=t.selectionManager.getSelectedPanels().pop();if(e){var n=e.getProperties();this.setProperties(n),this.currentObject=e}}},{key:"touchDown",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchDown",this).call(this,{pointerId:n,curPoint:a,viewPortData:i}),this.down({button:0,curPoint:a,viewPortData:i,setViewPortData:r,appActions:o,appData:s})}},{key:"touchMove",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchMove",this).call(this,{pointerId:n,curPoint:a,viewPortData:i});var c=i.touchManager;if(c.getTouchCount()>1){var l=k.distance(c.touches[0].curPoint,c.touches[1].curPoint),u=k.midPoint(c.touches[0].curPoint,c.touches[1].curPoint),h=c.prevDiff-l;if(Math.abs(h)>10){var d=Math.sign(h);this.wheel({deltaY:d,curPoint:u,viewPortData:i,setViewPortData:r}),c.prevDiff=l}}if(1===c.getTouchCount()){if(this.drag)return s.panels.forEach(function(t){return t.state.selected=!1}),this.activePanel.state.selected=!0,void o.movePanel(this.activePanel,this.dragPos);o.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}}}]),e}(F),le=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this))).model=t,n.rect=new x,n.properties=[{type:ot.VERTEX,value:t.topLeft,labelKey:"p1"},{type:ot.VERTEX,value:t.bottomRight,labelKey:"p2"}],n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a);var r=this.rect.topLeft.x,o=this.rect.topLeft.y;i&&(t.fillStyle=this.fillStyle,t.fillRect(r,o,this.rect.width,this.rect.height)),t.strokeRect(r,o,this.rect.width,this.rect.height)}},{key:"refresh",value:function(t,e){this.rect.topLeft=k.realToScreen(this.model.topLeft,t,e),this.rect.bottomRight=k.realToScreen(this.model.bottomRight,t,e),this.rect.width=this.rect.bottomRight.x-this.rect.topLeft.x,this.rect.height=this.rect.bottomRight.y-this.rect.topLeft.y}},{key:"getMarkers",value:function(){return[]}},{key:"setCorners",value:function(t,e){this.properties[0].value={x:t.x,y:t.y},this.properties[1].value={x:e.x,y:e.y},this.refreshModel()}},{key:"refreshModel",value:function(){this.model.topLeft=this.properties[0].value,this.model.bottomRight=this.properties[1].value,this.model.width=this.model.bottomRight.x-this.model.topLeft.x,this.model.height=this.model.topLeft.y-this.model.bottomRight.y}},{key:"getDistance",value:function(t){var e=this.model.topLeft,n=new w(e.x+this.model.width,e.y),a=new w(e.x,e.y-this.model.height),i=new w(e.x+this.model.width,e.y-this.model.height),r=new S(e,n),o=new S(a,i),s=new S(n,i),c=new S(e,a);return Math.min(k.PointToLineDistance(t,r),k.PointToLineDistance(t,c),k.PointToLineDistance(t,o),k.PointToLineDistance(t,s))}},{key:"isInSelectionRect",value:function(t,e){var n=[k.pointInRect(this.model.topLeft,t,e),k.pointInRect(this.model.bottomRight,t,e)].every(function(t){return!0===t});return{cross:T.RectangleRectangle(t,e,this.model.topLeft,this.model.bottomRight).length>0,full:n}}},{key:"toString",value:function(){return"Rectangle"}},{key:"getDescription",value:function(){return"Rectangle"}}]),e}(V),ue=function(t){function e(t,n){var a;return Object(f.a)(this,e),(a=Object(v.a)(this,Object(m.a)(e).call(this,n))).x0=t.x,a.y0=t.y,a.curShape=new le(new x),a.curShape.setStyle(new B(H.BLACK,B.DASH)),a.setStatusBar(),a}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.statusBar=[]}},{key:"move",value:function(t){var n,a=this,i=t.curPoint,r=t.viewPortData,o=t.setViewPortData,s=t.appData;t.keys;Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:i,viewPortData:r}),o(function(t){return A(a.coord,a.curPoint,t)}),this.coord.x>this.x0?(this.curShape.style.setStroke(B.SOLID),n=!1):(this.curShape.style.setStroke(B.DASH),n=!0),this.curShape.setCorners({x:this.x0,y:this.y0},this.coord),this.selectPanels({topLeft:this.curShape.model.topLeft,bottomRight:this.curShape.model.bottomRight},s.fasades,s.fasadeDimensions,s.selectedPanels,n),s.fasades=xt(s.fasades,s.selectedPanels)}},{key:"up",value:function(t){t.button,t.appActions}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"click",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData,s=t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{curPoint:a,viewPortData:i}),0===n){for(var c=0,l=[].concat(Object(d.a)(o.fasades),Object(d.a)(o.fasadeDimensions));c<l.length;c++){var u=l[c];if(u.isUnderCursor(this.coord,i.pixelRatio)){if(!u.state.selectable)continue;s.shiftKey&&o.selectedPanels.has(u)?o.selectedPanels.delete(u):o.selectedPanels.add(u)}else s.shiftKey||this.isSelectedPanels||o.selectedPanels.delete(u)}o.fasades=xt(o.fasades,o.selectedPanels),this.isSelectedPanels=o.selectedPanels.size>0,0===n&&r.stopSelection(this.isSelectedPanels,he),r.updateState()}}},{key:"leave",value:function(t){var n=t.appActions;Object(y.a)(Object(m.a)(e.prototype),"leave",this).call(this),n.cancel()}},{key:"selectPanels",value:function(t,e,n,a,i){this.isSelectedPanels=!1;for(var r=0,o=[].concat(Object(d.a)(e),Object(d.a)(n));r<o.length;r++){var s=o[r];if(s.state.selectable){var c=s.isInSelectionRect(t),l=c.full,u=c.cross;l&&(a.add(s),this.isSelectedPanels=!0),u&&i&&(a.add(s),this.isSelectedPanels=!0)}}}}]),e}(F),he=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,t))).setStatusBar(),n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.isMobile?this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["gest_move"]},{text:" - ".concat(this.captions.rotate,";  "),icons:["gest_dbltap"]},{text:" - ".concat(this.captions.scale,"  "),icons:["gest_zoom"]}]:this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["rmb","mmb"]},{text:" - ".concat(this.captions.scale,"  "),icons:["mmb_wheel"]}]}},{key:"move",value:function(t){var n=this,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:a,viewPortData:i}),this.drag)return s.selectedPanels.add(this.activeShape),void(this.activeShape.state.fixed||o.movePanel(this.activeShape,this.dragPos));this.activeShape=null;for(var c=0,l=[].concat(Object(d.a)(s.fasades),Object(d.a)(s.fasadeDimensions));c<l.length;c++){var u=l[c];if(u.isUnderCursor(this.coord,i.pixelRatio)){if(!u.state.selectable)continue;u.state.fixed_move||u.type!==V.DIMENSION?o.setCursor(new U(this.coord)):o.setCursor(new Le(this.coord,u.vertical)),u.setState({highlighted:!0}),this.activeShape=u}else u.setState({highlighted:!1})}this.activeShape||o.setCursor(new U(this.coord)),r(function(t){return A(n.coord,n.curPoint,t)})}},{key:"down",value:function(t){var n=this,a=t.button,i=t.curPoint,r=t.viewPortData,o=t.setViewPortData,s=t.appActions,c=t.appData,l=t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"down",this).call(this,{curPoint:i,viewPortData:r}),o(function(t){return A(n.coord,i,t)}),1!==a&&2!==a){if(0===a){this.activeShape=null;for(var u=0,h=[].concat(Object(d.a)(c.fasades),Object(d.a)(c.fasadeDimensions));u<h.length;u++){var f=h[u];if(f.isUnderCursor(this.coord,r.pixelRatio)){if(!f.state.selectable)continue;this.activeShape=f,f.state.selected||l.shiftKey||c.selectedPanels.clear()}}if(this.drag=!0,this.activeShape&&this.activeShape.type===V.DIMENSION){var p=this.activeShape.getPosition(),v=p.x,b=p.y,g=this.coord.x-v,E=b-this.coord.y;this.dragPos={dx:g,dy:E}}else c.isMobile||s.startSelection(this.coord,ue)}}else s.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}},{key:"click",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData,s=t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{curPoint:a,viewPortData:i}),0===n){for(var c=0,l=[].concat(Object(d.a)(o.fasades),Object(d.a)(o.fasadeDimensions));c<l.length;c++){var u=l[c];if(u.isUnderCursor(this.coord,i.pixelRatio)){if(!u.state.selectable)continue;s.shiftKey&&o.selectedPanels.has(u)?o.selectedPanels.delete(u):o.selectedPanels.add(u)}else s.shiftKey||o.selectedPanels.delete(u)}o.fasades=xt(o.fasades,o.selectedPanels),r.updateState()}}},{key:"doubleClick",value:function(t){t.button;var n=t.curPoint,a=t.viewPortData;t.setViewPortData,t.appActions,t.appData,t.keys;Object(y.a)(Object(m.a)(e.prototype),"doubleClick",this).call(this,{curPoint:n,viewPortData:a})}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"up",value:function(t){var e=t.appActions;this.drag=!1,e.updateState()}},{key:"getSelectedShapeProperties",value:function(t){this.properties=[];var e=t.selectionManager.getSelectedPanels().pop();if(e){var n=e.getProperties();this.setProperties(n),this.currentObject=e}}},{key:"touchDown",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchDown",this).call(this,{pointerId:n,curPoint:a,viewPortData:i}),this.down({button:0,curPoint:a,viewPortData:i,setViewPortData:r,appActions:o,appData:s})}},{key:"touchMove",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchMove",this).call(this,{pointerId:n,curPoint:a,viewPortData:i});var c=i.touchManager;if(c.getTouchCount()>1){var l=k.distance(c.touches[0].curPoint,c.touches[1].curPoint),u=k.midPoint(c.touches[0].curPoint,c.touches[1].curPoint),h=c.prevDiff-l;if(Math.abs(h)>10){var d=Math.sign(h);this.wheel({deltaY:d,curPoint:u,viewPortData:i,setViewPortData:r}),c.prevDiff=l}}if(1===c.getTouchCount()){if(this.drag)return s.fasades.forEach(function(t){return t.state.selected=!1}),void(this.activeShape.state.selected=!0);o.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}}}]),e}(F),de=function(t){function e(t,n,a){var i;return Object(f.a)(this,e),(i=Object(v.a)(this,Object(m.a)(e).call(this,Object(h.a)({vertical:!t.vertical},e.getPoints(t,n,a))))).panel1=t,i.panel2=n,i.inside=a,i}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a,i)}},{key:"refresh",value:function(){var t=e.getPoints(this.panel1,this.panel2,this.inside);this.firstPoint=t.firstPoint,this.secondPoint=t.secondPoint,this.midPoint=t.midPoint,Object(y.a)(Object(m.a)(e.prototype),"refresh",this).call(this)}},{key:"delete",value:function(){this.panel1.dimensions.delete(this),this.panel2.dimensions.delete(this)}}],[{key:"getPoints",value:function(t,e,n){var a={},i={},r=t,o=e;return t.vertical?(t.rect.x>e.rect.x&&(r=e,o=t),a.x=n?r.rect.last.x:r.rect.x,a.y=(r.rect.last.y+r.rect.y)/2,i.x=n?o.rect.x:o.rect.last.x,i.y=(o.rect.last.y+o.rect.y)/2):(t.rect.y>e.rect.y&&(r=e,o=t),a.x=(r.rect.last.x+r.rect.x)/2,a.y=n?r.rect.last.y:r.rect.y,i.x=(o.rect.last.x+o.rect.x)/2,i.y=n?o.rect.y:o.rect.last.y),{firstPoint:a,secondPoint:i,midPoint:{x:(a.x+i.x)/2,y:(a.y+i.y)/2}}}}]),e}(ie);function fe(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return pe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pe(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var ve=function(t){function e(t,n){var a;return Object(f.a)(this,e),(a=Object(v.a)(this,Object(m.a)(e).call(this,t))).inside=n,a.setStatusBar(),a}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.isMobile?this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["gest_move"]},{text:" - ".concat(this.captions.rotate,";  "),icons:["gest_dbltap"]},{text:" - ".concat(this.captions.scale,"  "),icons:["gest_zoom"]}]:this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["rmb","mmb"]},{text:" - ".concat(this.captions.scale,"  "),icons:["mmb_wheel"]}]}},{key:"move",value:function(t){var n=this,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=(t.appActions,t.appData);t.keys;switch(Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:a,viewPortData:i}),this.clickCount<1&&o.cursor.setType(Jt.ORD),this.clickCount){case 0:case 1:var s,c=fe(o.panels);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.state.selectable&&(l!==this.firstPanel&&(this.firstPanel&&l.vertical!==this.firstPanel.vertical||l.state.measurable&&(l.isUnderCursor(this.coord,i.pixelRatio)?(l.setState({highlighted:!0}),o.cursor.setType(l.vertical?Jt.VERT:Jt.HOR)):l.setState({highlighted:!1}))))}}catch(f){c.e(f)}finally{c.f()}break;case 2:var u=de.getPoints(this.firstPanel,this.secondPanel,this.inside).midPoint,h=this.curShape.vertical?this.coord.x-u.x:this.coord.y-u.y,d=this.curShape.vertical?{x:u.x+h,y:u.y}:{x:u.x,y:u.y+h};this.curShape.setOffsetPoint(d,o.wardrobe),o.cursor.setType(this.curShape.vertical?Jt.VERT:Jt.HOR)}r(function(t){return A(n.coord,n.curPoint,t)})}},{key:"down",value:function(t){var n=this,a=t.button,i=t.curPoint,r=t.viewPortData,o=t.setViewPortData,s=t.appActions;t.appData,t.keys;Object(y.a)(Object(m.a)(e.prototype),"down",this).call(this,{curPoint:i,viewPortData:r}),o(function(t){return A(n.coord,i,t)}),1!==a||s.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}},{key:"click",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData;t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{curPoint:a,viewPortData:i}),0===n)switch(this.clickCount){case 1:case 2:this.activePanel=null,this.firstPoint=this.coord;var s,c=fe(o.panels);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.state.selectable&&(l!==this.firstPanel&&l.state.measurable&&(this.firstPanel&&l.vertical!==this.firstPanel.vertical||l.isUnderCursor(this.coord,i.pixelRatio)&&(this.activePanel=l)))}}catch(u){c.e(u)}finally{c.f()}this.activePanel?(1===this.clickCount&&(this.firstPanel=this.activePanel),2===this.clickCount&&(this.secondPanel=this.activePanel,this.curShape=new de(this.firstPanel,this.secondPanel,this.inside))):(this.clickCount=0,this.firstPanel=null);break;case 3:this.firstPanel.dimensions.add(this.curShape),this.secondPanel.dimensions.add(this.curShape),r.addDimension(this.curShape),r.cancel()}}},{key:"doubleClick",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData;t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"doubleClick",this).call(this,{curPoint:a,viewPortData:i}),0===n&&this.activePanel){if(o.material.texture)return;var s,c=fe(o.panels);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.state.selected=l===this.activePanel}}catch(u){c.e(u)}finally{c.f()}return r.repaint(),!0}}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"up",value:function(t){var e=t.button,n=t.appActions;if(2===e)return n.cancel();this.drag=!1,n.updateState()}},{key:"getSelectedShapeProperties",value:function(t){this.properties=[];var e=t.selectionManager.getSelectedPanels().pop();if(e){var n=e.getProperties();this.setProperties(n),this.currentObject=e}}},{key:"touchDown",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchDown",this).call(this,{pointerId:n,curPoint:a,viewPortData:i}),this.down({button:0,curPoint:a,viewPortData:i,setViewPortData:r,appActions:o,appData:s})}},{key:"touchMove",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchMove",this).call(this,{pointerId:n,curPoint:a,viewPortData:i});var c=i.touchManager;if(c.getTouchCount()>1){var l=k.distance(c.touches[0].curPoint,c.touches[1].curPoint),u=k.midPoint(c.touches[0].curPoint,c.touches[1].curPoint),h=c.prevDiff-l;if(Math.abs(h)>10){var d=Math.sign(h);this.wheel({deltaY:d,curPoint:u,viewPortData:i,setViewPortData:r}),c.prevDiff=l}}if(1===c.getTouchCount()){if(this.drag)return s.panels.forEach(function(t){return t.state.selected=!1}),this.activePanel.state.selected=!0,void o.movePanel(this.activePanel,this.dragPos);o.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}}}]),e}(F),ye=function(t){function e(t,n){var a;Object(f.a)(this,e);var i=n.getSingleDimensionData(t),r=i.firstPoint,o=i.secondPoint;return(a=Object(v.a)(this,Object(m.a)(e).call(this,{vertical:t,firstPoint:r,secondPoint:o}))).fasade=n,a.vertical=t,a}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(y.a)(Object(m.a)(e.prototype),"draw",this).call(this,t,n,a,i)}},{key:"refresh",value:function(){var t=this.fasade.getSingleDimensionData(this.vertical),n=t.firstPoint,a=t.secondPoint;this.firstPoint=n,this.secondPoint=a,this.midPoint={x:(this.firstPoint.x+this.secondPoint.x)/2,y:(this.firstPoint.y+this.secondPoint.y)/2},Object(y.a)(Object(m.a)(e.prototype),"refresh",this).call(this)}},{key:"delete",value:function(){this.fasade.dimensions.delete(this)}}]),e}(ie);function me(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return be(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return be(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function be(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var ge=function(t){function e(t,n){var a;return Object(f.a)(this,e),(a=Object(v.a)(this,Object(m.a)(e).call(this,t))).vertical=n,a.setStatusBar(),a}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.isMobile?this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["gest_move"]},{text:" - ".concat(this.captions.rotate,";  "),icons:["gest_dbltap"]},{text:" - ".concat(this.captions.scale,"  "),icons:["gest_zoom"]}]:this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["rmb","mmb"]},{text:" - ".concat(this.captions.scale,"  "),icons:["mmb_wheel"]}]}},{key:"move",value:function(t){var n=this,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=(t.appActions,t.appData);t.keys;switch(Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:a,viewPortData:i}),o.cursor.setType(this.vertical?Jt.VERT:Jt.HOR),this.clickCount){case 0:var s,c=me(o.fasades);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.state.selectable&&(l.isUnderCursor(this.coord,i.pixelRatio)?l.setState({highlighted:!0}):l.setState({highlighted:!1}))}}catch(d){c.e(d)}finally{c.f()}break;case 1:var u=this.vertical?this.coord.x-this.firstPoint.x:this.coord.y-this.firstPoint.y,h=this.vertical?{x:this.midPoint.x+u,y:this.midPoint.y}:{x:this.midPoint.x,y:this.midPoint.y+u};this.curShape.setOffsetPoint(h,o.wardrobe)}r(function(t){return A(n.coord,n.curPoint,t)})}},{key:"down",value:function(t){var n=this,a=t.button,i=t.curPoint,r=t.viewPortData,o=t.setViewPortData,s=t.appActions;t.appData,t.keys;Object(y.a)(Object(m.a)(e.prototype),"down",this).call(this,{curPoint:i,viewPortData:r}),o(function(t){return A(n.coord,i,t)}),1!==a||s.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}},{key:"click",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData;t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{curPoint:a,viewPortData:i}),0===n)switch(this.clickCount){case 1:this.activePanel=null;var s,c=me(o.fasades);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(l.state.selectable&&l.isUnderCursor(this.coord,i.pixelRatio)){this.activePanel=l;var u=l.getSingleDimensionData(this.vertical),h=u.firstPoint,d=u.secondPoint,f=u.midPoint;this.firstPoint=h,this.secondPoint=d,this.midPoint=f,this.curShape=new ye(this.vertical,l)}}}catch(p){c.e(p)}finally{c.f()}this.activePanel||(this.clickCount=0);break;case 2:this.activePanel.dimensions.add(this.curShape),r.addFasadeDimension(this.curShape),r.cancel()}}},{key:"doubleClick",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData;t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"doubleClick",this).call(this,{curPoint:a,viewPortData:i}),0===n&&this.activePanel){var s,c=me(o.fasades);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.state.selected=l===this.activePanel}}catch(u){c.e(u)}finally{c.f()}return r.repaint(),!0}}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"up",value:function(t){var e=t.button,n=t.appActions;if(2===e)return n.cancel();this.drag=!1,n.updateState()}},{key:"getSelectedShapeProperties",value:function(t){this.properties=[];var e=t.selectionManager.getSelectedPanels().pop();if(e){var n=e.getProperties();this.setProperties(n),this.currentObject=e}}},{key:"touchDown",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchDown",this).call(this,{pointerId:n,curPoint:a,viewPortData:i}),this.down({button:0,curPoint:a,viewPortData:i,setViewPortData:r,appActions:o,appData:s})}},{key:"touchMove",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchMove",this).call(this,{pointerId:n,curPoint:a,viewPortData:i});var c=i.touchManager;if(c.getTouchCount()>1){var l=k.distance(c.touches[0].curPoint,c.touches[1].curPoint),u=k.midPoint(c.touches[0].curPoint,c.touches[1].curPoint),h=c.prevDiff-l;if(Math.abs(h)>10){var d=Math.sign(h);this.wheel({deltaY:d,curPoint:u,viewPortData:i,setViewPortData:r}),c.prevDiff=l}}if(1===c.getTouchCount()){if(this.drag)return s.panels.forEach(function(t){return t.state.selected=!1}),this.activePanel.state.selected=!0,void o.movePanel(this.activePanel,this.dragPos);o.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}}}]),e}(F);function Ee(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return we(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return we(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function we(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Se(t,e){switch(e.type){case Ft.ADD_DIMENSION:var n=e.payload;return t.dimensions.add(n),{result:!0,newState:Object(h.a)({},t,{status:K.FREE})};case Ft.ADD_FASADE_DIMENSION:var a=e.payload;return t.fasadeDimensions.add(a),{result:!0,newState:Object(h.a)({},t,{status:K.FREE})};case Mt.ADD_PANEL:var i=e.payload;return t.panels.add(i),function(t){var e,n=bt(t);try{for(n.s();!(e=n.n()).done;){var a,i=e.value,r=bt(t);try{for(r.s();!(a=r.n()).done;){var o=a.value;i!==o&&i.vertical===o.vertical&&St(i,o)&&(i.vertical?(o.rect.x+o.thickness<=i.rect.x&&i.parallelFromBack.add(o),o.rect.x>=i.rect.x+i.thickness&&i.parallelFromFront.add(o)):(o.rect.y+o.thickness<=i.rect.y&&i.parallelFromBack.add(o),o.rect.y>=i.rect.y+i.thickness&&i.parallelFromFront.add(o)))}}catch(s){r.e(s)}finally{r.f()}}}catch(s){n.e(s)}finally{n.f()}}(t.panels),{result:!0,newState:Object(h.a)({},t)};case Ft.CREATE_DRAWER:t.selectedPanels.clear();var r=Object(h.a)({},t,{curShape:new Zt({wardrobe:t.wardrobe}),cursor:new qt(t.curRealPoint),status:K.CREATE,toolButtonsPressed:Pe({createDrawer:!0})});return{result:!0,newState:Object(h.a)({},r,{mouseHandler:new te(r,!0)})};case Ft.CREATE_DRAWERBLOCK:return t.selectedPanels.clear(),r=Object(h.a)({},t,{curShape:new $t({wardrobe:t.wardrobe}),cursor:new qt(t.curRealPoint),status:K.CREATE,toolButtonsPressed:Pe({createDrawerBlock:!0})}),{result:!0,newState:Object(h.a)({},r,{mouseHandler:new te(r,!0)})};case Ft.CREATE_PANEL:return t.panels.forEach(function(t){t.setState({selected:!1})}),t.selectedPanels.clear(),r=Object(h.a)({},t,{curShape:new zt(Object(h.a)({},e.payload,{wardrobe:t.wardrobe})),cursor:new qt(t.curRealPoint),status:K.CREATE,toolButtonsPressed:Pe({createVertical:e.payload.vertical,createHorizontal:!e.payload.vertical})}),{result:!0,newState:Object(h.a)({},r,{mouseHandler:new te(r,!0)})};case Ft.CREATE_TUBE:return t.selectedPanels.clear(),r=Object(h.a)({},t,{curShape:new Qt({wardrobe:t.wardrobe}),cursor:new qt(t.curRealPoint),status:K.CREATE,toolButtonsPressed:Pe({createTube:!0})}),{result:!0,newState:Object(h.a)({},r,{mouseHandler:new te(r,!0)})};case Ft.CREATE_FASADE_DIMENSION:return r=Object(h.a)({},t,{toolButtonsPressed:Pe({createFasadeLengthDimension:e.payload.vertical,createFasadeWidthDimension:!e.payload.vertical}),cursor:new Jt(t.curRealPoint)}),{result:!0,newState:Object(h.a)({},r,{mouseHandler:new ge(r,e.payload)})};case Ft.CREATE_SINGLE_DIMENSION:return r=Object(h.a)({},t,{toolButtonsPressed:Pe({createSingleDimension:!0}),cursor:new Jt(t.curRealPoint)}),{result:!0,newState:Object(h.a)({},r,{mouseHandler:new ce(r)})};case Ft.CREATE_TWO_PANEL_DIMENSION:return r=Object(h.a)({},t,{toolButtonsPressed:Pe({createTwoPanelDimensionInside:e.payload.inside,createTwoPanelDimensionOutside:!e.payload.inside}),cursor:new Jt(t.curRealPoint)}),{result:!0,newState:Object(h.a)({},r,{mouseHandler:new ve(r,e.payload.inside)})};case Ft.DELETE_SELECTED:var o=new Set;!function(t,e){var n,a=bt(t);try{var i=function(){var t=n.value;e.forEach(function(e){t.jointFromBackSide.delete(e),t.jointFromFrontSide.delete(e),t.parallelFromBack.delete(e),t.parallelFromFront.delete(e)})};for(a.s();!(n=a.n()).done;)i()}catch(r){a.e(r)}finally{a.f()}}(t.panels,t.selectedPanels),t.panels.forEach(function(e){t.selectedPanels.delete(e)?(e.dimensions.forEach(function(e){e.delete(),t.dimensions.delete(e)}),e.singleDimension&&(t.dimensions.delete(e.singleDimension),e.singleDimension.delete()),e.dimensions=new Set):o.add(e)});var s=new Set;return t.dimensions.forEach(function(e){t.selectedPanels.delete(e)?t.dimensions.forEach(function(t){return t.delete()}):s.add(e)}),r=Object(h.a)({},t,{panels:o,dimensions:s,mouseHandler:new _e(t),cursor:new U}),{result:!0,newState:Object(h.a)({},r)};case Ft.DELETE_SELECTED_CONFIRM:var c,l=Ee(t.selectedPanels);try{for(l.s();!(c=l.n()).done;){var u=c.value;u.type!==V.DIMENSION&&Dt(u,t.selectedPanels)}}catch(y){l.e(y)}finally{l.f()}var d={show:!0,messageKey:e.payload.isJoints?"deleteJointedPanels":"deletePanels",actions:[{caption:"OK",onClick:Ft.deleteSelected}]};return{result:!0,newState:Object(h.a)({},t,{showConfirm:d})};case Ft.DELETE_SELECTED_FASADES:var f=new Set;Ot(t.selectedPanels).forEach(function(e){return t.selectedPanels.add(e)}),t.fasades.forEach(function(e){t.selectedPanels.delete(e)?(e.dimensions.forEach(function(e){e.delete(),t.fasadeDimensions.delete(e)}),e.dimensions=new Set):f.add(e)});var p=new Set;return t.fasadeDimensions.forEach(function(e){t.selectedPanels.delete(e)?t.fasadeDimensions.forEach(function(t){return t.delete()}):p.add(e)}),r=Object(h.a)({},t,{fasades:f,fasadeDimensions:p,mouseHandler:new he(t),cursor:new U}),{result:!0,newState:Object(h.a)({},r)};case Ft.DELETE_SELECTED_FASADES_CONFIRM:return d={show:!0,messageKey:"deletePanels",actions:[{caption:"OK",onClick:Ft.deleteSelectedFasades}]},{result:!0,newState:Object(h.a)({},t,{showConfirm:d})};case Ft.DISTRIBUTE:return function(t){var e=Array.from(t);if(e[0].vertical){e.sort(function(t,e){return t.rect.x-e.rect.x}),e.forEach(function(t){return t.moveTo(-1e4,0)});for(var n=Math.round((e.at(-1).getNearest().nearestFromFront.rect.x-e.at(-1).rect.last.x)/(e.length+1)),a=e.length-1;a>=0;a--)e[a].moveTo(n*(a+1),0)}else{e.sort(function(t,e){return t.rect.y-e.rect.y}),e.forEach(function(t){return t.moveTo(0,-1e4)});for(var i=Math.round((e.at(-1).getNearest().nearestFromFront.rect.y-e.at(-1).rect.last.y)/(e.length+1)),r=e.length-1;r>=0;r--)e[r].moveTo(0,i*(r+1))}}(t.selectedPanels),{result:!0,newState:Object(h.a)({},t)};case Ft.DIVIDE_FASAD_HOR:t.selectedPanels.forEach(function(e){return e.deleteAllChildren(t)});var v=function(t,e){var n,a=new Set,i=bt(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(!(r.level>2)){r.divided=mt.HOR;for(var o=r.base===ut.DSP?1:3,s=Math.round((r.height-o*(e-1))/e),c=0,l=r.getPosition(),u={width:r.width,level:r.level+1,parent:r,base:r.base,baseColor:r.baseColor,name:"\u042d\u043b\u0435\u043c\u0435\u043d\u0442 \u0444\u0430\u0441\u0430\u0434\u0430",position:{x:l.x,y:l.y}},h=1;h<e;h++){u.height=s;var d=new mt(u);a.add(d),r.children.push(d),c+=s+o,u.position.y=l.y+c}u.height=r.height-c,u.position.y=l.y+c;var f=new mt(u);a.add(f),r.children.push(f),r.state.selectable=!1}}}catch(y){i.e(y)}finally{i.f()}return a}(t.selectedPanels,e.payload);return v.forEach(function(e){return t.fasades.add(e)}),t.selectedPanels.clear(),{result:!0,newState:Object(h.a)({},t)};case Ft.DIVIDE_FASAD_VERT:return t.selectedPanels.forEach(function(e){return e.deleteAllChildren(t)}),(v=function(t,e){var n,a=new Set,i=bt(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(!(r.level>2)){r.divided=mt.VERT;for(var o=r.base===ut.DSP?1:3,s=Math.round((r.width-o*(e-1))/e),c=0,l=r.getPosition(),u={height:r.height,level:r.level+1,parent:r,base:r.base,baseColor:r.baseColor,name:"\u042d\u043b\u0435\u043c\u0435\u043d\u0442 \u0444\u0430\u0441\u0430\u0434\u0430",position:{x:l.x,y:l.y}},h=1;h<e;h++){u.width=s;var d=new mt(u);a.add(d),r.children.push(d),c+=s+o,u.position.x=l.x+c}u.width=r.width-c,u.position.x=l.x+c;var f=new mt(u);a.add(f),r.children.push(f),r.state.selectable=!1}}}catch(y){i.e(y)}finally{i.f()}return a}(t.selectedPanels,e.payload)).forEach(function(e){return t.fasades.add(e)}),t.selectedPanels.clear(),{result:!0,newState:Object(h.a)({},t)};case Ft.FIX_MIN_LENGTH:return t.selectedPanels.forEach(function(t){t.type!==V.DIMENSION&&t.fixMinLength(e.payload)}),{result:!0,newState:Object(h.a)({},t)};case Ft.FIX_MAX_LENGTH:return t.selectedPanels.forEach(function(t){t.type!==V.DIMENSION&&t.fixMaxLength(e.payload)}),{result:!0,newState:Object(h.a)({},t)};case Ft.FIX_WIDTH:return t.selectedPanels.forEach(function(t){t.type!==V.DIMENSION&&t.fixWidth(e.payload)}),{result:!0,newState:Object(h.a)({},t)};case Ft.FIX_HEIGHT:return t.selectedPanels.forEach(function(t){t.type!==V.DIMENSION&&t.fixHeight(e.payload)}),{result:!0,newState:Object(h.a)({},t)};case Ft.MOVE_PANEL:return r=Object(h.a)({},t,{curShape:e.payload.panel}),{result:!0,newState:Object(h.a)({},r,{mouseHandler:new ae(r,!1,e.payload.movePoint)})};case Ft.SELECT_PARENT:return e.payload.parent.state.hidden=!1,t.selectedPanels.clear(),t.selectedPanels.add(e.payload.parent),t.fasades=xt(t.fasades,t.selectedPanels),{result:!0,newState:Object(h.a)({},t)};case Ft.SET_PANEL_STATE:return t.selectedPanels.forEach(function(t){t.type!==V.DIMENSION&&t.setState(e.payload)}),{result:!0,newState:Object(h.a)({},t)};case Ft.SET_PROPERTY:return t.selectedPanels.forEach(function(t){t.type!==V.DIMENSION&&t.setProperty(e.payload)}),{result:!0,newState:Object(h.a)({},t)};case Mt.SELECT_PANEL:return{result:!0,newState:Object(h.a)({},t,{selectedPanels:e.payload})};default:return{result:!1,newState:t}}}function Pe(t){return Object(h.a)({buttonPressed:{createVertical:!1,createHorizontal:!1,createDrawer:!1,createTube:!1,createSingleDimension:!1,createTwoPanelDimensionInside:!1,createTwoPanelDimensionOutside:!1,createFasadeLengthDimension:!1,createFasadeWidthDimension:!1}},t)}var Oe={name:"",activated:!1},xe=localStorage.getItem("token")||sessionStorage.getItem("token");if(!xe){var De=document.cookie.split("; ").map(function(t){return t.split("=")}).find(function(t){return"token"===t[0]});Array.isArray(De)&&(xe=De[1])}xe&&((Oe=Object(at.a)(xe)).token=xe);var Te={CORPUS:"CORPUS",FASADES:"FASADES"};function ke(t){var e=function(t){var e=t.wardrobe;if(!e)return{wardrobe:{},panels:[]};var n,a=e.double?e.width/2:e.width,i={fixed_move:!0,fixed_minlength:!0,fixable:!1,deletable:!1,resizeable:!1,drillable:!1,gabarit:!0};return e.double?(e.width1=a,e.width2=a,(n=[new zt(Object(h.a)({id:0,wardrobe:e,name:"\u041a\u0440\u044b\u0448\u0430",length:a,vertical:!1,position:{x:0,y:e.height-16}},i)),new zt(Object(h.a)({id:1,wardrobe:e,name:"\u041a\u0440\u044b\u0448\u0430",length:a,vertical:!1,position:{x:a,y:e.height-16}},i)),new zt(Object(h.a)({id:2,wardrobe:e,name:"\u0414\u043d\u043e",length:a,vertical:!1,position:{x:0,y:30}},i)),new zt(Object(h.a)({id:3,wardrobe:e,name:"\u0414\u043d\u043e",length:a,vertical:!1,position:{x:a,y:30}},i)),new zt(Object(h.a)({id:4,wardrobe:e,name:"\u0421\u0442\u043e\u0439\u043a\u0430 \u0431\u043e\u043a\u043e\u0432\u0430\u044f",length:e.height-32-30,vertical:!0,position:{x:0,y:46}},i)),new zt(Object(h.a)({id:5,wardrobe:e,name:"\u0421\u0442\u043e\u0439\u043a\u0430 \u0431\u043e\u043a\u043e\u0432\u0430\u044f",length:e.height-32-30,vertical:!0,position:{x:2*a-16,y:46}},i)),new Xt(Object(h.a)({id:6,wardrobe:e,name:"\u0421\u0442\u043e\u0439\u043a\u0430 \u0432\u043d\u0443\u0442\u0440",length:e.height-32-30,vertical:!0,position:{x:a-16,y:46}},i,{fixable:!0,gabarit:!0}))])[0].jointFromBackSide=new Set([n[4],n[6]]),n[0].parallelFromBack=new Set([n[2]]),n[1].jointFromBackSide=new Set([n[5],n[6]]),n[1].parallelFromBack=new Set([n[3]]),n[2].jointFromFrontSide=new Set([n[4],n[6]]),n[2].parallelFromFront=new Set([n[0]]),n[3].jointFromFrontSide=new Set([n[5],n[6]]),n[3].parallelFromFront=new Set([n[1]]),n[4].jointFromFrontSide=new Set([n[0],n[2]]),n[4].parallelFromFront=new Set([n[6]]),n[5].jointFromBackSide=new Set([n[1],n[3]]),n[5].parallelFromBack=new Set([n[6]]),n[4].jointToFront=n[2],n[4].jointToBack=n[0],n[5].jointToFront=n[3],n[5].jointToBack=n[1],n[6].jointFromBackSide=new Set([n[0],n[2]]),n[6].parallelFromBack=new Set([n[4]]),n[6].jointFromFrontSide=new Set([n[1],n[3]]),n[6].parallelFromFront=new Set([n[5]]),n[6].jointToFront=n[2],n[6].jointToBack=n[0]):((n=[new zt(Object(h.a)({id:0,wardrobe:e,name:"\u041a\u0440\u044b\u0448\u0430",length:a,vertical:!1,position:{x:0,y:e.height-16}},i)),new zt(Object(h.a)({id:1,wardrobe:e,name:"\u0414\u043d\u043e",length:a,vertical:!1,position:{x:0,y:30}},i)),new zt(Object(h.a)({id:2,wardrobe:e,name:"\u0421\u0442\u043e\u0439\u043a\u0430 \u0431\u043e\u043a\u043e\u0432\u0430\u044f",length:e.height-32-30,vertical:!0,position:{x:0,y:46}},i)),new zt(Object(h.a)({id:3,wardrobe:e,name:"\u0421\u0442\u043e\u0439\u043a\u0430 \u0431\u043e\u043a\u043e\u0432\u0430\u044f",length:e.height-32-30,vertical:!0,position:{x:a-16,y:46}},i))])[0].jointFromBackSide=new Set([n[2],n[3]]),n[0].parallelFromBack=new Set([n[1]]),n[1].jointFromFrontSide=new Set([n[2],n[3]]),n[1].parallelFromFront=new Set([n[0]]),n[2].jointFromFrontSide=new Set([n[0],n[1]]),n[2].parallelFromFront=new Set([n[3]]),n[2].jointToFront=n[1],n[2].jointToBack=n[0],n[3].jointFromBackSide=new Set([n[0],n[1]]),n[3].parallelFromBack=new Set([n[2]]),n[3].jointToFront=n[1],n[3].jointToBack=n[0]),{wardrobe:e,panels:n}}(t),n=e.wardrobe,a=e.panels,i=Yt({wardrobe:n}),r={};return ht().forEach(function(t){return r[t]=[]}),{workspace:Te.CORPUS,cursor:new U({x:0,y:0}),curShape:null,prevStatus:K.FREE,selectedPanels:new Et,dimensions:new Set,fasades:new Set(i),fasadeDimensions:new Set,panels:new Set(a),deleteConfirm:!0,getViewportData:!1,wardrobe:n,toolButtonsPressed:Pe(),information:{order:"",plan:"",currentDate:G()},materials:{DSP:["\u0432\u0435\u043d\u0433\u0435 \u043c\u0430\u0433\u0438\u044f","\u0434\u0443\u0431 \u0441\u043e\u043d\u043e\u043c\u0430","\u0431\u0435\u043b\u044b\u0439110"],MIRROR:[""],fasadBases:ht(),activeDSPColor:n.dspCorpus},resetView:a.length>0,showLoading:!1,showConfirm:{show:!1,message:""},showAlert:{show:!1,message:""},showDialog:{show:!1},status:K.FREE,statusBar:5,statusParams:{creator:null,picker:null},viewPortData:Vt(),isMobile:z(),captions:nt,user:Oe}}function je(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function Re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Ae(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.fillStyle="white",t.lineWidth=1,t.lineJoin="round",t.strokeStyle="black",t.fillRect(0,0,e.viewPortWidth,e.viewPortHeight);var i,r=e.topLeft,o=e.bottomRight,s=e.viewPortWidth,c=e.viewPortHeight,l=e.marginRight,u=e.marginTop,h=e.marginLeft,d=e.marginBottom,f=L(r,o),p=I(s,c),v=n.workspace===Te.CORPUS?[n.panels,n.dimensions]:[n.fasades,n.fasadeDimensions],y=Object(J.a)(v,2),m=y[0],b=je(y[1]);try{for(b.s();!(i=b.n()).done;){i.value.draw(t,f,p,a)}}catch(P){b.e(P)}finally{b.f()}var g,E=je(m);try{for(E.s();!(g=E.n()).done;){var w=g.value;w.hasChildren()&&!n.selectedPanels.has(w)&&0!==w.level||w.draw(t,f,p,a,n.captions)}}catch(P){E.e(P)}finally{E.f()}var S=n.mouseHandler.curShape;null!=S&&S.draw(t,f,p),null!=n.curShape&&n.curShape.draw(t,f,p),t.lineWidth=1,t.setLineDash(B.SOLID),t.fillStyle="white",a||(t.fillRect(0,0,s-l,u),t.fillRect(0,0,h,c),t.fillRect(s-l,0,s,c),t.fillRect(h,c-d,s-l,c-u),t.strokeStyle="black",t.strokeRect(h,u,s-l-h,c-d-u),t.lineWidth=1,!n.isMobile&&n.mouseHandler.mouseOnScreen&&(n.cursor.setPosition(e.curRealPoint),n.cursor.draw(t,f,p)))}function Ce(t,e,n,a,i){var r=n.x,o=n.y,s=i,c=a/2;e?(t.moveTo(r+.5,o-c+.5),t.lineTo(r+.5,o+c+.5),t.moveTo(r+.5,o-c+.5),t.lineTo(r+.5-s,o-c+.5+s),t.moveTo(r+.5,o-c+.5),t.lineTo(r+.5+s,o-c+.5+s),t.moveTo(r+.5,o+c+.5),t.lineTo(r+.5-s,o+c+.5-s),t.moveTo(r+.5,o+c+.5),t.lineTo(r+.5+s,o+c+.5-s)):(t.moveTo(r-c+.5,o+.5),t.lineTo(r+c+.5,o+.5),t.moveTo(r-c+.5,o+.5),t.lineTo(r-c+.5+s,o+.5-s),t.moveTo(r-c+.5,o+.5),t.lineTo(r-c+.5+s,o+.5+s),t.moveTo(r+c+.5,o+.5),t.lineTo(r+c+.5-s,o+.5-s),t.moveTo(r+c+.5,o+.5),t.lineTo(r+c+.5-s,o+.5+s))}var Le=function(t){function e(t,n){var a;return Object(f.a)(this,e),(a=Object(v.a)(this,Object(m.a)(e).call(this,t))).vertical=!n,a}return Object(b.a)(e,t),Object(p.a)(e,[{key:"draw",value:function(t,e,n){this.refresh(e,n),t.strokeStyle=this.getStyle().getColor(),t.setLineDash(this.getStyle().getStroke()),t.lineWidth=2,t.beginPath(),Ce(t,this.vertical,this.p0,30,6),t.stroke()}}]),e}(W),Ie=function(t){function e(t,n){var a;return Object(f.a)(this,e),(a=Object(v.a)(this,Object(m.a)(e).call(this,n))).x0=t.x,a.y0=t.y,a.curShape=new le(new x),a.curShape.setStyle(new B(H.BLACK,B.DASH)),a.setStatusBar(),a}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.statusBar=[]}},{key:"move",value:function(t){var n,a=this,i=t.curPoint,r=t.viewPortData,o=t.setViewPortData,s=t.appData;t.keys;Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:i,viewPortData:r}),o(function(t){return A(a.coord,a.curPoint,t)}),this.coord.x>this.x0?(this.curShape.style.setStroke(B.SOLID),n=!1):(this.curShape.style.setStroke(B.DASH),n=!0),this.curShape.setCorners({x:this.x0,y:this.y0},this.coord),this.selectPanels({topLeft:this.curShape.model.topLeft,bottomRight:this.curShape.model.bottomRight},s.panels,s.dimensions,s.selectedPanels,n)}},{key:"up",value:function(t){t.button,t.appActions}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"click",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData,s=t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{curPoint:a,viewPortData:i}),0===n){for(var c=0,l=[].concat(Object(d.a)(o.panels),Object(d.a)(o.dimensions));c<l.length;c++){var u=l[c];u.isUnderCursor(this.coord,i.pixelRatio)?s.shiftKey&&o.selectedPanels.has(u)?o.selectedPanels.delete(u):o.selectedPanels.add(u):s.shiftKey||this.isSelectedPanels||o.selectedPanels.delete(u)}this.isSelectedPanels=o.selectedPanels.size>0,0===n&&r.stopSelection(this.isSelectedPanels,_e),r.updateState()}}},{key:"leave",value:function(t){var n=t.appActions;Object(y.a)(Object(m.a)(e.prototype),"leave",this).call(this),n.cancel()}},{key:"selectPanels",value:function(t,e,n,a,i){this.isSelectedPanels=!1;for(var r=0,o=[].concat(Object(d.a)(e),Object(d.a)(n));r<o.length;r++){var s=o[r],c=s.isInSelectionRect(t),l=c.full,u=c.cross;l&&(a.add(s),this.isSelectedPanels=!0),u&&i&&(a.add(s),this.isSelectedPanels=!0)}}}]),e}(F),_e=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,t))).setStatusBar(),n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.isMobile?this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["gest_move"]},{text:" - ".concat(this.captions.rotate,";  "),icons:["gest_dbltap"]},{text:" - ".concat(this.captions.scale,"  "),icons:["gest_zoom"]}]:this.statusBar=[{text:" - ".concat(this.captions.move,";  "),icons:["rmb","mmb"]},{text:" - ".concat(this.captions.scale,"  "),icons:["mmb_wheel"]}]}},{key:"move",value:function(t){var n=this,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:a,viewPortData:i}),this.drag)return s.selectedPanels.add(this.activeShape),void(this.activeShape.state.fixed||o.movePanel(this.activeShape,this.dragPos));this.activeShape=null;for(var c=0,l=[].concat(Object(d.a)(s.panels),Object(d.a)(s.dimensions));c<l.length;c++){var u=l[c];u.state.selectable&&(u.isUnderCursor(this.coord,i.pixelRatio)?(u.state.fixed_move||o.setCursor(new Le(this.coord,u.vertical)),u.setState({highlighted:!0}),this.activeShape=u):u.setState({highlighted:!1}))}this.activeShape||o.setCursor(new U(this.coord)),r(function(t){return A(n.coord,n.curPoint,t)})}},{key:"down",value:function(t){var n=this,a=t.button,i=t.curPoint,r=t.viewPortData,o=t.setViewPortData,s=t.appActions,c=t.appData,l=t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"down",this).call(this,{curPoint:i,viewPortData:r}),o(function(t){return A(n.coord,i,t)}),1!==a&&2!==a){if(0===a){this.activeShape=null;for(var u=0,h=[].concat(Object(d.a)(c.panels),Object(d.a)(c.dimensions));u<h.length;u++){var f=h[u];f.state.selectable&&(f.isUnderCursor(this.coord,r.pixelRatio)&&(this.activeShape=f,f.state.selected||l.shiftKey||c.selectedPanels.clear()))}if(this.drag=!1,this.activeShape){var p=this.activeShape.getPosition(),v=p.x,b=p.y,g=this.coord.x-v,E=b-this.coord.y;this.drag=!0,this.dragPos={dx:g,dy:E}}else c.isMobile||s.startSelection(this.coord,Ie)}}else s.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}},{key:"click",value:function(t){var n=t.button,a=t.curPoint,i=t.viewPortData,r=(t.setViewPortData,t.appActions),o=t.appData,s=t.keys;if(Object(y.a)(Object(m.a)(e.prototype),"click",this).call(this,{curPoint:a,viewPortData:i}),0===n){for(var c=0,l=[].concat(Object(d.a)(o.panels),Object(d.a)(o.dimensions));c<l.length;c++){var u=l[c];u.isUnderCursor(this.coord,i.pixelRatio)?s.shiftKey&&o.selectedPanels.has(u)?o.selectedPanels.delete(u):o.selectedPanels.add(u):s.shiftKey||o.selectedPanels.delete(u)}r.updateState()}}},{key:"doubleClick",value:function(t){t.button;var n=t.curPoint,a=t.viewPortData;t.setViewPortData,t.appActions,t.appData,t.keys;Object(y.a)(Object(m.a)(e.prototype),"doubleClick",this).call(this,{curPoint:n,viewPortData:a})}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"up",value:function(t){var e=t.appActions;this.drag=!1,e.updateState()}},{key:"getSelectedShapeProperties",value:function(t){this.properties=[];var e=t.selectionManager.getSelectedPanels().pop();if(e){var n=e.getProperties();this.setProperties(n),this.currentObject=e}}},{key:"touchDown",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchDown",this).call(this,{pointerId:n,curPoint:a,viewPortData:i}),this.down({button:0,curPoint:a,viewPortData:i,setViewPortData:r,appActions:o,appData:s})}},{key:"touchMove",value:function(t){var n=t.pointerId,a=t.curPoint,i=t.viewPortData,r=t.setViewPortData,o=t.appActions,s=t.appData;Object(y.a)(Object(m.a)(e.prototype),"touchMove",this).call(this,{pointerId:n,curPoint:a,viewPortData:i});var c=i.touchManager;if(c.getTouchCount()>1){var l=k.distance(c.touches[0].curPoint,c.touches[1].curPoint),u=k.midPoint(c.touches[0].curPoint,c.touches[1].curPoint),h=c.prevDiff-l;if(Math.abs(h)>10){var d=Math.sign(h);this.wheel({deltaY:d,curPoint:u,viewPortData:i,setViewPortData:r}),c.prevDiff=l}}if(1===c.getTouchCount()){if(this.drag)return s.panels.forEach(function(t){return t.state.selected=!1}),this.activeShape.state.selected=!0,void o.movePanel(this.activeShape,this.dragPos);o.setScreenStatus(K.PAN,{startPoint:this.coord,prevStatus:K.FREE,prevMouseHandler:this})}}}]),e}(F),Ne=function(t){function e(t){var n;return Object(f.a)(this,e),(n=Object(v.a)(this,Object(m.a)(e).call(this,t.state))).startPoint=t.startPoint,n.setStatusBar(),n}return Object(b.a)(e,t),Object(p.a)(e,[{key:"setStatusBar",value:function(){this.statusBar=[]}},{key:"move",value:function(t){var n=t.curPoint,a=t.viewPortData,i=t.setViewPortData,r=t.appData;Object(y.a)(Object(m.a)(e.prototype),"move",this).call(this,{curPoint:n,viewPortData:a});var o=this.coord.x-this.startPoint.x,s=this.coord.y-this.startPoint.y,c=L(a.topLeft,a.bottomRight),l=I(a.viewPortWidth,a.viewPortHeight),u=k.realToScreen({x:o,y:r.wardrobe.height},c,l),h=k.realToScreen({x:r.wardrobe.width+o,y:0},c,l),d={x:0,y:0},f=u.x<a.viewPortWidth/2&&o>0||h.x>a.viewPortWidth/2&&o<0,p=u.y<a.viewPortHeight/2&&s<0||h.y>a.viewPortHeight/2&&s>0;d.x=f?a.topLeft.x-o:a.topLeft.x,d.y=p?a.topLeft.y-s:a.topLeft.y,i(function(t){return C(d,t)});var v={x:f?this.startPoint.x:this.coord.x,y:p?this.startPoint.y:this.coord.y};i(function(t){return A(v,n,t)})}},{key:"up",value:function(t){var e=t.button,n=t.appActions;1!==e&&2!==e||n.setPrevStatus()}},{key:"wheel",value:function(){}},{key:"keypress",value:function(t){return Object(y.a)(Object(m.a)(e.prototype),"keypress",this).call(this,t)}},{key:"leave",value:function(t){var n=t.appActions;Object(y.a)(Object(m.a)(e.prototype),"leave",this).call(this),n.setPrevStatus()}},{key:"touchUp",value:function(t){var n=t.pointerId,a=t.appActions,i=t.viewPortData;Object(y.a)(Object(m.a)(e.prototype),"touchUp",this).call(this,{pointerId:n,viewPortData:i}),a.setPrevStatus()}},{key:"touchMove",value:function(t){t.pointerId;var e=t.curPoint,n=t.viewPortData,a=t.setViewPortData,i=t.appActions,r=t.appData;this.move({curPoint:e,viewPortData:n,setViewPortData:a,appActions:i,appData:r})}}]),e}(F);var Me=n(56),Fe=n.n(Me),He=n(57),Be=n.n(He),Ve=ot.NUMBER,We=ot.INTEGER_NUMBER,Ue=ot.INTEGER_POSITIVE_NUMBER;function Ke(t){var e=Object(a.useState)({value:t.value,prevValue:t.value}),n=Object(J.a)(e,2),r=n[0],o=n[1],s=t.type===Ve||t.type===We||t.type===Ue;Object(a.useEffect)(function(){o({prevValue:t.value,value:t.value})},[t.value]);var c=(r.value!==r.prevValue?"input-cell-incorrect":"input-cell")+(t.active?" active-input":"");return i.a.createElement("input",{type:"text",className:c,disabled:t.disabled,value:r.value,onKeyPress:function(e){var n,a;n=e.key,a=e.target.value,"Enter"===n&&(Ge(a,t.type,t.max,t.min).correct&&""!==a?(t.setValue(r.value),o(Object(h.a)({},r,{prevValue:r.value}))):(s||t.setValue(a),o(Object(h.a)({},r,{value:s?r.prevValue:a})))),e.stopPropagation()},onKeyDown:function(t){t.stopPropagation()},onBlur:function(){o(Object(h.a)({},r,{value:r.prevValue}))},onChange:function(e){!function(e){if(""!==e){var n=Ge(e,t.type),a=n.value,i=n.correct;s&&(a=+a),i&&o(Object(h.a)({},r,{value:a}))}else o(Object(h.a)({},r,{value:e}))}(e.target.value)},onFocus:function(){t.onFocus&&t.onFocus()}})}function Ge(t,e,n,a){var i=st[e],r={value:t,correct:!1};return null==="".concat(t).match(i)&&""!==t||(r.correct=!0),void 0!==a&&(r.correct=t>=a),void 0!==n&&(r.correct=r.correct&&t<=n),r}function ze(t){var e=Object(a.useRef)(),n=function(t){var e=Object(a.useState)({drag:!1,x0:0,y0:0}),n=Object(J.a)(e,2),i=n[0],r=n[1];return{onPointerDown:function(t){var e=t.target.getBoundingClientRect();r({drag:!0,x0:t.clientX-e.left,y0:t.clientY-e.top})},onPointerMove:function(e){if(i.drag){var n=e.target.getBoundingClientRect(),a=getComputedStyle(t.current),r=e.clientX-n.left-i.x0+parseInt(a.left),o=e.clientY-n.top-i.y0+parseInt(a.top);t.current.style.left="".concat(r,"px"),t.current.style.top="".concat(o,"px")}},onPointerLeave:function(){r({drag:!1})},onPointerUp:function(){r({drag:!1})}}}(e),r=n.onPointerDown,o=n.onPointerMove,s=n.onPointerLeave,c=n.onPointerUp;return i.a.createElement("div",{className:"modal-container noselect",onClick:_t.blink},i.a.createElement("div",{ref:e,className:"toolbar-modal shadow-box",style:t.wide?{display:"block",width:"100%"}:{},onClick:function(t){t.stopPropagation()}},i.a.createElement("div",{style:{maxWidth:"400px",wordWrap:"break-word",textAlign:"center"},onPointerDown:r,onPointerMove:o,onPointerLeave:s,onPointerUp:c},t.header),t.children))}function Xe(t){var e=t.items.map(function(e,n){return i.a.createElement("option",{key:n,selected:t.value===e},e)});return i.a.createElement(i.a.Fragment,null,t.title?i.a.createElement("span",null,t.title):i.a.createElement(i.a.Fragment,null),i.a.createElement("select",{className:"combobox",size:t.size?t.size:1,disabled:t.disabled,onChange:function(e){var n=t.items.findIndex(function(t){return t===e.target.value})||0;t.onChange(n,e.target.value)}},e))}var Ye=ot.INTEGER_POSITIVE_NUMBER;function Je(t){var e=t.start,n=void 0!==e&&e,r=Bt(),o=Object(c.c)(function(t){return t}),s=o.captions.toolbars.project.wardrobe,l=o.captions.toolbars.info.materials,u=o.materials.DSP.map(function(t){return t.name}),d=ht(),f=d.map(function(t){return o.captions.toolbars.info.materials.fasadBases[t]}),p=Object(a.useState)({width:2400,depth:600,height:2400,double:!1,fasadeCount:2,dspCorpus:u[0],fasadeBaseIndex:0,fasadeBaseColorIndex:0}),v=Object(J.a)(p,2),y=v[0],m=y.width,b=y.depth,g=y.height,E=y.double,w=y.fasadeCount,S=y.dspCorpus,P=y.fasadeBaseIndex,O=y.fasadeBaseColorIndex,x=v[1],D=o.materials[d[P]].map(function(t){return t.name}),T=E?s.type.double:s.type.single;return i.a.createElement(ze,{header:o.captions.toolbars.project.new},i.a.createElement("div",{className:"newproject-content"},i.a.createElement("div",null,s.width),i.a.createElement(Ke,{type:Ye,value:m,max:5e3,min:900,setValue:function(t){return x(function(e){return Object(h.a)({},e,{width:+t})})}}),i.a.createElement("div",null,s.depth),i.a.createElement(Ke,{type:Ye,value:b,max:700,min:400,setValue:function(t){return x(function(e){return Object(h.a)({},e,{depth:+t})})}}),i.a.createElement("div",null,s.height),i.a.createElement(Ke,{type:Ye,value:g,max:3e3,min:2e3,setValue:function(t){return x(function(e){return Object(h.a)({},e,{height:+t})})}}),i.a.createElement(Xe,{title:s.type.type,items:[s.type.single,s.type.double],value:T,onChange:function(t){return x(function(e){return Object(h.a)({},e,{double:!!t})})}}),i.a.createElement(Xe,{title:s.fasadeCount,items:[2,3,4],value:w,onChange:function(t,e){return x(function(t){return Object(h.a)({},t,{fasadeCount:+e})})}}),i.a.createElement(Xe,{title:l.dspMainColor,items:u,value:S,onChange:function(t,e){return x(function(t){return Object(h.a)({},t,{dspCorpus:e})})}}),i.a.createElement(Xe,{title:l.fasadBase,items:f,value:f[P],onChange:function(t){return x(function(e){return Object(h.a)({},e,{fasadeBaseIndex:t})})}}),i.a.createElement(Xe,{title:l.fasadBaseColor,items:D,value:D[O],onChange:function(t){return x(function(e){return Object(h.a)({},e,{fasadeBaseColorIndex:t})})}})),i.a.createElement("div",{className:"flex-center"},i.a.createElement("button",{onClick:function(){return r.newProject({wardrobe:{width:m,depth:b,height:g,double:E,fasadeCount:w,dspCorpus:S,fasadeBase:d[P],fasadeBaseColor:D[O]}})}},"OK"),n?i.a.createElement(i.a.Fragment,null):i.a.createElement("button",{onClick:function(){return r.showDialog(!1)}},o.captions.buttons.cancel)))}function qe(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return $e(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $e(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function $e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var Ze=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[""],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{vertical:t.CENTER,horizontal:t.CENTER},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.NORMAL;Object(f.a)(this,t),this.p=a,this.text=e,this.anchor=i,this.lineBreak=0,this.underlines=n,this.width=0,this.height=0,this.weight=r}return Object(p.a)(t,[{key:"draw",value:function(e,n){var a=this.height,i=this.getTextRect(e,n).width,r=0,o=0;switch(this.anchor.horizontal){case t.CENTER:r=this.basePoint.x-i/2;break;case t.LEFT:r=this.basePoint.x+2;break;case t.RIGHT:r=this.basePoint.x-i-2}switch(this.anchor.vertical){case t.CENTER:o=this.basePoint.y;break;case t.TOP:o=this.basePoint.y-a/2;break;case t.BOTTOM:o=this.basePoint.y}var s=this.weight===t.BOLD?"bold ":"";e.font=s+"".concat(n,"px serif"),e.lineWidth=1;var c,l=qe(this.text);try{for(l.s();!(c=l.n()).done;){var u=c.value;e.fillStyle="black",e.fillText(u,r,o),o+=this.singleTextLineHeight+this.lineBreak-2}}catch(h){l.e(h)}finally{l.f()}o=this.basePoint.y,this.underlines.reduce(function(t,n){return o+=n+t,e.beginPath(),e.lineWidth=n,e.moveTo(r,Math.trunc(o)+.5),e.lineTo(r+i,Math.trunc(o)+.5),e.stroke(),n},0)}},{key:"getTextRect",value:function(e,n){var a=this.weight===t.BOLD?"bold ":"";e.font=a+"".concat(n,"px serif");var i,r,o=0,s=0,c=0,l=qe(this.text);try{for(l.s();!(r=l.n()).done;){var u=r.value,h=e.measureText(u);o<h.width&&(o=h.width),s+=c=h.actualBoundingBoxAscent+h.fontBoundingBoxDescent}}catch(f){l.e(f)}finally{l.f()}var d=this.underlines.length>0?this.underlines.reduce(function(t,e){return t+e},0):0;return i=s,s+=(this.text.length-1)*this.lineBreak+d,{width:o=Math.trunc(o),height:s=Math.trunc(s),textHeight:i,singleTextLineHeight:c=Math.trunc(c),underlineHeight:d}}},{key:"setText",value:function(t){this.text=t}},{key:"setFont",value:function(t){this.font=t}},{key:"setPoint",value:function(t){this.p=t}},{key:"setBasePoint",value:function(t){this.basePoint=Object(h.a)({},t,{y:t.y})}},{key:"setAnchor",value:function(t){this.anchor=Object(h.a)({},this.anchor,t)}},{key:"setDimensions",value:function(t,e,n,a){this.width=t,this.height=e,this.textHeight=n,this.singleTextLineHeight=a}}]),t}();Ze.CENTER="center",Ze.LEFT="left",Ze.RIGHT="right",Ze.TOP="top",Ze.BOTTOM="bottom",Ze.BOLD=2,Ze.NORMAL=1;var Qe=function(){function t(e){var n=e.text,a=e.underlines,i=void 0===a?[]:a,r=e.frame,o=void 0===r||r,s=e.padding,c=void 0===s?2:s,l=e.align,u=void 0===l?Ze.CENTER:l,h=e.weight,d=void 0===h?Ze.NORMAL:h;Object(f.a)(this,t),this.topLeft={x:0,y:0},this.align=u,this.caption=n,this.captionShape=new Ze(this.caption,i,null,null,d),this.padding=c,this.frame=o}return Object(p.a)(t,[{key:"draw",value:function(t,e){var n,a;if(this.width)n=this.width,a=this.height;else{var i=this.getOwnDimensions(t,e);n=i.width,a=i.height}var r={};switch(this.align){case Ze.CENTER:r={x:this.topLeft.x+n/2,y:this.topLeft.y+a/2};break;case Ze.LEFT:r={x:this.topLeft.x,y:this.topLeft.y+a/2};break;case Ze.RIGHT:r={x:this.topLeft.x+n,y:this.topLeft.y+a/2}}r.y=this.topLeft.y+this.singleTextLineHeight,this.captionShape.setBasePoint(r),this.captionShape.setAnchor({horizontal:this.align,vertical:Ze.CENTER}),this.captionShape.draw(t,e),t.lineWidth=1,this.frame&&t.strokeRect(Math.trunc(this.topLeft.x)+.5,Math.trunc(this.topLeft.y)+.5,Math.trunc(n),Math.trunc(a))}},{key:"setPosition",value:function(t,e){this.topLeft={x:t,y:e}}},{key:"setAlign",value:function(t){this.align=t}},{key:"setText",value:function(t){this.caption.setText(t)}},{key:"setFont",value:function(t){this.fontSize=t}},{key:"getOwnDimensions",value:function(t,e){t.font="".concat(e,"px serif");var n=this.captionShape.getTextRect(t,e),a=n.width,i=n.height,r=n.textHeight,o=n.singleTextLineHeight,s=n.underlineHeight;return{width:a+=2*this.padding,height:i+=2*this.padding,textHeight:r,singleTextLineHeight:o,underlineHeight:s}}},{key:"setDimensions",value:function(t,e,n,a){this.width=t,this.height=e,this.textHeight=n,this.singleTextLineHeight=a,this.captionShape.setDimensions(t,e,n,a)}},{key:"getDimensions",value:function(t){return this.width?{width:this.width,height:this.height}:this.getOwnDimensions(t)}}]),t}();function tn(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return en(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return en(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function en(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var nn=function(){function t(e){Object(f.a)(this,t),this.table=e,this.tableRows=[],this.rowCount=e.length,this.colCount=e[0].length,this.topLeft={x:0,y:0};var n,a=tn(e);try{for(a.s();!(n=a.n()).done;){var i,r=n.value,o=[],s=tn(r);try{for(s.s();!(i=s.n()).done;){var c=i.value;o.push(new Qe(c))}}catch(l){s.e(l)}finally{s.f()}this.tableRows.push(o)}}catch(l){a.e(l)}finally{a.f()}}return Object(p.a)(t,[{key:"draw",value:function(t,e){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getMaxCellDimensions(t,e),r=i.maxColWidth,o=i.maxRowHeight,s=i.maxRowTextHeight,c=i.maxSingleTextLineHeight,l=i.maxRowUnderlineHeight,u=this.topLeft.y;this.tableRows.forEach(function(i,h){var d=0,f=c[h],p=l[h],v=o[h]+p,y=s[h];i.forEach(function(a,i){var o=r[i];a.setPosition(n.topLeft.x+d,u),a.setDimensions(o,v,y,f),a.draw(t,e),d+=o}),a&&a.pageHeight-u<v?a.onEndPage&&(a.onEndPage(),t.clearRect(0,0,900,900),u=a.topMargin):u+=v}),a.onEndPage&&a.onEndPage(!1)}},{key:"getMaxCellDimensions",value:function(t,e){var n=Array(this.colCount).fill(0),a=Array(this.rowCount).fill(0),i=Array(this.rowCount).fill(0),r=Array(this.rowCount).fill(0),o=Array(this.rowCount).fill(0);return this.tableRows.forEach(function(s,c){s.forEach(function(s,l){var u=s.getOwnDimensions(t,e),h=u.width,d=u.height,f=u.textHeight,p=u.singleTextLineHeight,v=u.underlineHeight;n[l]<h&&(n[l]=h),a[c]<d&&(a[c]=d),i[c]<f&&(i[c]=f),r[c]<v&&(r[c]=v),o[c]<p&&(o[c]=p)})}),{maxColWidth:n,maxRowHeight:a,maxRowTextHeight:i,maxSingleTextLineHeight:o,maxRowUnderlineHeight:r}}},{key:"getTableDimensions",value:function(t,e){var n=this.getMaxCellDimensions(t,e),a=n.maxColWidth,i=n.maxRowHeight,r=n.maxRowUnderlineHeight,o=a.reduce(function(t,e){return t+e},0),s=0;return i.forEach(function(t,e){return s+=t+r[e]}),{totalWidth:o,totalHeight:s}}},{key:"setPosition",value:function(t,e){this.topLeft={x:t,y:e}}}]),t}();function an(t,e){for(var n=[],a=Object(h.a)({},t),i=0,r=[Te.CORPUS,Te.FASADES];i<r.length;i++){var o=r[i];a.workspace=o;var s=document.createElement("canvas");s.setAttribute("width","".concat(1782)),s.setAttribute("height","".concat(1260)),s.style.width="".concat(891,"px"),s.style.height="".concat(630,"px");var c=s.getContext("2d");c.scale(2,2);var l=a.wardrobe,u=a.captions.print.dataTable,d=a.wardrobe.double?" (".concat(a.wardrobe.width1,"+").concat(a.wardrobe.width2,")"):"",f=a.materials,p=[[{text:[u.title],frame:!1,align:"left",weight:Ze.BOLD}],[{text:[u.gabarits],frame:!0,weight:Ze.BOLD}],[{text:["  ".concat(u.width," ").concat(l.width," ").concat(d)],frame:!0,align:"left"}],[{text:["  ".concat(u.depth," ").concat(l.depth)],frame:!0,align:"left"}],[{text:["  ".concat(u.height," ").concat(l.height)],frame:!0,align:"left"}],[{text:[u.DSPcolor],frame:!0,align:"left",weight:Ze.BOLD}],[{text:["  ".concat(u.DSPcorpus," ").concat(f.activeDSPColor)],frame:!0,align:"left"}],[{text:["  ".concat(u.DSPext)],frame:!0,align:"left"}]],v=new nn(p),y=jt(a),m=a.viewPortData;m.viewPortWidth=891,m.viewPortHeight=630;var b=y.bottomRight.x-y.topLeft.x;m=_(m.viewPortWidth,m.viewPortHeight,b,m),m=N(Object(h.a)({},y),m),m=C(y.topLeft,m),c.fillStyle="white",c.fillRect(0,0,m.viewPortWidth,m.viewPortHeight),v.setPosition(0,0);var g=v.getTableDimensions(c,12).totalWidth;c.save(),c.translate(m.viewPortWidth-g-20,50),v.draw(c,12),c.restore(),b=k.screenToRealLength(m.viewPortWidth-g-20,m.realWidth,m.viewPortWidth),m=_(m.viewPortWidth-g-20,m.viewPortHeight-150,b,m),m=N(Object(h.a)({},y),m),c.save(),c.translate(0,50),Ae(c,m,a,!0),c.restore(),n.push(s.toDataURL("image/png"))}!function(t,e){var n={project:1,state:{}},a=JSON.stringify(n),i=e[0].split(",")[1],r=e[1].split(",")[1],o=new Fe.a;o.file("project.json",a),o.file("\u043a\u043e\u0440\u043f\u0443\u0441.png",i,{base64:!0}),o.file("\u0444\u0430\u0441\u0430\u0434.png",r,{base64:!0}),o.generateAsync({type:"blob"}).then(function(t){return Be.a.saveAs(t,"project.zip")})}(0,n)}function rn(t,e){switch(e.type){case lt.NEW_PROJECT_CONFIRM:var n={show:!0,dialog:i.a.createElement(Je,{start:e.payload})};return{result:!0,newState:Object(h.a)({},t,{showDialog:n})};case lt.NEW_PROJECT:var a=ke({wardrobe:e.payload.wardrobe});return a.mouseHandler=new _e(a),{result:!0,newState:Object(h.a)({},a,{materials:Object(h.a)({},t.materials,{activeDSPColor:e.payload.wardrobe.dspCorpus}),showDialog:{show:!1}})};case lt.SET_INFORMATION:return{result:!0,newState:Object(h.a)({},t,{information:Object(h.a)({},e.payload)})};case lt.SAVE_PROJECT:return an(t),{result:!0,newState:t};case lt.SET_PROJECT:var r=e.payload;if(!r.project)return{result:!0,newState:Object(h.a)({},t,{showAlert:{show:!0,message:"corruptedProject"}})};var o=function(t,e){return{panels:t.panels.map(function(e){var n=new zt(Object(h.a)({},e,{drawModule:t.drawModuleInCaption}));return n.state.selected=!1,n.refreshModel(),n}),detailList:{primary:t.detailList.primary,secondary:t.detailList.secondary},information:Object(h.a)({},t.information,{currentDate:t.information.currentDate||G()})}}(r.state);return{result:!0,newState:Object(h.a)({},t,o)};case lt.SET_WARDROBE_DIMENSIONS:var s=e.payload;return t.wardrobe.double&&(s.width1=Array.from(t.panels)[0].length,s.width2=Array.from(t.panels)[1].length),{result:!0,newState:Object(h.a)({},t,{wardrobe:Object(h.a)({},t.wardrobe,s)})};case lt.SET_WORKSPACE:var c=e.payload===Te.CORPUS?new _e(t):new he(t);return t.selectedPanels.clear(),{result:!0,newState:Object(h.a)({},t,{workspace:e.payload,mouseHandler:c})};default:return{result:!1,newState:t}}}var on=ke({});on.mouseHandler=new _e(on);window.actions=[];var sn=Object(l.b)(function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:on,n=arguments.length>1?arguments[1]:void 0,a=Object(h.a)({},e),i=function(t,e){switch(e.type){case Mt.ABORT:return{result:!0,newState:Object(h.a)({},t,{status:K.FREE,curShape:null,cursor:new U(t.curRealPoint),mouseHandler:t.workspace===Te.CORPUS?new _e(t):new he(t)})};case Mt.CANCEL:return t.panels.forEach(function(t){t.setState({selected:!1,underCursor:!1,highlighted:!1,inSelection:!1})}),t.dimensions.forEach(function(t){return t.setState({selected:!1,underCursor:!1,highlighted:!1,inSelection:!1})}),{result:!0,newState:Object(h.a)({},t,{status:K.FREE,curShape:null,cursor:new U(t.curRealPoint),mouseHandler:t.workspace===Te.CORPUS?new _e(t):new he(t),toolButtonsPressed:{createVertical:!1,createHorizontal:!1,createSingleDimension:!1}})};case Mt.CANCEL_MOVING:return{result:!0,newState:Object(h.a)({},t,{status:K.FREE,curShape:null,cursor:new U(t.curRealPoint),mouseHandler:t.workspace===Te.CORPUS?new _e(t):new he(t)})};case Mt.CANCEL_SELECTION:return t.panels.forEach(function(t){return t.setState({selected:!1,underCursor:!1,highlighted:!1,inSelection:!1})}),t.dimensions.forEach(function(t){return t.setState({selected:!1,underCursor:!1,highlighted:!1,inSelection:!1})}),t.selectedPanels.clear(),{result:!0,newState:Object(h.a)({},t,{status:K.FREE,curShape:null,cursor:new U(t.curRealPoint)})};case Mt.PAN_SCREEN:return{result:!0,newState:Object(h.a)({},t,{prevStatus:e.payload.prevStatus,status:K.PAN,prevCursor:t.cursor,prevMouseHandler:e.payload.prevMouseHandler,cursor:new qt(e.payload),mouseHandler:new Ne(Object(h.a)({},e.payload,{state:t}))})};case Mt.REPAINT:return{result:!0,newState:Object(h.a)({},t)};case Mt.RESET_VIEW:return{result:!0,newState:Object(h.a)({},t,{resetView:!t.resetView})};case Mt.SET_CURSOR:return{result:!0,newState:Object(h.a)({},t,{cursor:e.payload})};case Mt.SET_PREV_STATUS:return{result:!0,newState:Object(h.a)({},t,{status:t.prevStatus,cursor:t.prevCursor,mouseHandler:t.prevMouseHandler})};case Mt.SET_STATUS:return{result:!0,newState:Object(h.a)({},t,{status:e.payload.status,prevStatus:e.payload.prevStatus,statusParams:e.payload.params})};case Mt.START_SELECTION:return{result:!0,newState:Object(h.a)({},t,{cursor:new U(t.curRealPoint),status:K.SELECT,mouseHandler:new e.payload.handler(e.payload.point,t)})};case Mt.STOP_SELECTION:return e.payload.isSelectedPanels||t.selectedPanels.clear(),{result:!0,newState:Object(h.a)({},t,{status:K.FREE,cursor:new U(t.curRealPoint),mouseHandler:new e.payload.handler(t)})};case lt.UPDATE_STATE:return{result:!0,newState:Object(h.a)({},t)};default:return{result:!1,newState:t}}}(e,n);if(t=i.result,a=i.newState,t)return a;var r=Se(e,n);if(t=r.result,a=r.newState,t)return a;var o=rn(e,n);if(t=o.result,a=o.newState,t)return a;var s=function(t,e){switch(e.type){case _t.SHOW_ALERT:return{result:!0,newState:Object(h.a)({},t,{showAlert:e.payload})};case _t.SHOW_CONFIRM:return{result:!0,newState:Object(h.a)({},t,{showConfirm:e.payload})};case _t.SHOW_DIALOG:return{result:!0,newState:Object(h.a)({},t,{showDialog:e.payload})};case _t.SHOW_HELP:return{result:!0,newState:Object(h.a)({},t,{showHelp:e.payload})};default:return{result:!1,newState:t}}}(e,n);if(t=s.result,a=s.newState,t)return a;var c=function(t,e){switch(e.type){case lt.SET_MATERIAL:case lt.SET_LOADED_MATERIALS:return{result:!0,newState:Object(h.a)({},t,{materials:Object(h.a)({},t.materials,e.payload)})};default:return{result:!1,newState:t}}}(e,n);if(t=c.result,a=c.newState,t)return a;var l=function(t,e){switch(e.type){case lt.SET_DELETE_CONFIRM:return{result:!0,newState:Object(h.a)({},t,{deleteConfirm:e.payload})};case lt.SET_DRAW_MODULE:return t.panels.forEach(function(t){t.model.drawModule=e.payload,t.refreshModel()}),{result:!0,newState:Object(h.a)({},t,{drawModuleInCaption:e.payload})};default:return{result:!1,newState:t}}}(e,n);if(t=l.result,a=l.newState,t)return a;var u=function(t,e){switch(e.type){case _t.SET_LANGUAGE:return document.title=e.payload.title,t.mouseHandler.setCaptions(e.payload.toolbars.statusbar),{result:!0,newState:Object(h.a)({},t,{captions:e.payload})};default:return{result:!1,newState:t}}}(e,n);if(t=u.result,a=u.newState,t)return a;var d=function(t,e){var n=t.user;switch(e.type){case Ht.SET_TOKEN:var a;return e.payload.token?(a=!0===e.payload.remember?";expires=Tue, 19 Jan 2099 00:00:00 GMT":"",document.cookie="token=".concat(e.payload.token).concat(a),(n=Object(at.a)(e.payload.token)).token=e.payload.token):(n.name="",n.activated=!1),{result:!0,newState:Object(h.a)({},t,{user:n})};case Ht.LOGOUT:return document.cookie="token=",{result:!0,newState:Object(h.a)({},t,{user:{}})};case Ht.ACTIVATE:return n.activated=!0,{result:!0,newState:Object(h.a)({},t,{user:n})};default:return{result:!1}}}(e,n);return t=d.result,a=d.newState,t?a:e},Object(l.a)(u.a,function(t){return function(t){return function(e){return window.actions.push(e.type),t(e)}}})),cn=function(t){var e=document.getElementById("tooltip");return Object(a.useEffect)(function(){return function(){e.style.display="none"}},[]),{onMouseOver:function(n){if(!z()){var a=n.target.getBoundingClientRect(),i=a.top,r=a.left,o=a.height;if(t){e.innerText=t,e.style.display="inline",e.style.fontSize="0.8rem";var s=e.getBoundingClientRect(),c=s.width,l=s.height,u=i+o+window.scrollY+5,h=r+window.scrollX;h+c>window.innerWidth?(e.style.right="0px",e.style.left="auto"):(e.style.left=h+"px",e.style.right="auto"),i+o+l+5>window.innerHeight?(e.style.bottom="0px",e.style.top="auto"):(e.style.bottom="auto",e.style.top=u+"px")}}},onMouseLeave:function(){e.style.display="none"}}},ln={INSTRUMENTS:"INSTRUMENTS"};function un(t){var e=t.icon,n=t.title,a=t.type,r=t.disabled,o=t.pressed,s=t.pressedStyle,c=t.unpressedStyle,l=t.onClick,u="button";a===ln.INSTRUMENTS&&(s=s||"instruments_button_pressed",c=c||"instruments_button_unpressed"),r&&(u+=" button-disabled"),u+=" ".concat(o?s:c);var h=cn(n),d=h.onMouseOver,f=h.onMouseLeave;return i.a.createElement("div",{className:"".concat(u," ").concat(e," noselect"),onClick:function(t){r||(t.stopPropagation(),l())},onMouseOver:function(t){d(t)},onMouseLeave:function(t){f(t)},onContextMenu:function(t){t.preventDefault()}})}var hn=function(){var t=Object(c.c)(function(t){return t.captions.help}),e=Object(c.c)(function(t){return t.captions.title}),n=Bt();return i.a.createElement("div",{className:"header"},i.a.createElement(it,{noTitle:!0,wide:!0},i.a.createElement("div",{style:{display:"flex",flexWrap:"none",gap:"1em",alignItems:"center",width:"100%"}},i.a.createElement("div",{className:"title"},e),i.a.createElement(un,{icon:"help",title:t.title,onClick:function(){n.showHelp(!0)}}))))},dn=n(126),fn=n(125),pn=n(63),vn=n.n(pn),yn=n(64),mn=n.n(yn);function bn(t){t.disabled;var e=Object(c.c)(function(t){return t.materials}),n=Object(c.c)(function(t){return t.captions.toolbars.info.materials}),a=Bt(),r=e.DSP.map(function(t){return t.name}),o=e.activeDSPColor;return i.a.createElement("div",{className:"gridContent"},i.a.createElement(Xe,{title:n.dspMainColor,value:o,items:r,onChange:function(t,e){return a.setMaterial({activeDSPColor:e})}}))}function gn(t){t.disabled;var e=Object(c.c)(function(t){return t.captions.toolbars.info}),n=function(t){var e=t.captions.toolbars.info,n=t.wardrobe.double?" (".concat(t.wardrobe.width1,"+").concat(t.wardrobe.width2,")"):"";return[{id:"wardrobe",name:e.wardrobe.title,children:[{id:"width",name:"".concat(e.wardrobe.width,": ").concat(t.wardrobe.width).concat(n)},{id:"depth",name:"".concat(e.wardrobe.depth,": ").concat(t.wardrobe.depth)},{id:"height",name:"".concat(e.wardrobe.height,": ").concat(t.wardrobe.height)}]},{id:"materials",name:e.materials.title,children:[{id:"material",name:i.a.createElement(bn,null)}]}]}(Object(c.c)(function(t){return t}));return i.a.createElement(it,{caption:e.title},n.map(function(t){return i.a.createElement(dn.a,{"aria-label":"rich object",defaultCollapseIcon:i.a.createElement(vn.a,null),defaultExpanded:["root"],defaultExpandIcon:i.a.createElement(mn.a,null)},function t(e){return i.a.createElement(fn.a,{key:e.id,nodeId:e.id,label:e.name},Array.isArray(e.children)?e.children.map(function(e){return t(e)}):null)}(t))}))}function En(t){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{display:"flex",gap:"0.2em",alignItems:"stretch"}},t.children))}function wn(t){var e=t.value,n=t.disabled,a=(t.title,t.onChange);return i.a.createElement("input",{type:"checkbox",checked:e,disabled:n,onChange:function(t){a(t.target.checked)}})}function Sn(){var t=Object(c.c)(function(t){return t.captions.toolbars.operations}),e=Bt().updateState,n=Object(c.c)(function(t){return t}),a=Bt(),r=Array.from(n.selectedPanels).filter(function(t){return t.type!==V.DIMENSION}),o=r.every(function(t){return t.vertical})||r.every(function(t){return!t.vertical}),s=r.some(function(t){return t.state.fixed_move}),l={left:!1,right:!1,up:!1,down:!1};return r.length>0&&!s&&o&&(l.left=r[0].vertical,l.right=r[0].vertical,l.up=!r[0].vertical,l.down=!r[0].vertical),i.a.createElement("div",{className:"moveButtons"},i.a.createElement(un,{icon:"moveLeft",disabled:!l.left,title:t.moveLeft,onClick:function(){Tt(-1,0,r[0],r,function(){kt(n,a)}),e()}}),i.a.createElement(un,{icon:"moveUp",disabled:!l.up,title:t.moveUp,onClick:function(){Tt(0,1,r[0],r,function(){kt(n,a)}),e()}}),i.a.createElement(un,{icon:"moveDown",disabled:!l.down,title:t.moveDown,onClick:function(){Tt(0,-1,r[0],r,function(){kt(n,a)}),e()}}),i.a.createElement(un,{icon:"moveRight",disabled:!l.right,title:t.moveRight,onClick:function(){Tt(1,0,r[0],r,function(){kt(n,a)}),e()}}))}function Pn(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return On(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return On(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function On(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function xn(){var t=Object(c.c)(function(t){return t}),e=t.captions.toolbars,n=Bt(),a=Array.from(t.selectedPanels),r=a.filter(function(t){return t.type!==V.DIMENSION}),o=1===r.length&&r[0].parent,s=1===r.length&&r[0].state.fixedWidth,l=1===r.length&&r[0].state.fixedHeight,u=1===r.length&&r[0].state.fixable,h=a.length,d=a.some(function(t){return!t.state.deletable}),f=i.a.createElement(i.a.Fragment,null);1===h&&(f=i.a.createElement("div",{className:"propertyContent"},function(t,e,n){var a,r=[],o=Pn(t.getProperties());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(!s.hidden){var c=Dn(s,e,n),l=i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,e.captions.toolbars.property[s.key]),c);r.push(l)}}}catch(u){o.e(u)}finally{o.f()}return r}(a[0],t,n.updateState)));var p=!1;0===h&&(f=e.property.noselected,p=!0),h>1&&(f=e.property.selected+h);var v=e.property,y=p?i.a.createElement(i.a.Fragment,null):i.a.createElement("div",null,i.a.createElement("hr",null),i.a.createElement(En,null,i.a.createElement(un,{title:v.delete,disabled:d,pressedStyle:"deletebutton",unpressedStyle:"deletebutton",onClick:function(){n.deleteSelectedFasadesConfirm()}}),i.a.createElement(un,{title:v.levelup,disabled:!o,pressedStyle:"levelUpButton",unpressedStyle:"levelUpButton",onClick:function(){n.selectParent(r[0])}}),i.a.createElement(un,{title:s?v.unlock_width:v.lock_width,disabled:!u,pressed:s,pressedStyle:"lock_width_button_pressed",unpressedStyle:"lock_width_button_unpressed",onClick:function(){n.fixWidth(!s)}}),i.a.createElement(un,{title:l?v.unlock_height:v.lock_height,disabled:!u,pressed:l,pressedStyle:"lock_height_button_pressed",unpressedStyle:"lock_height_button_unpressed",onClick:function(){n.fixHeight(!l)}})));return i.a.createElement(it,{caption:e.property.title},f,y)}function Dn(t,e,n){if(!t.editable())return i.a.createElement("div",null,t.getValue(e)+(t.extra?t.extra():""));switch(t.type){case ot.STRING:return i.a.createElement(Ke,{type:t.type,value:t.getValue(),setValue:function(e){t.setValue(e),n()}});case ot.INTEGER_POSITIVE_NUMBER:return i.a.createElement("div",null,i.a.createElement(Ke,{type:t.type,value:t.getValue(),setValue:function(e){t.setValue(e),n()}}),t.extra&&t.extra()?i.a.createElement("span",null,t.extra()):i.a.createElement(i.a.Fragment,null));case ot.BOOL:return i.a.createElement(wn,{value:t.getValue(),onChange:function(e){t.setValue(e),n()}});case ot.LIST:return i.a.createElement(Xe,{items:t.items(e),value:t.getValue(e),onChange:function(e,a){t.setValue(e,a),n()}})}}function Tn(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return kn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kn(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function kn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function jn(){var t=Object(c.c)(function(t){return t});if(t.workspace===Te.FASADES)return i.a.createElement(xn,null);var e=t.captions.toolbars.property,n=Bt(),a=Array.from(t.selectedPanels),r=a.filter(function(t){return t.type!==V.DIMENSION}),o=a.length,s=r.find(function(t){return t.jointFromBackSide.size>0||t.jointFromFrontSide.size>0}),l=a.some(function(t){return t.state.fixed_move}),u=a.some(function(t){return!t.state.fixable}),h=a.some(function(t){return!t.state.deletable}),d=r.some(function(t){return t.state.fixedLength.min}),f=r.some(function(t){return t.state.fixedLength.max}),p=i.a.createElement(i.a.Fragment,null);1===o&&(p=i.a.createElement("div",{className:"gridContent"},function(t,e,n){var a,r=[],o=Tn(t.getProperties());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(!s.hidden){var c=Rn(s,n),l=i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,e.captions.toolbars.property[s.key]),c);r.push(l)}}}catch(u){o.e(u)}finally{o.f()}return r}(a[0],t,n.updateState)));var v=!1;0===o&&(p=e.noselected,v=!0),o>1&&(p=e.selected+o);var y=v?i.a.createElement(i.a.Fragment,null):i.a.createElement("div",null,i.a.createElement("hr",null),i.a.createElement(En,null,i.a.createElement(Sn,null),i.a.createElement(un,{key:1,title:l?e.unlock_move:e.lock_move,disabled:u,pressed:l,pressedStyle:"lockmovebutton_pressed",unpressedStyle:"lockmovebutton_unpressed",onClick:function(){n.setPanelState({fixed_move:!l})}}),i.a.createElement(un,{key:2,title:d?e.unlock_minlength:e.lock_minlength,disabled:u,pressed:d,pressedStyle:"lockminlengthbutton_pressed",unpressedStyle:"lockminlengthbutton_unpressed",onClick:function(){n.fixMinLength(!d)}}),i.a.createElement(un,{key:3,title:f?e.unlock_maxlength:e.lock_maxlength,disabled:u,pressed:f,pressedStyle:"lockmaxlengthbutton_pressed",unpressedStyle:"lockmaxlengthbutton_unpressed",onClick:function(){n.fixMaxLength(!f)}}),i.a.createElement(un,{key:4,title:e.delete,disabled:h,pressedStyle:"deletebutton",unpressedStyle:"deletebutton",onClick:function(){n.deleteSelectedConfirm({isJoints:s})}})));return i.a.createElement(it,{caption:e.title},p,y)}function Rn(t,e){if(!t.editable)return i.a.createElement("div",null,t.value);switch(t.type){case ot.STRING:case ot.INTEGER_POSITIVE_NUMBER:return i.a.createElement(Ke,{type:t.type,value:t.value,setValue:function(n){t.setValue(n),e()}});case ot.BOOL:return i.a.createElement(wn,{value:t.value,onChange:function(n){t.setValue(n),e()}})}}function An(){return i.a.createElement("div",{className:"left-sidebar"},i.a.createElement("div",{className:"sidebar-content"},i.a.createElement(gn,null),i.a.createElement(jn,null)))}function Cn(){var t=Bt(),e=Object(c.c)(function(t){return t.captions.toolbars.instruments}),n=Object(c.c)(function(t){return t.toolButtonsPressed}),a=n.createSingleDimension,r=n.createTwoPanelDimensionInside,o=n.createTwoPanelDimensionOutside,s={pressedStyle:"instruments_button_pressed",unpressedStyle:"instruments_button_unpressed"};return i.a.createElement(i.a.Fragment,null,i.a.createElement(En,null,i.a.createElement(un,Object.assign({icon:"createSingleDimension",pressed:a},s,{title:e.createSingleDimension,onClick:function(){t.createSingleDimension()}})),i.a.createElement(un,Object.assign({icon:"createTwoPanelDimensionInside",pressed:r},s,{title:e.createTwoPanelDimensionInside,onClick:function(){t.createTwoPanelDimension({inside:!0})}})),i.a.createElement(un,Object.assign({icon:"createTwoPanelDimensionOutside",pressed:o},s,{title:e.createTwoPanelDimensionOutside,onClick:function(){t.createTwoPanelDimension({inside:!1})}}))))}function Ln(){var t=Bt(),e=Object(c.c)(function(t){return t.captions.toolbars.instruments}),n=Object(c.c)(function(t){return t.toolButtonsPressed}),a=n.createFasadLengthDimension,r=n.createFasadWidthDimension,o={pressedStyle:"instruments_button_pressed",unpressedStyle:"instruments_button_unpressed"};return i.a.createElement(i.a.Fragment,null,i.a.createElement(En,null,i.a.createElement(un,Object.assign({icon:"createFasadeLengthDimension",pressed:a},o,{title:e.createFasadeLengthDimension,onClick:function(){t.createFasadeDimension(!0)}})),i.a.createElement(un,Object.assign({icon:"createFasadeWidthDimension",pressed:r},o,{title:e.createFasadeWidthDimension,onClick:function(){t.createFasadeDimension(!1)}}))))}function In(t){var e=i.a.createElement(un,{disabled:t.disabled,icon:"decrease",onClick:function(){t.value>t.min&&t.setValue(t.value-1)}}),n=i.a.createElement(un,{disabled:t.disabled,icon:"increase",onClick:function(){t.value<t.max&&t.setValue(t.value+1)}});return i.a.createElement("span",{style:{display:"flex",alignItems:"center",flexDirection:t.vertical?"column":"row"}},n,t.value,e)}function _n(){var t=Bt(),e=Object(a.useState)(2),n=Object(J.a)(e,2),r=n[0],o=n[1],s=Object(c.c)(function(t){return t.captions.toolbars.instruments}),l=Array.from(Object(c.c)(function(t){return t}).selectedPanels).filter(function(t){return t.type!==V.DIMENSION}),u=l.every(function(t){return!(t.parent&&t.parent.divided===mt.HOR)&&t.level<3}),h=l.every(function(t){return!(t.parent&&t.parent.divided===mt.VERT)&&t.level<3}),d={pressedStyle:"instruments_button_pressed",unpressedStyle:"instruments_button_unpressed"};return i.a.createElement(i.a.Fragment,null,i.a.createElement(En,null,i.a.createElement(un,Object.assign({icon:"divideFasadHor",disabled:!u,pressed:!1},d,{title:s.divideFasadHor,onClick:function(){t.divideFasadHor(r)}})),i.a.createElement(un,Object.assign({icon:"divideFasadVert",disabled:!h,pressed:!1},d,{title:s.divideFasadVert,onClick:function(){t.divideFasadVert(r)}})),i.a.createElement(In,{vertical:!0,value:r,min:2,max:4,setValue:function(t){o(t)}})))}function Nn(){var t=Bt(),e=Object(c.c)(function(t){return t.captions.toolbars.instruments}),n=Object(c.c)(function(t){return t.toolButtonsPressed}),a=n.createHorizontal,r=n.createVertical,o=n.createDrawer,s=n.createDrawerBlock,l={pressedStyle:"instruments_button_pressed",unpressedStyle:"instruments_button_unpressed"};return i.a.createElement(i.a.Fragment,null,i.a.createElement(En,null,i.a.createElement(un,Object.assign({icon:"createPanelVertical",pressed:r},l,{title:e.createVertical,onClick:function(){t.createPanel({vertical:!0})}})),i.a.createElement(un,Object.assign({icon:"createPanelHorizontal",pressed:a},l,{title:e.createHorizontal,onClick:function(){t.createPanel({vertical:!1})}})),i.a.createElement(un,Object.assign({icon:"createDrawer",pressed:o},l,{title:e.createDrawer,onClick:function(){t.createDrawer()}})),i.a.createElement(un,Object.assign({icon:"createDrawerBlock",pressed:s},l,{title:e.createDrawerBlock,onClick:function(){t.createDrawerBlock()}})),i.a.createElement(un,Object.assign({icon:"createTube",pressed:s},l,{title:e.createTube,onClick:function(){t.createTube()}}))))}function Mn(){var t=Object(c.c)(function(t){return t.captions.toolbars.operations}),e=Bt(),n=function(t){var e=Array.from(t);if(e.some(function(t){return t.type!==V.PANEL||0!==t.jointFromBackSide.size||0!==t.jointFromFrontSide.size||!0===t.state.fixed_move}))return!1;if(!e.every(function(t){return t.vertical})&&!e.every(function(t){return!t.vertical}))return!1;if(0===e.length)return!1;var n=e[0].jointToBack,a=e[0].jointToFront;if(!e.every(function(t){return t.jointToBack===n}))return!1;if(!e.every(function(t){return t.jointToFront===a}))return!1;e[0].vertical?e.sort(function(t,e){return t.rect.x-e.rect.x}):e.sort(function(t,e){return t.rect.y-e.rect.y});for(var i=0;i<e.length-1;i++)if(e[i].getNearest().nearestFromFront!==e[i+1])return!1;return!0}(Object(c.c)(function(t){return t}).selectedPanels);return i.a.createElement(i.a.Fragment,null,i.a.createElement(En,null,i.a.createElement(un,{icon:"resetView",title:t.resetView,type:ln.INSTRUMENTS,onClick:function(){e.resetView()}}),i.a.createElement(un,{icon:"distribute",disabled:!n,type:ln.INSTRUMENTS,title:t.distribute,onClick:function(){e.distribute()}})))}function Fn(t){var e=t.disabled,n=Bt(),a=Object(c.c)(function(t){return t.user.activated}),r=Object(c.c)(function(t){return t.captions.toolbars.project}),o=!a||e,s=a?"":r.disabled;return i.a.createElement(i.a.Fragment,null,i.a.createElement(En,null,i.a.createElement(un,{icon:"new",title:r.new,onClick:function(){n.newProjectConfirm()},disabled:e}),i.a.createElement(un,{icon:"open",title:r.open+s,onClick:function(){n.open()},disabled:o}),i.a.createElement(un,{icon:"save",title:r.save+s,onClick:function(){n.save()},disabled:!1})))}function Hn(){return i.a.createElement("div",{className:"separator"})}function Bn(){var t=Bt(),e=Object(c.c)(function(t){return t}),n=e.captions.toolbars.workspace,a=[n.corpus,n.fasades],r=[Te.CORPUS,Te.FASADES],o=e.workspace===Te.CORPUS?a[0]:a[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(Xe,{items:a,value:o,onChange:function(e){return t.setWorkspace(r[e])}}))}function Vn(t){t.disabled;var e=Object(c.c)(function(t){return t.workspace});return i.a.createElement(it,{noTitle:!0,font:"small"},i.a.createElement(En,null,i.a.createElement(Fn,null),i.a.createElement(Bn,null),e===Te.CORPUS?i.a.createElement(i.a.Fragment,null,i.a.createElement(Hn,null),i.a.createElement(Nn,null),i.a.createElement(Hn,null),i.a.createElement(Cn,null)):i.a.createElement(i.a.Fragment,null,i.a.createElement(_n,null),i.a.createElement(Hn,null),i.a.createElement(Ln,null)),i.a.createElement(Hn,null),i.a.createElement(Mn,null)))}function Wn(){return i.a.createElement("div",{className:"main-container"},i.a.createElement(hn,null),i.a.createElement(Vn,null),i.a.createElement("div",{className:"work-container"},i.a.createElement(An,null),i.a.createElement("div",{className:"viewport-container"},i.a.createElement(Ut,null))))}function Un(t){var e=Object(c.b)(),n=Bt(),a=Object(c.c)(function(t){return t.captions});return i.a.createElement(ze,{header:a.messages[t.messageKey]},i.a.createElement("div",{className:"flex-center"},t.actions.map(function(t,a){return i.a.createElement("button",{key:a,onClick:function(){e(t.onClick()),n.showConfirm(!1)}},t.caption)}),i.a.createElement("button",{onClick:function(){return n.showConfirm(!1)}},a.buttons.cancel)))}function Kn(t){var e=Bt();return i.a.createElement(ze,{header:t.message},i.a.createElement("hr",null),i.a.createElement("div",{className:"flex-center"},i.a.createElement("button",{onClick:function(){e.showAlert(!1)}},"OK")))}var Gn=function(){return i.a.createElement("div",{className:"modal-container  noselect"},i.a.createElement("div",{className:"lds-spinner"},i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null)))};function zn(){var t=Bt(),e=Object(c.c)(function(t){return t.captions}),n=Object(c.c)(function(t){return t.captions.title}),r=e.help.hotKeys.map(function(t,e){return i.a.createElement(a.Fragment,{key:e},i.a.createElement("span",{className:"helpHotKey"},t.key," ")," - ",t.desc,i.a.createElement("br",null))});return i.a.createElement("div",{className:"modal-container help-container noselect",onClick:function(){t.showHelp(!1)}},i.a.createElement("div",{className:"toolbar help-section"},i.a.createElement("div",{className:"toolbar-header flex-center"},i.a.createElement("span",{className:"toolbarCaption"},e.help.title)),i.a.createElement("hr",null),i.a.createElement("div",{style:{display:"flex",gap:"1em"}},i.a.createElement("span",{style:{fontSize:"medium",fontWeight:"bold",color:"blue",textAlign:"right"}},n),i.a.createElement("span",null,e.about.name),i.a.createElement("a",{href:"mailto: ".concat(e.about.email)},e.about.email)),i.a.createElement("hr",null),r))}function Xn(){var t=Object(c.c)(function(t){return t.showHelp}),e=Object(c.c)(function(t){return t.showLoading}),n=Object(c.c)(function(t){return t.showConfirm}),r=Object(c.c)(function(t){return t.showAlert}),o=Object(c.c)(function(t){return t.showDialog}),s=Bt();return Object(a.useEffect)(function(){s.setLanguage(nt)},[]),i.a.createElement(i.a.Fragment,null,i.a.createElement(Wn,null),i.a.createElement("div",{id:"goTop"},i.a.createElement("div",null)),e?i.a.createElement(Gn,null):i.a.createElement(i.a.Fragment,null),t?i.a.createElement(zn,null):i.a.createElement(i.a.Fragment,null),n.show?i.a.createElement(Un,{messageKey:n.messageKey,actions:n.actions}):i.a.createElement(i.a.Fragment,null),r.show?i.a.createElement(Kn,{message:r.message}):i.a.createElement(i.a.Fragment,null),o.show?o.dialog:i.a.createElement(i.a.Fragment,null))}var Yn=n(16);function Jn(t){var e=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useRef)(),o=Object(a.useState)({correct:!0,logging:!1,showPass:!1,remember:!1,message:""}),s=Object(J.a)(o,2),l=s[0],u=s[1],d=Bt(),f=Object(c.c)(function(t){return t.captions.loginForm}),p=Object(c.c)(function(t){return t.captions.serverMessages}),v=function(e,n){u({correct:!0,logging:!0}),fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,password:n})}).then(function(t){return t.json()}).then(function(e){u({correct:e.success,logging:!1,message:p[e.message]}),!0===e.success&&(d.setToken(e.token,l.remember),t.history.push("/"))}).catch(function(t){console.error(t),u({correct:!1,logging:!1,message:p[Yn.SERVER_ERROR]})})};Object(a.useEffect)(function(){return window.KEYDOWNHANDLE=!1,setTimeout(function(){r.current.style.width="220px"},10),function(){window.KEYDOWNHANDLE=!0}},[]);var y=l.showPass?"text":"password",m=l.message;return i.a.createElement("div",{className:"modal-container noselect",onClick:_t.blink},i.a.createElement("div",{ref:r,className:"toolbar-modal toolbar-animated shadow-box",onClick:function(t){t.stopPropagation()}},i.a.createElement("div",{className:"toolbar-header"},i.a.createElement("span",{className:"toolbarCaption"},f.title)),i.a.createElement("form",{onSubmit:function(t){if(!l.logging){var a=e.current.value,i=n.current.value;v(a,i),t.preventDefault()}},className:"login-form"},i.a.createElement("input",{name:"nameOrEmail",ref:e,required:!0,placeholder:f.name}),i.a.createElement("input",{name:"password",ref:n,required:!0,placeholder:f.password,type:y}),i.a.createElement("input",{type:"submit",value:"OK"}),i.a.createElement("input",{type:"button",value:f.cancel,onClick:function(){t.history.push("/")}}),i.a.createElement("input",{type:"button",value:f.register,onClick:function(){t.history.push("/register")}})),i.a.createElement(wn,{title:f.showPass,value:l.showPass,onChange:function(t){u(Object(h.a)({},l,{showPass:t}))}}),i.a.createElement(wn,{title:f.remember,value:l.remember,onChange:function(t){u(Object(h.a)({},l,{remember:t}))}}),i.a.createElement("div",{className:"flex-center"},l.logging?i.a.createElement(Gn,null):i.a.createElement(i.a.Fragment,null)),i.a.createElement("span",{className:l.correct?"successMessages":"errorMessages"},m)))}var qn=n(16);function $n(t){var e=Object(a.useRef)(),n=Object(a.useRef)(),r=Object(a.useRef)(),o=Object(a.useRef)(),s=Object(a.useRef)(),l=Bt(),u=Object(c.c)(function(t){return t.captions.registerForm}),d=Object(c.c)(function(t){return t.captions.serverMessages}),f=Object(a.useState)({correct:!1,errCode:0,fetching:!1,showPass:!1}),p=Object(J.a)(f,2),v=p[0],y=p[1],m=function(e){l.showAlert(!0,d[qn.REG_SUCCEED]),l.setToken(e),t.history.push("/"),y({correct:!0,fetching:!1})},b=function(t){y({correct:!1,fetching:!1,message:d[t]})},g=function(t){y({correct:!1,fetching:!1,message:d[qn.SERVER_ERROR]})},E=function(){y(function(t){return Object(h.a)({},t,{message:""})})};Object(a.useEffect)(function(){return window.KEYDOWNHANDLE=!1,setTimeout(function(){s.current.style.width="220px"},10),function(){window.KEYDOWNHANDLE=!0}},[]);var w=v.showPass?"text":"password",S=v.message;return i.a.createElement("div",{className:"modal-container noselect",onClick:_t.blink},i.a.createElement("div",{ref:s,className:"toolbar-modal toolbar-animated shadow-box",onClick:function(t){t.stopPropagation()}},i.a.createElement("div",{className:"toolbar-header"},i.a.createElement("span",{className:"toolbarCaption"},u.title)),i.a.createElement("form",{onSubmit:function(t){var a=e.current.value,i=n.current.value,s=r.current.value,c=o.current.value,l=Qn(a,i,s,c);l.message=d[l.message],l.correct?(y(function(t){return Object(h.a)({},t,{fetching:!0})}),Zn("/register",{name:a,email:i,password:s},m,b,g)):y(Object(h.a)({},l)),t.preventDefault()},className:"login-form"},i.a.createElement("div",{className:"input-row"},i.a.createElement("input",{required:!0,ref:e,placeholder:u.name,onChange:E}),i.a.createElement(un,{icon:"refresh",title:u.checkName,onClick:function(){!function(t){if(!ta(t))return y(function(t){return Object(h.a)({},t,{correct:!1,message:d[qn.INVALID_NAME]})});y(function(t){return Object(h.a)({},t,{fetching:!0,message:""})}),Zn("/checkname",{name:t},function(){y(function(t){return Object(h.a)({},t,{correct:!0,fetching:!1,message:d[qn.USER_NAME_ALLOWED]})})},function(){y(function(t){return Object(h.a)({},t,{correct:!1,fetching:!1,message:d[qn.USER_NAME_EXIST]})})},g)}(e.current.value)}})),i.a.createElement("div",{className:"input-row"},i.a.createElement("input",{required:!0,ref:n,placeholder:u.email,type:"email",onChange:E}),i.a.createElement(un,{icon:"refresh",title:u.checkEmail,onClick:function(){!function(t){if(!ea(t))return y(function(t){return Object(h.a)({},t,{correct:!1,message:d[qn.INVALID_EMAIL]})});y(function(t){return Object(h.a)({},t,{fetching:!0,message:""})}),Zn("/checkemail",{email:t},function(){y(function(t){return Object(h.a)({},t,{correct:!0,fetching:!1,message:d[qn.USER_EMAIL_ALLOWED]})})},function(t){y(function(e){return Object(h.a)({},e,{correct:!1,fetching:!1,message:d[t]})})},g)}(n.current.value)}})),i.a.createElement("input",{required:!0,ref:r,placeholder:u.password,type:w,onChange:E}),i.a.createElement("input",{required:!0,ref:o,placeholder:u.passwordAgain,type:w,onChange:E}),i.a.createElement("input",{type:"submit",value:"OK"}),i.a.createElement("input",{type:"button",value:u.cancel,onClick:function(){t.history.push("/")}}),i.a.createElement("input",{type:"button",value:u.login,onClick:function(){t.history.push("/login")}})),i.a.createElement(wn,{title:u.showPass,value:v.showPass,onChange:function(t){y({showPass:t})}}),i.a.createElement("div",{className:"flex-center"},v.fetching?i.a.createElement(Gn,null):i.a.createElement(i.a.Fragment,null)),i.a.createElement("span",{className:v.correct?"successMessages":"errorMessages"},S)))}var Zn=function(t,e,n,a,i){fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(t){return t.json()}).then(function(t){t.success?n(t.token):a(t.message)}).catch(function(t){i(t)})},Qn=function(t,e,n,a){var i=qn.NO_ERROR,r={correct:!0};return a!==n&&(i=qn.PASSWORDS_NOT_MATCH),n.length<6&&(i=qn.INVALID_PASSWORD),ea(e)||(i=qn.INVALID_EMAIL),ta(t)||(i=qn.INVALID_NAME),i!==qn.NO_ERROR&&(r={correct:!1,message:i}),r},ta=function(t){return t.match(/^[a-zA-Z0-9]+([a-zA-Z0-9](_)[a-zA-Z0-9])*[a-zA-Z0-9]+$/)&&t.length>=4},ea=function(t){return t.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/)};function na(){return i.a.createElement(c.a,{store:sn},i.a.createElement(o.a,null,i.a.createElement(s.a,{path:"/",component:Xn}),i.a.createElement(s.a,{path:"/login",component:Jn}),i.a.createElement(s.a,{path:"/register",component:$n})))}n(91),n(92),n(93),n(94),n(95),n(96),n(97);var aa=document.getElementById("root");Object(r.createRoot)(aa).render(i.a.createElement(na,null)),Object.defineProperty(Object.prototype,"copy",{value:function(){return function t(e){var n={};for(var a in e)if("copy"!==a){var i=void 0;i="object"===typeof e[a]?t(e[a]):e[a],n[a]=i}return n}(this)},enumerable:!1}),Number.prototype.round4=function(){return Math.round(1e4*this)/1e4},window.devicePixelRatio=2}},[[74,1,2]]]);
//# sourceMappingURL=main.1f1c66c9.chunk.js.map